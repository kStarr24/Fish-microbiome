<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Krista Starr">
<meta name="author" content="Federica Montesanto">
<meta name="dcterms.date" content="2023-07-12">

<title>FishMicrobiome Alpha and Beta Diversity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ks_FishMicrobe_diversity_version3_files/libs/clipboard/clipboard.min.js"></script>
<script src="ks_FishMicrobe_diversity_version3_files/libs/quarto-html/quarto.js"></script>
<script src="ks_FishMicrobe_diversity_version3_files/libs/quarto-html/popper.min.js"></script>
<script src="ks_FishMicrobe_diversity_version3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ks_FishMicrobe_diversity_version3_files/libs/quarto-html/anchor.min.js"></script>
<link href="ks_FishMicrobe_diversity_version3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ks_FishMicrobe_diversity_version3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ks_FishMicrobe_diversity_version3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ks_FishMicrobe_diversity_version3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ks_FishMicrobe_diversity_version3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #3B3C3A;
      }
</style>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">FishMicrobiome Alpha and Beta Diversity</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>Krista Starr </p>
               <p>Federica Montesanto </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 12, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">1</span> Setup</a>
  <ul class="collapse">
  <li><a href="#keep-only-water-samples-associated-with-fish-samples-and-only-fish-samples-with-associated-water-samples" id="toc-keep-only-water-samples-associated-with-fish-samples-and-only-fish-samples-with-associated-water-samples" class="nav-link" data-scroll-target="#keep-only-water-samples-associated-with-fish-samples-and-only-fish-samples-with-associated-water-samples"><span class="header-section-number">1.1</span> Keep only water samples associated with fish samples, and only fish samples with associated water samples</a></li>
  </ul></li>
  <li><a href="#created-transformed-data-sets" id="toc-created-transformed-data-sets" class="nav-link" data-scroll-target="#created-transformed-data-sets"><span class="header-section-number">2</span> Created transformed data sets</a>
  <ul class="collapse">
  <li><a href="#proportional-abundance" id="toc-proportional-abundance" class="nav-link" data-scroll-target="#proportional-abundance"><span class="header-section-number">2.1</span> Proportional Abundance</a></li>
  <li><a href="#create-rarefied-data-set" id="toc-create-rarefied-data-set" class="nav-link" data-scroll-target="#create-rarefied-data-set"><span class="header-section-number">2.2</span> Create rarefied data set</a></li>
  <li><a href="#data-subsets" id="toc-data-subsets" class="nav-link" data-scroll-target="#data-subsets"><span class="header-section-number">2.3</span> Data Subsets</a></li>
  </ul></li>
  <li><a href="#map-and-general-info" id="toc-map-and-general-info" class="nav-link" data-scroll-target="#map-and-general-info"><span class="header-section-number">3</span> Map and General Info</a></li>
  <li><a href="#alpha-diversity-entire-data-set" id="toc-alpha-diversity-entire-data-set" class="nav-link" data-scroll-target="#alpha-diversity-entire-data-set"><span class="header-section-number">4</span> Alpha Diversity (entire data set)</a></li>
  <li><a href="#alpha-diversity-rarefied-data-set" id="toc-alpha-diversity-rarefied-data-set" class="nav-link" data-scroll-target="#alpha-diversity-rarefied-data-set"><span class="header-section-number">5</span> Alpha Diversity (Rarefied data set)</a></li>
  <li><a href="#entire-vs-rarefy-results" id="toc-entire-vs-rarefy-results" class="nav-link" data-scroll-target="#entire-vs-rarefy-results"><span class="header-section-number">6</span> Entire vs Rarefy Results</a></li>
  <li><a href="#alpha-statistics" id="toc-alpha-statistics" class="nav-link" data-scroll-target="#alpha-statistics"><span class="header-section-number">7</span> Alpha Statistics</a></li>
  <li><a href="#beta-diversity" id="toc-beta-diversity" class="nav-link" data-scroll-target="#beta-diversity"><span class="header-section-number">8</span> Beta Diversity</a>
  <ul class="collapse">
  <li><a href="#pcoa-ordination" id="toc-pcoa-ordination" class="nav-link" data-scroll-target="#pcoa-ordination"><span class="header-section-number">8.1</span> PCoA ordination</a></li>
  </ul></li>
  <li><a href="#permanova-river" id="toc-permanova-river" class="nav-link" data-scroll-target="#permanova-river"><span class="header-section-number">9</span> PERMANOVA (RIVER)</a>
  <ul class="collapse">
  <li><a href="#pairwise-permanova" id="toc-pairwise-permanova" class="nav-link" data-scroll-target="#pairwise-permanova"><span class="header-section-number">9.1</span> Pairwise Permanova</a>
  <ul class="collapse">
  <li><a href="#sample-type" id="toc-sample-type" class="nav-link" data-scroll-target="#sample-type"><span class="header-section-number">9.1.1</span> Sample Type</a></li>
  <li><a href="#river" id="toc-river" class="nav-link" data-scroll-target="#river"><span class="header-section-number">9.1.2</span> River</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#betadisper-river" id="toc-betadisper-river" class="nav-link" data-scroll-target="#betadisper-river"><span class="header-section-number">10</span> BETADISPER (RIVER)</a>
  <ul class="collapse">
  <li><a href="#sample-type-1" id="toc-sample-type-1" class="nav-link" data-scroll-target="#sample-type-1"><span class="header-section-number">10.0.1</span> Sample Type</a></li>
  <li><a href="#river-1" id="toc-river-1" class="nav-link" data-scroll-target="#river-1"><span class="header-section-number">10.0.2</span> River</a></li>
  </ul></li>
  <li><a href="#permanova" id="toc-permanova" class="nav-link" data-scroll-target="#permanova"><span class="header-section-number">11</span> PERMANOVA</a>
  <ul class="collapse">
  <li><a href="#pairwisepermanova" id="toc-pairwisepermanova" class="nav-link" data-scroll-target="#pairwisepermanova"><span class="header-section-number">11.1</span> PairwisePermanova</a>
  <ul class="collapse">
  <li><a href="#commonname" id="toc-commonname" class="nav-link" data-scroll-target="#commonname"><span class="header-section-number">11.1.1</span> commonName</a></li>
  <li><a href="#stations" id="toc-stations" class="nav-link" data-scroll-target="#stations"><span class="header-section-number">11.1.2</span> Stations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#betadisper" id="toc-betadisper" class="nav-link" data-scroll-target="#betadisper"><span class="header-section-number">12</span> BETADISPER</a>
  <ul class="collapse">
  <li><a href="#commonname-1" id="toc-commonname-1" class="nav-link" data-scroll-target="#commonname-1"><span class="header-section-number">12.1</span> commonName</a>
  <ul class="collapse">
  <li><a href="#pairwise-commonname" id="toc-pairwise-commonname" class="nav-link" data-scroll-target="#pairwise-commonname"><span class="header-section-number">12.1.1</span> Pairwise: commonName</a></li>
  </ul></li>
  <li><a href="#station" id="toc-station" class="nav-link" data-scroll-target="#station"><span class="header-section-number">12.2</span> Station</a></li>
  </ul></li>
  <li><a href="#envifit" id="toc-envifit" class="nav-link" data-scroll-target="#envifit"><span class="header-section-number">13</span> Envifit</a></li>
  <li><a href="#ordisurf" id="toc-ordisurf" class="nav-link" data-scroll-target="#ordisurf"><span class="header-section-number">14</span> Ordisurf</a></li>
  <li><a href="#ordination" id="toc-ordination" class="nav-link" data-scroll-target="#ordination"><span class="header-section-number">15</span> Ordination</a>
  <ul class="collapse">
  <li><a href="#pcoa-axis-analysis" id="toc-pcoa-axis-analysis" class="nav-link" data-scroll-target="#pcoa-axis-analysis"><span class="header-section-number">15.0.1</span> PCoA axis analysis</a></li>
  <li><a href="#simple-ordintation" id="toc-simple-ordintation" class="nav-link" data-scroll-target="#simple-ordintation"><span class="header-section-number">15.0.2</span> Simple Ordintation</a></li>
  <li><a href="#envfit-significant-variables-plotted" id="toc-envfit-significant-variables-plotted" class="nav-link" data-scroll-target="#envfit-significant-variables-plotted"><span class="header-section-number">15.1</span> envfit significant variables plotted</a></li>
  <li><a href="#water-samples-envfit" id="toc-water-samples-envfit" class="nav-link" data-scroll-target="#water-samples-envfit"><span class="header-section-number">15.2</span> Water samples envfit</a></li>
  <li><a href="#fish-samples-envfit" id="toc-fish-samples-envfit" class="nav-link" data-scroll-target="#fish-samples-envfit"><span class="header-section-number">15.3</span> Fish samples envfit</a></li>
  <li><a href="#core-microbiomes-plotted" id="toc-core-microbiomes-plotted" class="nav-link" data-scroll-target="#core-microbiomes-plotted"><span class="header-section-number">15.4</span> core microbiomes plotted</a></li>
  </ul></li>
  <li><a href="#simper" id="toc-simper" class="nav-link" data-scroll-target="#simper"><span class="header-section-number">16</span> Simper</a></li>
  <li><a href="#deseq2" id="toc-deseq2" class="nav-link" data-scroll-target="#deseq2"><span class="header-section-number">17</span> DeSeq2</a>
  <ul class="collapse">
  <li><a href="#phyla-level" id="toc-phyla-level" class="nav-link" data-scroll-target="#phyla-level"><span class="header-section-number">17.1</span> Phyla Level</a>
  <ul class="collapse">
  <li><a href="#red-shiner-vs-water-differential-phyla" id="toc-red-shiner-vs-water-differential-phyla" class="nav-link" data-scroll-target="#red-shiner-vs-water-differential-phyla"><span class="header-section-number">17.1.1</span> Red Shiner vs Water: Differential Phyla</a></li>
  <li><a href="#sand-shiner-vs-water-differential-phyla" id="toc-sand-shiner-vs-water-differential-phyla" class="nav-link" data-scroll-target="#sand-shiner-vs-water-differential-phyla"><span class="header-section-number">17.1.2</span> Sand Shiner vs Water: Differential Phyla</a></li>
  <li><a href="#sand-shiner-vs-red-shiner-differential-phyla" id="toc-sand-shiner-vs-red-shiner-differential-phyla" class="nav-link" data-scroll-target="#sand-shiner-vs-red-shiner-differential-phyla"><span class="header-section-number">17.1.3</span> Sand Shiner vs Red Shiner: Differential Phyla</a></li>
  </ul></li>
  <li><a href="#family-level" id="toc-family-level" class="nav-link" data-scroll-target="#family-level"><span class="header-section-number">17.2</span> Family Level</a>
  <ul class="collapse">
  <li><a href="#red-shiner-vs-water" id="toc-red-shiner-vs-water" class="nav-link" data-scroll-target="#red-shiner-vs-water"><span class="header-section-number">17.2.1</span> Red shiner vs Water</a></li>
  <li><a href="#sand-shiner-vs-water" id="toc-sand-shiner-vs-water" class="nav-link" data-scroll-target="#sand-shiner-vs-water"><span class="header-section-number">17.2.2</span> Sand shiner vs Water</a></li>
  <li><a href="#look-for-patterns-in-family-selection-between-species" id="toc-look-for-patterns-in-family-selection-between-species" class="nav-link" data-scroll-target="#look-for-patterns-in-family-selection-between-species"><span class="header-section-number">17.2.3</span> Look for patterns in family selection between species</a></li>
  <li><a href="#sand-shiner-vs-red-shiner" id="toc-sand-shiner-vs-red-shiner" class="nav-link" data-scroll-target="#sand-shiner-vs-red-shiner"><span class="header-section-number">17.2.4</span> Sand shiner vs Red shiner</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#overview-of-abundant-phyla" id="toc-overview-of-abundant-phyla" class="nav-link" data-scroll-target="#overview-of-abundant-phyla"><span class="header-section-number">18</span> Overview of abundant phyla</a></li>
  <li><a href="#overview-of-abundant-families" id="toc-overview-of-abundant-families" class="nav-link" data-scroll-target="#overview-of-abundant-families"><span class="header-section-number">19</span> Overview of abundant families</a></li>
  <li><a href="#core-microbiomes" id="toc-core-microbiomes" class="nav-link" data-scroll-target="#core-microbiomes"><span class="header-section-number">20</span> Core Microbiomes</a>
  <ul class="collapse">
  <li><a href="#taxonomic-resolution" id="toc-taxonomic-resolution" class="nav-link" data-scroll-target="#taxonomic-resolution"><span class="header-section-number">20.1</span> Taxonomic resolution</a></li>
  <li><a href="#core-definition-and-function-writing" id="toc-core-definition-and-function-writing" class="nav-link" data-scroll-target="#core-definition-and-function-writing"><span class="header-section-number">20.2</span> Core Definition and Function writing</a></li>
  <li><a href="#water-core" id="toc-water-core" class="nav-link" data-scroll-target="#water-core"><span class="header-section-number">20.3</span> Water Core</a></li>
  <li><a href="#red-shiner-core" id="toc-red-shiner-core" class="nav-link" data-scroll-target="#red-shiner-core"><span class="header-section-number">20.4</span> Red Shiner Core</a></li>
  <li><a href="#sand-shiner-core" id="toc-sand-shiner-core" class="nav-link" data-scroll-target="#sand-shiner-core"><span class="header-section-number">20.5</span> Sand Shiner Core</a></li>
  </ul></li>
  <li><a href="#shared-and-unique-taxa" id="toc-shared-and-unique-taxa" class="nav-link" data-scroll-target="#shared-and-unique-taxa"><span class="header-section-number">21</span> Shared and Unique Taxa</a></li>
  <li><a href="#taxa-rel-abundances" id="toc-taxa-rel-abundances" class="nav-link" data-scroll-target="#taxa-rel-abundances"><span class="header-section-number">22</span> Taxa Rel Abundances</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">23</span> Session info</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>In this file, I will asses variations in microbial alpha and beta diversity by river location and fish species.</p>
<section id="setup" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup</h1>
<p>To begin load libraries and bring in the phyloseq object created in <code>FishMicrobeAnalysis2.qmd</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"phyloseq"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"sf"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggmap"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"MicrobiotaProcess"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"vegan"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"file2meco"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"microeco"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"pheatmap"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dunn.test"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lubridate"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"grid"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggvenn"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DESeq2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">14022</span><span class="sc">\\</span><span class="st">OneDrive - University of Nebraska-Lincoln</span><span class="sc">\\</span><span class="st">eDNA Rivers project</span><span class="sc">\\</span><span class="st">Fish_data</span><span class="sc">\\</span><span class="st">MicrobiomeAnalysis_KristaAndFederica</span><span class="sc">\\</span><span class="st">ps_final_analyze.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fixing some data entry errors I noticed by mapping the coordinates. Some stations/fish listed as nloup are actually from the mloup river.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There is a station called "southstpaul" on 6/24/2019 water and fish fecal samples were collected. On this day the river was labeled "nloup" but the coordinates are actually in the mloup river.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ps_final_analyze<span class="sc">@</span>sam_data[ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">==</span> <span class="st">"southstpaul"</span>,]<span class="sc">$</span>river <span class="ot">=</span> <span class="st">"mloup"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 111-7 is fecal but does not have a species identification. I will remove it from the data set.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID <span class="sc">!=</span> <span class="st">"111-7"</span>, ps_final_analyze)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
</div>
<p>I’m also going to write the sample data included in the phyloseq object to it’s own environment object so I can access it easier to plan my analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ps_total <span class="ot">=</span> ps_final_analyze</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> ps_final_analyze<span class="sc">@</span>sam_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="keep-only-water-samples-associated-with-fish-samples-and-only-fish-samples-with-associated-water-samples" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="keep-only-water-samples-associated-with-fish-samples-and-only-fish-samples-with-associated-water-samples"><span class="header-section-number">1.1</span> Keep only water samples associated with fish samples, and only fish samples with associated water samples</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object that keeps all water samples that have a fecal sample on the same day in the same river.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>((meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>) <span class="sc">|</span> ((meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>) <span class="sc">&amp;</span> (meta<span class="sc">$</span>fieldDate <span class="sc">%in%</span> meta<span class="sc">$</span>fieldDate[meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>]) <span class="sc">&amp;</span> (meta<span class="sc">$</span>river <span class="sc">%in%</span> meta<span class="sc">$</span>river[meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>])), ps_final_analyze)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> ps_final_analyze<span class="sc">@</span>sam_data</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># make the phyloseq object that only keeps fecal samples that have a water sample from the same river on the same day.</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>((meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>) <span class="sc">|</span> ((meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>) <span class="sc">&amp;</span> (meta<span class="sc">$</span>river <span class="sc">%in%</span> meta<span class="sc">$</span>river[meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>]) <span class="sc">&amp;</span> (meta<span class="sc">$</span>fieldDate <span class="sc">%in%</span> meta<span class="sc">$</span>fieldDate[meta<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>])), ps_final_analyze)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> ps_final_analyze<span class="sc">@</span>sam_data</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>ps_final_analyze</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1613 taxa and 73 samples ]
sample_data() Sample Data:       [ 73 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 1613 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 1613 tips and 1612 internal nodes ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The above filtering worked pretty well but it leaves a few special cases that I will address more specifically.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove water sample from station "sumnerroad" on 7/25/2019. - no fish were collected here on this day.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">!=</span> <span class="st">"sumnerroad"</span>, ps_final_analyze)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove water sample from station "emmet" on 7/2/2019. - no fish were colleted here on this day.</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">!=</span> <span class="st">"emmet"</span>, ps_final_analyze)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Station "northmiller" has the same coordinates as station "hwy183". Changing to use only 1 station name.</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ps_final_analyze<span class="sc">@</span>sam_data[ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">==</span> <span class="st">"northmiller"</span>,]<span class="sc">$</span>station <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Station "northMiller" has the same coordinates as station "hwy183". Changing to use only 1 station name.</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>ps_final_analyze<span class="sc">@</span>sam_data[ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">==</span> <span class="st">"northMiller"</span>,]<span class="sc">$</span>station <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove fish samples from station "ewig" on 7/2/2019. - no associated water sample</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="do">### This removes 4 red shiners and 1 sand shiner</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>ps_final_analyze<span class="sc">@</span>sam_data[ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">==</span> <span class="st">"ewing"</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      X.4 X.3 X.2 X.1    X miseqID sampleID sample_or_control sampleType
117-2  50  61  61 251 S243    S243    117-2            sample      fecal
117-3  51  62  62 252 S244    S244    117-3            sample      fecal
117-4  52  63  63 253 S245    S245    117-4            sample      fecal
117-5  53  64  64 254 S246    S246    117-5            sample      fecal
117-6  54  65  65 255 S247    S247    117-6            sample      fecal
      station   river latitude longitude speciesCode  commonName fieldDate
117-2   ewing elkhorn 42.25146 -98.33856         120  Red shiner  7/2/2019
117-3   ewing elkhorn 42.25146 -98.33856         120  Red shiner  7/2/2019
117-4   ewing elkhorn 42.25146 -98.33856         120  Red shiner  7/2/2019
117-5   ewing elkhorn 42.25146 -98.33856         120  Red shiner  7/2/2019
117-6   ewing elkhorn 42.25146 -98.33856         144 Sand shiner  7/2/2019
      ammonia turbidity   do temperature   no3 totalNitrogen totalPhosphorus
117-2     0.8     38.73 5.91        27.7 0.403         1.411           0.259
117-3     0.8     38.73 5.91        27.7 0.403         1.411           0.259
117-4     0.8     38.73 5.91        27.7 0.403         1.411           0.259
117-5     0.8     38.73 5.91        27.7 0.403         1.411           0.259
117-6     0.8     38.73 5.91        27.7 0.403         1.411           0.259
      phosphatePhosphorus kjedahlNitrogen pH suspendedSolids ecoli
117-2                  NA              NA NA              NA    NA
117-3                  NA              NA NA              NA    NA
117-4                  NA              NA NA              NA    NA
117-5                  NA              NA NA              NA    NA
117-6                  NA              NA NA              NA    NA
      specificConductance is.neg
117-2                  NA  FALSE
117-3                  NA  FALSE
117-4                  NA  FALSE
117-5                  NA  FALSE
117-6                  NA  FALSE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">!=</span> <span class="st">"ewing"</span>, ps_final_analyze)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove fish samples from station "sartoria" on 6/24/2019. - no associated water sample.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">=</span> <span class="fu">prune_samples</span>(<span class="sc">!</span>(ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">==</span> <span class="st">"sartoria"</span> <span class="sc">&amp;</span> ps_final_analyze<span class="sc">@</span>sam_data<span class="sc">$</span>fieldDate <span class="sc">==</span> <span class="st">"6/24/2019"</span>), ps_final_analyze)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Since I removed samples it is possible the data now has ASVs that are not found in any sample. I will remove these</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>ps_final_analyze <span class="ot">&lt;-</span> <span class="fu">prune_species</span>(<span class="fu">speciesSums</span>(ps_final_analyze) <span class="sc">&gt;</span> <span class="dv">0</span>, ps_final_analyze)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>ps_final_analyze</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1247 taxa and 60 samples ]
sample_data() Sample Data:       [ 60 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 1247 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 1247 tips and 1246 internal nodes ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ps_paired_data <span class="ot">=</span> ps_final_analyze</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ps_final_analyze)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(ps_paired_data, "ps_paired_data.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="created-transformed-data-sets" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Created transformed data sets</h1>
<section id="proportional-abundance" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="proportional-abundance"><span class="header-section-number">2.1</span> Proportional Abundance</h2>
<p>Transform the data from raw read count to the proportional abundance. This allows for comparison between samples of various read depths. Proportional abundance data will be used for Beta diversity metrics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ps_norm <span class="ot">&lt;-</span>  <span class="fu">transform_sample_counts</span>(ps_paired_data, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="fu">sum</span>(x) )</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ps_norm<span class="sc">@</span>otu_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> , <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OTU Table:          [6 taxa and 6 samples]
                     taxa are rows
                 110 110-10        110-2 110-3 110-5       110-6
ASV_1720 0.000000000      0 0.0000000000     0     0 0.000000000
ASV_296  0.000489716      0 0.0000000000     0     0 0.000000000
ASV_1451 0.000000000      0 0.0000000000     0     0 0.002243451
ASV_2021 0.000000000      0 0.0003202961     0     0 0.000000000
ASV_1871 0.000000000      0 0.0000000000     0     0 0.000000000
ASV_2249 0.000000000      0 0.0000000000     0     0 0.000000000</code></pre>
</div>
</div>
</section>
<section id="create-rarefied-data-set" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="create-rarefied-data-set"><span class="header-section-number">2.2</span> Create rarefied data set</h2>
<p>Use rarefaction to normalize all the samples to a consistent size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co">#ensure results are the same </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ps_rarefy <span class="ot">&lt;-</span> <span class="fu">rarefy_even_depth</span>(ps_paired_data, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(ps_paired_data)),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rngseed =</span> T, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">trimOTUs =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sample_sums</span>(ps_rarefy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   110 110-10  110-2  110-3  110-5  110-6 
  5092   5092   5092   5092   5092   5092 </code></pre>
</div>
</div>
</section>
<section id="data-subsets" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="data-subsets"><span class="header-section-number">2.3</span> Data Subsets</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># relative abund of ps_total which is all samples regarldess of if they have a pair of water-fecal samples</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ps_total_norm <span class="ot">&lt;-</span>  <span class="fu">transform_sample_counts</span>(ps_total, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="fu">sum</span>(x) )</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ps_total_norm<span class="sc">@</span>otu_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> , <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OTU Table:          [6 taxa and 6 samples]
                     taxa are rows
         100 101          102 103 104 105
ASV_1720   0   0 0.0000000000   0   0   0
ASV_901    0   0 0.0001144427   0   0   0
ASV_296    0   0 0.0000000000   0   0   0
ASV_1451   0   0 0.0000000000   0   0   0
ASV_2021   0   0 0.0000000000   0   0   0
ASV_1161   0   0 0.0000000000   0   0   0</code></pre>
</div>
</div>
</section>
</section>
<section id="map-and-general-info" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Map and General Info</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/plot_map-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Map Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>The map uses two publicly available shape files: <code>cb_2018_us_state_5m.shp</code> <span class="citation" data-cites="census2021">[@census2021]</span> and <code>HYDRO_MajorStream_DNR.shp</code> <span class="citation" data-cites="nebraskamap2019">[@nebraskamap2019]</span>. This <code>sf</code> package <a href="https://learning.nceas.ucsb.edu/2019-11-RRCourse/spatial-vector-analysis-using-sf.html">tutorial</a> was very helpful in creating the above map.</p>
</div>
</div>
</section>
<section id="alpha-diversity-entire-data-set" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Alpha Diversity (entire data set)</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Water samples have NA for commonName, change the NA to "water"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>] <span class="ot">=</span> <span class="st">"Water"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get diversity metrics</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>alpha_enitre <span class="ot">=</span> <span class="fu">estimate_richness</span>(ps_paired_data, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a sampleID column</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>alpha_enitre<span class="sc">$</span>sampleID <span class="ot">=</span> ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Change row names to be sampleID</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(alpha_enitre) <span class="ot">=</span> ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with metadata by sampleID</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>extrainfo <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ps_paired_data))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>alpha_enitre <span class="ot">=</span> <span class="fu">merge</span>(alpha_enitre, extrainfo, <span class="at">by =</span> <span class="st">"sampleID"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>alpha_enitre<span class="sc">$</span>obs_title <span class="ot">=</span> <span class="st">"Observed ASVs"</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(alpha_enitre, file = "alphaMetrics_entire.csv", row.names=TRUE)</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># I only want to plot alpha diversity metrics for Water, Red shiner, and Sand shiner.</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Water"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Sand shiner"</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>alpha_interest <span class="ot">=</span> alpha_enitre[alpha_enitre<span class="sc">$</span>commonName <span class="sc">%in%</span> keep , ]</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(alpha_interest, file = "alphaMetrics_interest_samples.csv", row.names=TRUE)</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Making my own figure with box plots instead of each point plotted</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest)<span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> commonName,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Observed))<span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> obs_title)<span class="sc">+</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="ot">-&gt;</span> obs_bar</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>alpha_interest<span class="sc">$</span>shann_title <span class="ot">=</span> <span class="st">"Shannon"</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest)<span class="sc">+</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> commonName,</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Shannon))<span class="sc">+</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> shann_title)<span class="sc">+</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="ot">-&gt;</span> shann_bar</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>alpha_interest<span class="sc">$</span>simp_title <span class="ot">=</span> <span class="st">"Simpson"</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest)<span class="sc">+</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> commonName,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Simpson))<span class="sc">+</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> simp_title)<span class="sc">+</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="ot">-&gt;</span> simp_bar</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(obs_bar, shann_bar, simp_bar,</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Alpha Diversity Metric"</span>) <span class="ot">-&gt;</span> entire_alpha_fig</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>entire_alpha_fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/KS_plot_aplha-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/alpha_entire.png",entire_alpha_fig, height = 5, width = 7, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="alpha-diversity-rarefied-data-set" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Alpha Diversity (Rarefied data set)</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Water samples have NA for commonName, change the NA to "water"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ps_rarefy<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_rarefy<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>] <span class="ot">=</span> <span class="st">"Water"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get diversity metrics</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>alpha_rarefy <span class="ot">=</span> <span class="fu">estimate_richness</span>(ps_rarefy, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a sampleID column</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>alpha_rarefy<span class="sc">$</span>sampleID <span class="ot">=</span> ps_rarefy<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Change row names to be sampleID</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(alpha_rarefy) <span class="ot">=</span> ps_rarefy<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with metadata by sampleID</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>extrainfo <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ps_rarefy))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>alpha_rarefy <span class="ot">=</span> <span class="fu">merge</span>(alpha_rarefy, extrainfo, <span class="at">by =</span> <span class="st">"sampleID"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># I only want to plot alpha diversity metrics for Water, Red shiner, and Sand shiner.</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Water"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Sand shiner"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>alpha_interest_rarefy <span class="ot">=</span> alpha_rarefy[alpha_rarefy<span class="sc">$</span>commonName <span class="sc">%in%</span> keep , ]</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Making my own figure with box plots instead of each point plotted</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>alpha_interest_rarefy<span class="sc">$</span>obs_title <span class="ot">=</span> <span class="st">"Observed ASVs"</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest_rarefy)<span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> commonName,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Observed))<span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> obs_title)<span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="ot">-&gt;</span> obs_bar</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>alpha_interest_rarefy<span class="sc">$</span>shann_title <span class="ot">=</span> <span class="st">"Shannon"</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest_rarefy)<span class="sc">+</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> commonName,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Shannon))<span class="sc">+</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> shann_title)<span class="sc">+</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="ot">-&gt;</span> shann_bar</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>alpha_interest_rarefy<span class="sc">$</span>simp_title <span class="ot">=</span> <span class="st">"Simpson"</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest_rarefy)<span class="sc">+</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> commonName,</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Simpson))<span class="sc">+</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> simp_title)<span class="sc">+</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="ot">-&gt;</span> simp_bar</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(obs_bar, shann_bar, simp_bar,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Alpha Diversity Metric"</span>) <span class="ot">-&gt;</span> rare_alpha_fig</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>rare_alpha_fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/KS_plot_aplha_rarefy-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/alpha_rare.png",rare_alpha_fig, height = 5, width = 7, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="entire-vs-rarefy-results" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Entire vs Rarefy Results</h1>
<p>Checking for normal distribution of entire data set alpha diversity metrics through quick figures of the distribution and using the Shapiro-Wilk test. Table of Shapiro-Wilk test results for the entire data set alpha diversity metrics is below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Observed, <span class="at">fill =</span> commonName),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="ot">-&gt;</span> obs_dist</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Shannon, <span class="at">fill =</span> commonName),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> shann_dist</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Simpson, <span class="at">fill =</span> commonName),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="ot">-&gt;</span> simp_dist</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(obs_dist, shann_dist, simp_dist,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/normality_check_entire-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>obs_entire_red <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Red shiner"</span>, <span class="st">"Observed"</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>obs_entire_sand <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Sand shiner"</span>, <span class="st">"Observed"</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>obs_entire_water <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Water"</span>, <span class="st">"Observed"</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>shann_entire_red <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Red shiner"</span>, <span class="st">"Shannon"</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>shann_entire_sand <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Sand shiner"</span>, <span class="st">"Shannon"</span>]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>shann_entire_water <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Water"</span>, <span class="st">"Shannon"</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>simp_entire_red <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Red shiner"</span>, <span class="st">"Simpson"</span>]</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>simp_entire_sand <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Sand shiner"</span>, <span class="st">"Simpson"</span>]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>simp_entire_water <span class="ot">=</span> alpha_interest[alpha_interest[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Water"</span>, <span class="st">"Simpson"</span>]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># do shapiro-wilk test</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>shap_red_obs <span class="ot">=</span> <span class="fu">shapiro.test</span>(obs_entire_red)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>shap_sand_obs <span class="ot">=</span> <span class="fu">shapiro.test</span>(obs_entire_sand)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>shap_water_obs <span class="ot">=</span> <span class="fu">shapiro.test</span>(obs_entire_water)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>shap_red_shann <span class="ot">=</span> <span class="fu">shapiro.test</span>(shann_entire_red)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>shap_sand_shann <span class="ot">=</span> <span class="fu">shapiro.test</span>(shann_entire_sand)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>shap_water_shann <span class="ot">=</span> <span class="fu">shapiro.test</span>(shann_entire_water)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>shap_red_simp <span class="ot">=</span> <span class="fu">shapiro.test</span>(simp_entire_red)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>shap_sand_simp <span class="ot">=</span> <span class="fu">shapiro.test</span>(simp_entire_sand)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>shap_water_simp <span class="ot">=</span> <span class="fu">shapiro.test</span>(simp_entire_water)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># str(shap_red_obs)</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="co"># shap_red_obs$p.value</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="co"># shap_red_obs$statistic</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>),</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">red_shiner =</span> <span class="fu">c</span>(shap_red_obs<span class="sc">$</span>p.value, shap_red_shann<span class="sc">$</span>p.value, shap_red_simp<span class="sc">$</span>p.value),</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">sand_shiner =</span> <span class="fu">c</span>(shap_sand_obs<span class="sc">$</span>p.value, shap_sand_shann<span class="sc">$</span>p.value, shap_sand_simp<span class="sc">$</span>p.value),</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">water =</span> <span class="fu">c</span>(shap_water_obs<span class="sc">$</span>p.value, shap_water_shann<span class="sc">$</span>p.value, shap_water_simp<span class="sc">$</span>p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">red_shiner =</span> <span class="fu">round</span>(red_shiner, <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">sand_shiner =</span> <span class="fu">round</span>(sand_shiner, <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">water =</span> <span class="fu">round</span>(water, <span class="at">digits =</span> <span class="dv">6</span>)) <span class="ot">-&gt;</span> entire_dist_test</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>entire_dist_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  metric   red_shiner sand_shiner  water
  &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1 Observed   0.0838       0.282   0.458 
2 Shannon    0.123        0.00847 0.906 
3 Simpson    0.000341     0.00180 0.0273</code></pre>
</div>
</div>
<p>Checking for normal distribution of rarefied data set alpha diversity metrics through quick figures of the distribution and using the Shapiro-Wilk test. Table of Shapiro-Wilk test results for the rarefied data set alpha diversity metrics found below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest_rarefy) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Observed, <span class="at">fill =</span> commonName),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="ot">-&gt;</span> obs_dist</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest_rarefy) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Shannon, <span class="at">fill =</span> commonName),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="ot">-&gt;</span> shann_dist</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> alpha_interest_rarefy) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Simpson, <span class="at">fill =</span> commonName),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())<span class="ot">-&gt;</span> simp_dist</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(obs_dist, shann_dist, simp_dist,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/normality_check_rarefy-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>obs_rarefy_red <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Red shiner"</span>, <span class="st">"Observed"</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>obs_rarefy_sand <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Sand shiner"</span>, <span class="st">"Observed"</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>obs_rarefy_water <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Water"</span>, <span class="st">"Observed"</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>shann_rarefy_red <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Red shiner"</span>, <span class="st">"Shannon"</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>shann_rarefy_sand <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Sand shiner"</span>, <span class="st">"Shannon"</span>]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>shann_rarefy_water <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Water"</span>, <span class="st">"Shannon"</span>]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>simp_rarefy_red <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Red shiner"</span>, <span class="st">"Simpson"</span>]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>simp_rarefy_sand <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Sand shiner"</span>, <span class="st">"Simpson"</span>]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>simp_rarefy_water <span class="ot">=</span> alpha_interest_rarefy[alpha_interest_rarefy[,<span class="st">"commonName"</span>] <span class="sc">==</span> <span class="st">"Water"</span>, <span class="st">"Simpson"</span>]</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># do shapiro-wilk test</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>shap_red_obs <span class="ot">=</span> <span class="fu">shapiro.test</span>(obs_rarefy_red)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>shap_sand_obs <span class="ot">=</span> <span class="fu">shapiro.test</span>(obs_rarefy_sand)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>shap_water_obs <span class="ot">=</span> <span class="fu">shapiro.test</span>(obs_rarefy_water)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>shap_red_shann <span class="ot">=</span> <span class="fu">shapiro.test</span>(shann_rarefy_red)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>shap_sand_shann <span class="ot">=</span> <span class="fu">shapiro.test</span>(shann_rarefy_sand)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>shap_water_shann <span class="ot">=</span> <span class="fu">shapiro.test</span>(shann_rarefy_water)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>shap_red_simp <span class="ot">=</span> <span class="fu">shapiro.test</span>(simp_rarefy_red)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>shap_sand_simp <span class="ot">=</span> <span class="fu">shapiro.test</span>(simp_rarefy_sand)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>shap_water_simp <span class="ot">=</span> <span class="fu">shapiro.test</span>(simp_rarefy_water)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># str(shap_red_obs)</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co"># shap_red_obs$p.value</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="co"># shap_red_obs$statistic</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>),</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">red_shiner =</span> <span class="fu">c</span>(shap_red_obs<span class="sc">$</span>p.value, shap_red_shann<span class="sc">$</span>p.value, shap_red_simp<span class="sc">$</span>p.value),</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">sand_shiner =</span> <span class="fu">c</span>(shap_sand_obs<span class="sc">$</span>p.value, shap_sand_shann<span class="sc">$</span>p.value, shap_sand_simp<span class="sc">$</span>p.value),</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">water =</span> <span class="fu">c</span>(shap_water_obs<span class="sc">$</span>p.value, shap_water_shann<span class="sc">$</span>p.value, shap_water_simp<span class="sc">$</span>p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">red_shiner =</span> <span class="fu">round</span>(red_shiner, <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">sand_shiner =</span> <span class="fu">round</span>(sand_shiner, <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">water =</span> <span class="fu">round</span>(water, <span class="at">digits =</span> <span class="dv">6</span>)) <span class="ot">-&gt;</span> rarefy_dist_test</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>rarefy_dist_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  metric   red_shiner sand_shiner  water
  &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1 Observed   0.0899       0.191   0.441 
2 Shannon    0.0986       0.00948 0.735 
3 Simpson    0.000312     0.00182 0.0316</code></pre>
</div>
</div>
<p>Use Wilcoxon Rank Sum Test to see if there are significant differences between the alpha diversity metric results of the entire data set compared to the rarefied data set.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed ASVs</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>obs_red <span class="ot">=</span> <span class="fu">wilcox.test</span>(obs_entire_red, obs_rarefy_red)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>obs_sand <span class="ot">=</span> <span class="fu">wilcox.test</span>(obs_entire_sand, obs_rarefy_sand)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>obs_water <span class="ot">=</span> <span class="fu">wilcox.test</span>(obs_entire_water, obs_rarefy_water)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Shannon</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>shann_red <span class="ot">=</span> <span class="fu">wilcox.test</span>(shann_entire_red, shann_rarefy_red)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>shann_sand <span class="ot">=</span> <span class="fu">wilcox.test</span>(shann_entire_sand, shann_rarefy_sand)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>shann_water <span class="ot">=</span> <span class="fu">wilcox.test</span>(shann_entire_water, shann_rarefy_water)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Simpson</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>simp_red <span class="ot">=</span> <span class="fu">wilcox.test</span>(simp_entire_red, simp_rarefy_red)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>simp_sand <span class="ot">=</span> <span class="fu">wilcox.test</span>(simp_entire_sand, simp_rarefy_sand)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>simp_water <span class="ot">=</span> <span class="fu">wilcox.test</span>(simp_entire_water, simp_rarefy_water)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># str(obs_red)</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># obs_red$p.value</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"Simpson"</span>),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">red_shiner =</span> <span class="fu">c</span>(obs_red<span class="sc">$</span>p.value, shann_red<span class="sc">$</span>p.value, simp_red<span class="sc">$</span>p.value),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">sand_shiner =</span> <span class="fu">c</span>(obs_sand<span class="sc">$</span>p.value, shann_sand<span class="sc">$</span>p.value, simp_sand<span class="sc">$</span>p.value),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">water =</span> <span class="fu">c</span>(obs_water<span class="sc">$</span>p.value, shann_water<span class="sc">$</span>p.value, simp_water<span class="sc">$</span>p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">red_shiner =</span> <span class="fu">round</span>(red_shiner, <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">sand_shiner =</span> <span class="fu">round</span>(sand_shiner, <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">water =</span> <span class="fu">round</span>(water, <span class="at">digits =</span> <span class="dv">6</span>)) <span class="ot">-&gt;</span> wilcox_entire_vs_rarefy</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>wilcox_entire_vs_rarefy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  metric   red_shiner sand_shiner water
  &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
1 Observed      0.819       0.748 0.650
2 Shannon       0.921       0.874 0.436
3 Simpson       0.993       0.982 0.579</code></pre>
</div>
</div>
</section>
<section id="alpha-statistics" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Alpha Statistics</h1>
<ul>
<li>Summary statistics</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>alpha_interest <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(commonName) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">obs_mean =</span> <span class="fu">mean</span>(Observed),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">obs_sd =</span> <span class="fu">sd</span>(Observed),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">obs_median =</span> <span class="fu">median</span>(Observed),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">shannon_mean =</span> <span class="fu">mean</span>(Shannon),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">shannon_sd =</span> <span class="fu">sd</span>(Shannon),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">shannon_median =</span> <span class="fu">median</span>(Shannon),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">simpson_mean =</span> <span class="fu">mean</span>(Simpson),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">simpson_sd =</span> <span class="fu">sd</span>(Simpson),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">simpson_median =</span> <span class="fu">median</span>(Simpson)) <span class="ot">-&gt;</span> alpha_summary_table</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>alpha_summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  commonName  obs_mean obs_sd obs_median shannon_mean shannon_sd shannon_median
  &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;
1 Red shiner      82.1   42.0         74         2.64      0.916           2.81
2 Sand shiner    117.    48.2        134         3.05      1.00            3.50
3 Water          258.    41.0        266         4.67      0.104           4.67
# ℹ 3 more variables: simpson_mean &lt;dbl&gt;, simpson_sd &lt;dbl&gt;,
#   simpson_median &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(alpha_summary_table, "alpha_summary_table.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>Significance testing</p>
<ul>
<li>Observed ASVs</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>observed_aov <span class="ot">=</span> <span class="fu">aov</span>(Observed <span class="sc">~</span> commonName, alpha_interest)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(observed_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
commonName   2 225592  112796   59.26 1.42e-13 ***
Residuals   47  89454    1903                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>observed_posthoc <span class="ot">=</span> <span class="fu">TukeyHSD</span>(observed_aov)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(observed_posthoc<span class="sc">$</span>commonName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           diff          lwr       upr        p adj
Sand shiner-Red shiner  35.0989   0.09896643  70.09884 4.921696e-02
Water-Red shiner       175.9846 136.69728616 215.27194 0.000000e+00
Water-Sand shiner      140.8857  97.17080990 184.60062 1.516240e-09</code></pre>
</div>
</div>
<ul>
<li>Shannon Index</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>shann_krusk <span class="ot">=</span> <span class="fu">kruskal.test</span>(Shannon <span class="sc">~</span> commonName, alpha_interest)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>shann_krusk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Shannon by commonName
Kruskal-Wallis chi-squared = 25.151, df = 2, p-value = 3.455e-06</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunn.test</span>(<span class="at">x =</span> alpha_interest<span class="sc">$</span>Shannon, <span class="at">g =</span> alpha_interest<span class="sc">$</span>commonName, <span class="at">method =</span> <span class="st">"bh"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Kruskal-Wallis rank sum test

data: x and group
Kruskal-Wallis chi-squared = 25.1511, df = 2, p-value = 0

                           Comparison of x by group                            
                             (Benjamini-Hochberg)                              
Col Mean-|
Row Mean |   Red shin   Sand shi
---------+----------------------
Sand shi |  -1.273467
         |     0.1014
         |
   Water |  -5.005959  -3.479350
         |    0.0000*    0.0004*

alpha = 0.05
Reject Ho if p &lt;= alpha/2</code></pre>
</div>
</div>
<ul>
<li>Simpson Index</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>simp_krusk <span class="ot">=</span> <span class="fu">kruskal.test</span>(Simpson <span class="sc">~</span> commonName, alpha_interest)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>simp_krusk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Simpson by commonName
Kruskal-Wallis chi-squared = 24.2, df = 2, p-value = 5.561e-06</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunn.test</span>(<span class="at">x =</span> alpha_interest<span class="sc">$</span>Simpson, <span class="at">g =</span> alpha_interest<span class="sc">$</span>commonName, <span class="at">method =</span> <span class="st">"bh"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Kruskal-Wallis rank sum test

data: x and group
Kruskal-Wallis chi-squared = 24.1996, df = 2, p-value = 0

                           Comparison of x by group                            
                             (Benjamini-Hochberg)                              
Col Mean-|
Row Mean |   Red shin   Sand shi
---------+----------------------
Sand shi |  -0.818657
         |     0.2065
         |
   Water |  -4.864147  -3.716041
         |    0.0000*    0.0002*

alpha = 0.05
Reject Ho if p &lt;= alpha/2</code></pre>
</div>
</div>
</section>
<section id="beta-diversity" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Beta Diversity</h1>
<section id="pcoa-ordination" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="pcoa-ordination"><span class="header-section-number">8.1</span> PCoA ordination</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for NA values</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># any(is.na(ps_norm@sam_data$sampleType))</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># any(is.na(ps_norm@sam_data$commonName))</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Water samples have NA for commonName, change the NA to "water"</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>ps_norm<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_norm<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>] <span class="ot">=</span> <span class="st">"Water"</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># any(is.na(ps_norm@sam_data$river))</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only interest fish species</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Water"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Sand shiner"</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>ps_norm <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_norm<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">%in%</span> keep, ps_norm)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>distme <span class="ot">&lt;-</span> <span class="fu">get_dist</span>(ps_norm, <span class="at">distmethod =</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>sampleda <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ps_norm), <span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>sampleda <span class="ot">&lt;-</span> sampleda[<span class="fu">match</span>(<span class="fu">colnames</span>(<span class="fu">as.matrix</span>(distme)),<span class="fu">rownames</span>(sampleda)),,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>pcoares <span class="ot">&lt;-</span> <span class="fu">get_pcoa</span>(<span class="at">obj=</span>ps_norm, <span class="at">distmethod=</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># str(pcoares)</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># class(pcoares)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pcoares@pca$trace</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pcoares@pca$vectors</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># first and third principal co-ordinates</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>pcoaplot1 <span class="ot">&lt;-</span> <span class="fu">ggordpoint</span>(<span class="at">obj=</span>pcoares, <span class="at">pc=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">biplot=</span><span class="cn">TRUE</span>, <span class="at">speciesannot=</span><span class="cn">TRUE</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">factorNames=</span><span class="fu">c</span>(<span class="st">"commonName"</span>, <span class="st">"station"</span>), <span class="at">ellipse=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>pcoaplot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/PCoA_quick-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="permanova-river" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> PERMANOVA (RIVER)</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>adores1 <span class="ot">=</span> <span class="fu">adonis2</span>(distme <span class="sc">~</span> commonName <span class="sc">*</span> river, <span class="at">data=</span>sampleda, <span class="at">permutation=</span><span class="dv">9999</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>adores1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = distme ~ commonName * river, data = sampleda, permutations = 9999)
                 Df SumOfSqs      R2      F Pr(&gt;F)    
commonName        2   4.1432 0.24434 8.2998 0.0001 ***
river             2   1.4260 0.08410 2.8567 0.0002 ***
commonName:river  4   1.1539 0.06805 1.1558 0.1640    
Residual         41  10.2334 0.60351                  
Total            49  16.9565 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>adores2 <span class="ot">=</span> <span class="fu">adonis2</span>(distme <span class="sc">~</span> river <span class="sc">*</span> commonName, <span class="at">data=</span>sampleda, <span class="at">permutation=</span><span class="dv">9999</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>adores2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = distme ~ river * commonName, data = sampleda, permutations = 9999)
                 Df SumOfSqs      R2      F Pr(&gt;F)    
river             2   1.4698 0.08668 2.9443 0.0001 ***
commonName        2   4.0994 0.24176 8.2122 0.0001 ***
river:commonName  4   1.1539 0.06805 1.1558 0.1684    
Residual         41  10.2334 0.60351                  
Total            49  16.9565 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Function to do Pairwise tests</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>pairwise_adonis <span class="ot">=</span> <span class="cf">function</span>(ps, vari, g1, g2, <span class="at">seed =</span> <span class="dv">1024</span>){</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set seed</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make phyloseq subset</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  sample_sub <span class="ot">=</span> <span class="fu">prune_samples</span>((ps<span class="sc">@</span>sam_data[[vari]] <span class="sc">==</span> g1 <span class="sc">|</span> ps<span class="sc">@</span>sam_data[[vari]] <span class="sc">==</span> g2), ps)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  sample_sub <span class="ot">=</span> phyloseq<span class="sc">::</span><span class="fu">prune_taxa</span>(phyloseq<span class="sc">::</span><span class="fu">taxa_sums</span>(sample_sub) <span class="sc">&gt;</span> <span class="dv">0</span>, sample_sub)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get distance matrix</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  dist <span class="ot">=</span> MicrobiotaProcess<span class="sc">::</span><span class="fu">get_dist</span>(sample_sub, <span class="at">distmethod =</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make sample data frame</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  sample_dat <span class="ot">=</span> <span class="fu">data.frame</span>(phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(sample_sub), <span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  sample_dat <span class="ot">=</span> sample_dat[<span class="fu">match</span>(<span class="fu">colnames</span>(<span class="fu">as.matrix</span>(dist)),<span class="fu">rownames</span>(sample_dat)),,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do PERMANOVA</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  model_call <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"dist~"</span>,vari))</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  permanova <span class="ot">=</span> vegan<span class="sc">::</span><span class="fu">adonis2</span>(model_call, <span class="at">data =</span> sample_dat, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do BETADISPER</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  dispersion_test <span class="ot">=</span> vegan<span class="sc">::</span><span class="fu">betadisper</span>(<span class="at">d =</span> dist, <span class="at">group =</span> sample_dat[[vari]])</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">list</span>(<span class="at">sample_data =</span> <span class="fu">as.data.frame</span>(sample_sub<span class="sc">@</span>sam_data),</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">model_call =</span> <span class="fu">paste0</span>(<span class="st">"dist~"</span>,vari),</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">permanova =</span> permanova,</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">betadisper =</span> dispersion_test)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pairwise-permanova" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="pairwise-permanova"><span class="header-section-number">9.1</span> Pairwise Permanova</h2>
<section id="sample-type" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="sample-type"><span class="header-section-number">9.1.1</span> Sample Type</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Sand shiner</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>red_sand_test <span class="ot">=</span> <span class="fu">pairwise_adonis</span>(<span class="at">ps =</span> ps_norm, </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">vari =</span> <span class="st">"commonName"</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">g1 =</span> <span class="st">"Red shiner"</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">g2 =</span> <span class="st">"Sand shiner"</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>red_sand_test<span class="sc">$</span>model_call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dist~commonName"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>red_sand_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

vegan::adonis2(formula = model_call, data = sample_dat, permutations = 9999)
           Df SumOfSqs      R2      F Pr(&gt;F)   
commonName  1   0.5618 0.04576 1.8223 0.0082 **
Residual   38  11.7143 0.95424                 
Total      39  12.2761 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Water</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>red_water_test <span class="ot">=</span> <span class="fu">pairwise_adonis</span>(<span class="at">ps =</span> ps_norm,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">vari =</span> <span class="st">"commonName"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">g1 =</span> <span class="st">"Red shiner"</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">g2 =</span> <span class="st">"Water"</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>red_water_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

vegan::adonis2(formula = model_call, data = sample_dat, permutations = 9999)
           Df SumOfSqs      R2      F Pr(&gt;F)    
commonName  1   3.3162 0.26522 12.273  1e-04 ***
Residual   34   9.1872 0.73478                  
Total      35  12.5034 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sand shiner vs Water</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>sand_water_test <span class="ot">=</span> <span class="fu">pairwise_adonis</span>(<span class="at">ps =</span> ps_norm, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vari =</span> <span class="st">"commonName"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">g1 =</span> <span class="st">"Sand shiner"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">g2 =</span> <span class="st">"Water"</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>sand_water_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

vegan::adonis2(formula = model_call, data = sample_dat, permutations = 9999)
           Df SumOfSqs      R2      F Pr(&gt;F)    
commonName  1   2.7210 0.36543 12.669  1e-04 ***
Residual   22   4.7251 0.63457                  
Total      23   7.4461 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust P-values to account for multiple testing using the Benjamani-Hochberg method</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull R2 values for data frame</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">R2 =</span> <span class="fu">c</span>(red_sand_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>], red_water_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>], sand_water_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>]))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_p_permanova) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Red - Sand"</span>, <span class="st">"Red - Water"</span>, <span class="st">"Sand - Water"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova<span class="sc">$</span>p <span class="ot">=</span> <span class="fu">c</span>(red_sand_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], red_water_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], sand_water_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>])</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_p_permanova<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     R2      p p.adjust
Red - Sand   0.04576087 0.0082  0.00820
Red - Water  0.26522456 0.0001  0.00015
Sand - Water 0.36542570 0.0001  0.00015</code></pre>
</div>
</div>
</section>
<section id="river" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="river"><span class="header-section-number">9.1.2</span> River</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mloup vs sloup</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>m_s_test <span class="ot">=</span> <span class="fu">pairwise_adonis</span>(<span class="at">ps =</span> ps_norm, </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">vari =</span> <span class="st">"river"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">g1 =</span> <span class="st">"mloup"</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">g2 =</span> <span class="st">"sloup"</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>m_s_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

vegan::adonis2(formula = model_call, data = sample_dat, permutations = 9999)
         Df SumOfSqs     R2      F Pr(&gt;F)  
river     1   0.7398 0.0508 2.1943 0.0103 *
Residual 41  13.8227 0.9492                
Total    42  14.5625 1.0000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mloup vs elkhorn</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>m_elk_test <span class="ot">=</span> <span class="fu">pairwise_adonis</span>(<span class="at">ps =</span> ps_norm,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">vari =</span> <span class="st">"river"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">g1 =</span> <span class="st">"mloup"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">g2 =</span> <span class="st">"elkhorn"</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>m_elk_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

vegan::adonis2(formula = model_call, data = sample_dat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)    
river     1   0.7897 0.14748 2.7678  8e-04 ***
Residual 16   4.5650 0.85252                  
Total    17   5.3547 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sloup vs elkhorn</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>s_elk_test <span class="ot">=</span> <span class="fu">pairwise_adonis</span>(<span class="at">ps =</span> ps_norm,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">vari =</span> <span class="st">"river"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">g1 =</span> <span class="st">"sloup"</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">g2 =</span> <span class="st">"elkhorn"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>s_elk_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

vegan::adonis2(formula = model_call, data = sample_dat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
river     1   0.7042 0.05299 2.0702 0.0141 *
Residual 37  12.5857 0.94701                
Total    38  13.2899 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust P-values to account for multiple testing using the Benjamani-Hochberg method</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull R2 values for data frame</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">R2 =</span> <span class="fu">c</span>(m_s_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>], </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                                         m_elk_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                                         s_elk_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>]))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_p_permanova) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mloup - sloup"</span>, <span class="st">"mloup - elkhorn"</span>, <span class="st">"sloup - elkhorn"</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova<span class="sc">$</span>p <span class="ot">=</span> <span class="fu">c</span>(m_s_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], </span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>                           m_elk_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>                           s_elk_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>])</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_p_permanova<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        R2      p p.adjust
mloup - sloup   0.05080008 0.0103   0.0141
mloup - elkhorn 0.14747727 0.0008   0.0024
sloup - elkhorn 0.05298568 0.0141   0.0141</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="betadisper-river" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> BETADISPER (RIVER)</h1>
<section id="sample-type-1" class="level3" data-number="10.0.1">
<h3 data-number="10.0.1" class="anchored" data-anchor-id="sample-type-1"><span class="header-section-number">10.0.1</span> Sample Type</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for heterogeneity of variance in the commonName groups</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>bd  <span class="ot">=</span> <span class="fu">betadisper</span>(<span class="at">d =</span> distme, <span class="at">group =</span> sampleda<span class="sc">$</span>commonName)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>bd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Homogeneity of multivariate dispersions

Call: betadisper(d = distme, group = sampleda$commonName)

No. of Positive Eigenvalues: 48
No. of Negative Eigenvalues: 1

Average distance to median:
 Red shiner Sand shiner       Water 
     0.5539      0.4995      0.3256 

Eigenvalues for PCoA axes:
(Showing 8 of 49 eigenvalues)
 PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
3.6590 1.6907 1.2405 1.0484 0.8795 0.8095 0.6440 0.5166 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
Groups     2 0.37751 0.188753  26.463 2.003e-08 ***
Residuals 47 0.33523 0.007133                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)    
Groups     2 0.37751 0.188753 26.463    999  0.001 ***
Residuals 47 0.33523 0.007133                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>####pairwise:sampleType</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Sand shiner</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>red_sand_tab <span class="ot">=</span> <span class="fu">anova</span>(red_sand_test<span class="sc">$</span>betadisper)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>red_sand_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq   Mean Sq F value  Pr(&gt;F)  
Groups     1 0.026931 0.0269306  3.5106 0.06868 .
Residuals 38 0.291506 0.0076712                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Water</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>red_water_tab <span class="ot">=</span> <span class="fu">anova</span>(red_water_test<span class="sc">$</span>betadisper)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>red_water_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Groups     1 0.37663 0.37663  77.716 2.654e-10 ***
Residuals 34 0.16477 0.00485                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sand shiner vs Water</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>sand_water_tab <span class="ot">=</span> <span class="fu">anova</span>(sand_water_test<span class="sc">$</span>betadisper)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>sand_water_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Groups     1 0.17653 0.17653  18.123 0.0003219 ***
Residuals 22 0.21429 0.00974                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">p =</span> <span class="fu">c</span>(red_sand_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                                      red_water_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                                      red_water_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_betadisper1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"red - sand"</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"red - water"</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"sand - water"</span>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_betadisper1<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        p     p.adjust
red - sand   6.868280e-02 6.868280e-02
red - water  2.653556e-10 3.980334e-10
sand - water 2.653556e-10 3.980334e-10</code></pre>
</div>
</div>
</section>
<section id="river-1" class="level3" data-number="10.0.2">
<h3 data-number="10.0.2" class="anchored" data-anchor-id="river-1"><span class="header-section-number">10.0.2</span> River</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for heterogeneity of variance in the commonName groups</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>bd  <span class="ot">=</span> <span class="fu">betadisper</span>(<span class="at">d =</span> distme, <span class="at">group =</span> sampleda<span class="sc">$</span>river)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>bd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Homogeneity of multivariate dispersions

Call: betadisper(d = distme, group = sampleda$river)

No. of Positive Eigenvalues: 48
No. of Negative Eigenvalues: 1

Average distance to median:
elkhorn   mloup   sloup 
 0.4751  0.5048  0.5808 

Eigenvalues for PCoA axes:
(Showing 8 of 49 eigenvalues)
 PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
3.6590 1.6907 1.2405 1.0484 0.8795 0.8095 0.6440 0.5166 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq  Mean Sq F value   Pr(&gt;F)   
Groups     2 0.09213 0.046067  5.7633 0.005774 **
Residuals 47 0.37567 0.007993                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)   
Groups     2 0.09213 0.046067 5.7633    999  0.007 **
Residuals 47 0.37567 0.007993                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="pairwiseriver" class="level4" data-number="10.0.2.1">
<h4 data-number="10.0.2.1" class="anchored" data-anchor-id="pairwiseriver"><span class="header-section-number">10.0.2.1</span> pairwise:river</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mloup vs sloup</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>m_s_tab <span class="ot">=</span> <span class="fu">anova</span>(m_s_test<span class="sc">$</span>betadisper)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>m_s_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq  Mean Sq F value  Pr(&gt;F)  
Groups     1 0.047344 0.047344  7.2455 0.01024 *
Residuals 41 0.267907 0.006534                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mloup vs elkhorn</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>m_elk_tab <span class="ot">=</span> <span class="fu">anova</span>(m_elk_test<span class="sc">$</span>betadisper)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>m_elk_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Groups     1 0.003759 0.0037594  0.2642 0.6143
Residuals 16 0.227668 0.0142292               </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sloup vs elkhorn</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>s_elk_tab <span class="ot">=</span> <span class="fu">anova</span>(s_elk_test<span class="sc">$</span>betadisper)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>s_elk_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq  Mean Sq F value   Pr(&gt;F)   
Groups     1 0.064164 0.064164  9.2849 0.004247 **
Residuals 37 0.255689 0.006911                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">p =</span> <span class="fu">c</span>(m_s_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                                        m_elk_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                                        s_elk_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_betadisper1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mloup - sloup"</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"mloup - elkhorn"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"sloup - elkhorn"</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_betadisper1<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          p   p.adjust
mloup - sloup   0.010242783 0.01536417
mloup - elkhorn 0.614271755 0.61427175
sloup - elkhorn 0.004246797 0.01274039</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="permanova" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> PERMANOVA</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>adores1 <span class="ot">=</span> <span class="fu">adonis2</span>(distme <span class="sc">~</span> commonName <span class="sc">*</span> station, <span class="at">data=</span>sampleda, <span class="at">permutation=</span><span class="dv">9999</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>adores1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = distme ~ commonName * station, data = sampleda, permutations = 9999)
                   Df SumOfSqs      R2      F Pr(&gt;F)    
commonName          2   4.1432 0.24434 9.1738 0.0001 ***
station             6   3.3250 0.19609 2.4541 0.0001 ***
commonName:station 10   2.4880 0.14673 1.1018 0.1913    
Residual           31   7.0003 0.41284                  
Total              49  16.9565 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>adores2 <span class="ot">=</span> <span class="fu">adonis2</span>(distme <span class="sc">~</span> station <span class="sc">*</span> commonName, <span class="at">data=</span>sampleda, <span class="at">permutation=</span><span class="dv">9999</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>adores2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = distme ~ station * commonName, data = sampleda, permutations = 9999)
                   Df SumOfSqs      R2      F Pr(&gt;F)    
station             6   3.6002 0.21232 2.6572 0.0001 ***
commonName          2   3.8680 0.22811 8.5645 0.0001 ***
station:commonName 10   2.4880 0.14673 1.1018 0.1781    
Residual           31   7.0003 0.41284                  
Total              49  16.9565 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Function to do Pairwise tests</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: for some reason ths function is only working if I pre-define the variables in my environment before passing them to the function. I have no Idea why it needs that, but it seems to be working.  </span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>pairwise_adonis_commonName <span class="ot">=</span> <span class="cf">function</span>(ps, vari, g1, g2){</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set seed</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create subset phyloseq</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  subset <span class="ot">=</span> <span class="fu">subset_samples</span>(ps, (ps<span class="sc">@</span>sam_data[[vari]] <span class="sc">==</span> g1 <span class="sc">|</span> ps<span class="sc">@</span>sam_data[[vari]] <span class="sc">==</span> g2))</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  subset <span class="ot">=</span> <span class="fu">prune_species</span>(<span class="fu">speciesSums</span>(subset) <span class="sc">&gt;</span> <span class="dv">0</span>, subset)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get distance matrix</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  dist <span class="ot">=</span> <span class="fu">get_dist</span>(subset, <span class="at">distmethod =</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make sample data frame</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  sampledat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(subset), <span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  sampledat <span class="ot">=</span> sampledat[<span class="fu">match</span>(<span class="fu">colnames</span>(<span class="fu">as.matrix</span>(dist)),<span class="fu">rownames</span>(sampledat)),,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do PERMANOVA</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  permanova <span class="ot">=</span> <span class="fu">adonis2</span>(dist <span class="sc">~</span> commonName, <span class="at">data =</span> sampledat, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do BETADISPER</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>  dispersion_test <span class="ot">=</span> <span class="fu">betadisper</span>(<span class="at">d =</span> dist, <span class="at">group =</span> sampledat[[vari]])</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">permanova =</span> permanova,</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">betadisper =</span> dispersion_test)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>pairwise_adonis_station <span class="ot">=</span> <span class="cf">function</span>(ps, vari, g1, g2){</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set seed</span></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create subset phyloseq</span></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  subset <span class="ot">=</span> <span class="fu">subset_samples</span>(ps, (ps<span class="sc">@</span>sam_data[[vari]] <span class="sc">==</span> g1 <span class="sc">|</span> ps<span class="sc">@</span>sam_data[[vari]] <span class="sc">==</span> g2))</span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>  subset <span class="ot">=</span> <span class="fu">prune_species</span>(<span class="fu">speciesSums</span>(subset) <span class="sc">&gt;</span> <span class="dv">0</span>, subset)</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get distance matrix</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>  dist <span class="ot">=</span> <span class="fu">get_dist</span>(subset, <span class="at">distmethod =</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make sample data frame</span></span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>  sampledat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(subset), <span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>  sampledat <span class="ot">=</span> sampledat[<span class="fu">match</span>(<span class="fu">colnames</span>(<span class="fu">as.matrix</span>(dist)),<span class="fu">rownames</span>(sampledat)),,drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do PERMANOVA</span></span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>  permanova <span class="ot">=</span> <span class="fu">adonis2</span>(dist <span class="sc">~</span> station, <span class="at">data =</span> sampledat, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do BETADISPER</span></span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>  dispersion_test <span class="ot">=</span> <span class="fu">betadisper</span>(<span class="at">d =</span> dist, <span class="at">group =</span> sampledat[[vari]])</span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">permanova =</span> permanova,</span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">betadisper =</span> dispersion_test)</span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pairwisepermanova" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="pairwisepermanova"><span class="header-section-number">11.1</span> PairwisePermanova</h2>
<section id="commonname" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="commonname"><span class="header-section-number">11.1.1</span> commonName</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Sand shiner</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"commonName"</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"Red shiner"</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"Sand shiner"</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>red_sand_test <span class="ot">=</span> <span class="fu">pairwise_adonis_commonName</span>(ps_norm, <span class="st">"commonName"</span>,<span class="st">"Red shiner"</span>,<span class="st">"Sand shiner"</span>)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>red_sand_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ commonName, data = sampledat, permutations = 9999)
           Df SumOfSqs      R2      F Pr(&gt;F)   
commonName  1   0.5618 0.04576 1.8223 0.0082 **
Residual   38  11.7143 0.95424                 
Total      39  12.2761 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Water</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"commonName"</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"Red shiner"</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"Water"</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>red_water_test <span class="ot">=</span> <span class="fu">pairwise_adonis_commonName</span>(ps_norm, <span class="st">"commonName"</span>,<span class="st">"Red shiner"</span>,<span class="st">"Water"</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>red_water_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ commonName, data = sampledat, permutations = 9999)
           Df SumOfSqs      R2      F Pr(&gt;F)    
commonName  1   3.3162 0.26522 12.273  1e-04 ***
Residual   34   9.1872 0.73478                  
Total      35  12.5034 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sand shiner vs Water</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"commonName"</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"Sand shiner"</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"Water"</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>sand_water_test <span class="ot">=</span> <span class="fu">pairwise_adonis_commonName</span>(ps_norm, <span class="st">"commonName"</span>,<span class="st">"Sand shiner"</span>,<span class="st">"Water"</span>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>sand_water_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ commonName, data = sampledat, permutations = 9999)
           Df SumOfSqs      R2      F Pr(&gt;F)    
commonName  1   2.7210 0.36543 12.669  1e-04 ***
Residual   22   4.7251 0.63457                  
Total      23   7.4461 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust P-values to account for multiple testing using the Benjamani-Hochberg method</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull R2 values for data frame</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">R2 =</span> <span class="fu">c</span>(red_sand_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>], red_water_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>], sand_water_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>]))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_p_permanova) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Red - Sand"</span>, <span class="st">"Red - Water"</span>, <span class="st">"Sand - Water"</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova<span class="sc">$</span>p <span class="ot">=</span> <span class="fu">c</span>(red_sand_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], red_water_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], sand_water_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>])</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_p_permanova<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     R2      p p.adjust
Red - Sand   0.04576087 0.0082  0.00820
Red - Water  0.26522456 0.0001  0.00015
Sand - Water 0.36542570 0.0001  0.00015</code></pre>
</div>
</div>
</section>
<section id="stations" class="level3" data-number="11.1.2">
<h3 data-number="11.1.2" class="anchored" data-anchor-id="stations"><span class="header-section-number">11.1.2</span> Stations</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># boelus vs hwy183</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"boelus"</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>boelus_hwy183_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"boelus"</span>,<span class="st">"hwy183"</span>)</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>boelus_hwy183_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2     F Pr(&gt;F)  
station   1   0.7381 0.22051 2.546  0.038 *
Residual  9   2.6091 0.77949               
Total    10   3.3472 1.00000               
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boelus vs oneil</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"boelus"</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"oneil"</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>boelus_oneil_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"boelus"</span>,<span class="st">"oneil"</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>boelus_oneil_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)   
station   1   0.8936 0.28039 3.5068 0.0037 **
Residual  9   2.2935 0.71961                 
Total    10   3.1871 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boelus vs presseywma</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"boelus"</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"presseywma"</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>boelus_presseywma_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"boelus"</span>,<span class="st">"presseywma"</span>)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>boelus_presseywma_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)   
station   1   0.8994 0.18504 3.1788 0.0025 **
Residual 14   3.9612 0.81496                 
Total    15   4.8607 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boelus vs ravenna</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"boelus"</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"ravenna"</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>boelus_ravenna_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"boelus"</span>,<span class="st">"ravenna"</span>)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>boelus_ravenna_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.6427 0.15284 1.9846 0.0289 *
Residual 11   3.5623 0.84716                
Total    12   4.2050 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boelus vs sartoria</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"boelus"</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"sartoria"</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>boelus_sartoria_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"boelus"</span>,<span class="st">"sartoria"</span>)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>boelus_sartoria_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1  0.67842 0.26824 2.1995 0.0583 .
Residual  6  1.85070 0.73176                
Total     7  2.52913 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boelus vs southstpaul</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"boelus"</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"southstpaul"</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>boelus_southstpaul_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"boelus"</span>,<span class="st">"southstpaul"</span>)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>boelus_southstpaul_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)   
station   1  0.67402 0.23234 2.7239 0.0037 **
Residual  9  2.22701 0.76766                 
Total    10  2.90103 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hwy183 vs oneil</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"oneil"</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>hwy183_oneil_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"hwy183"</span>,<span class="st">"oneil"</span>)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>hwy183_oneil_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.6002 0.14143 1.9767 0.0391 *
Residual 12   3.6436 0.85857                
Total    13   4.2438 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hwy183 vs presseywma</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"presseywma"</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>hwy183_presseywma_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"hwy183"</span>,<span class="st">"presseywma"</span>)</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>hwy183_presseywma_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)
station   1   0.4410 0.07667 1.4116 0.1888
Residual 17   5.3114 0.92333              
Total    18   5.7524 1.00000              </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hwy183 vs ravenna</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"ravenna"</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>hwy183_ravenna_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"hwy183"</span>,<span class="st">"ravenna"</span>)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>hwy183_ravenna_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2     F Pr(&gt;F)
station   1   0.3628 0.06878 1.034 0.3403
Residual 14   4.9124 0.93122             
Total    15   5.2752 1.00000             </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hwy183 vs sartoria</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"sartoria"</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>hwy183_sartoria_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"hwy183"</span>,<span class="st">"sartoria"</span>)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>hwy183_sartoria_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs    R2      F Pr(&gt;F)
station   1   0.4868 0.132 1.3687 0.1794
Residual  9   3.2008 0.868              
Total    10   3.6876 1.000              </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hwy183 vs southstpaul</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"hwy183"</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"southstpaul"</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>hwy183_southstpaul_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"hwy183"</span>,<span class="st">"southstpaul"</span>)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>hwy183_southstpaul_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.5336 0.12981 1.7901 0.0968 .
Residual 12   3.5771 0.87019                
Total    13   4.1108 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># oneil vs presseywma</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"oneil"</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"presseywma"</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>oneil_presseywma_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"oneil"</span>,<span class="st">"presseywma"</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>oneil_presseywma_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.5884 0.10537 2.0023 0.0226 *
Residual 17   4.9957 0.89463                
Total    18   5.5841 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># oneil vs ravenna</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"oneil"</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"ravenna"</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>oneil_ravenna_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"oneil"</span>,<span class="st">"ravenna"</span>)</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>oneil_ravenna_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)   
station   1   0.6658 0.12651 2.0277 0.0088 **
Residual 14   4.5967 0.87349                 
Total    15   5.2625 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># oneil vs sartoria</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"oneil"</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"sartoria"</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>oneil_sartoria_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"oneil"</span>,<span class="st">"sartoria"</span>)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>oneil_sartoria_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.6748 0.18955 2.1049 0.0121 *
Residual  9   2.8852 0.81045                
Total    10   3.5600 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># oneil vs southstpaul</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"oneil"</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"southstpaul"</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>oneil_southstpaul_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"oneil"</span>,<span class="st">"southstpaul"</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>oneil_southstpaul_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)   
station   1   0.6502 0.16622 2.3922  0.002 **
Residual 12   3.2615 0.83378                 
Total    13   3.9117 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># presseywma vs ravenna</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"presseywma"</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"ravenna"</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>presseywma_ravenna_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"presseywma"</span>,<span class="st">"ravenna"</span>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>presseywma_ravenna_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.5968 0.08697 1.8099 0.0393 *
Residual 19   6.2645 0.91303                
Total    20   6.8613 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># presseywma vs sartoria</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"presseywma"</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"sartoria"</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>presseywma_sartoria_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"presseywma"</span>,<span class="st">"sartoria"</span>)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>presseywma_sartoria_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs     R2      F Pr(&gt;F)  
station   1   0.5887 0.1145 1.8102  0.032 *
Residual 14   4.5529 0.8855                
Total    15   5.1416 1.0000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># presseywma vs southstpaul</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"presseywma"</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"southstpaul"</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>presseywma_southstpaul_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"presseywma"</span>,<span class="st">"southstpaul"</span>)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>presseywma_southstpaul_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.5208 0.09556 1.7962 0.0423 *
Residual 17   4.9292 0.90444                
Total    18   5.4500 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ravenna vs sartoria</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"ravenna"</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"sartoria"</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>ravenna_sartoria_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"ravenna"</span>,<span class="st">"sartoria"</span>)</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>ravenna_sartoria_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)
station   1   0.3934 0.08651 1.0418 0.4432
Residual 11   4.1540 0.91349              
Total    12   4.5474 1.00000              </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ravenna vs southstpaul</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"ravenna"</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"southstpaul"</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>ravenna_southstpaul_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"ravenna"</span>,<span class="st">"southstpaul"</span>)</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>ravenna_southstpaul_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.5203 0.10302 1.6079 0.0849 .
Residual 14   4.5303 0.89698                
Total    15   5.0506 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sartoria vs southstpaul</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> ps_norm</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>vari <span class="ot">=</span> <span class="st">"station"</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="st">"sartoria"</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="st">"southstpaul"</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>sartoria_southstpaul_test <span class="ot">=</span> <span class="fu">pairwise_adonis_station</span>(ps_norm, <span class="st">"station"</span>,<span class="st">"sartoria"</span>,<span class="st">"southstpaul"</span>)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>sartoria_southstpaul_test<span class="sc">$</span>permanova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 9999

adonis2(formula = dist ~ station, data = sampledat, permutations = 9999)
         Df SumOfSqs      R2      F Pr(&gt;F)  
station   1   0.6742 0.19302 2.1527 0.0116 *
Residual  9   2.8187 0.80698                
Total    10   3.4929 1.00000                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust P-values to account for multiple testing using the Benjamani-Hochberg method</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull R2 values for data frame</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">R2 =</span> <span class="fu">c</span>(boelus_hwy183_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>                                         boelus_oneil_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>                                         boelus_presseywma_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>                                         boelus_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>                                         boelus_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>                                         boelus_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>                                         hwy183_oneil_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>                                         hwy183_presseywma_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>                                         hwy183_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>                                         hwy183_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>                                         hwy183_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>                                         oneil_presseywma_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>                                         oneil_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>                                         oneil_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>                                         oneil_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>                                         presseywma_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>                                         presseywma_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>                                         presseywma_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>                                         ravenna_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>                                         ravenna_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>],</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>                                         sartoria_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span>R2[<span class="dv">1</span>]))</span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_p_permanova2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"boelus - hwy183"</span>,</span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"boelus - oneil"</span>,</span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"boelus - presseywma"</span>,</span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"boelus - ravenna"</span>,</span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"boelus - sartoria"</span>,</span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"boelus - southstpaul"</span>,</span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"hwy183 - oneil"</span>,</span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"hwy183 - presseywma"</span>,</span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"hwy183 - ravenna"</span>,</span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"hwy183 - sartoria"</span>,</span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"hwy183 - southstpaul"</span>,</span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"oneil - presseywma"</span>,</span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"oneil - ravenna"</span>,</span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"oneil - sartoria"</span>,</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"oneil - souhstpaul"</span>,</span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"presseywma - ravenna"</span>,</span>
<span id="cb157-41"><a href="#cb157-41" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"presseywma - sartoria"</span>,</span>
<span id="cb157-42"><a href="#cb157-42" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"presseywma - southstpaul"</span>,</span>
<span id="cb157-43"><a href="#cb157-43" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"ravenna - sartoria"</span>,</span>
<span id="cb157-44"><a href="#cb157-44" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"ravenna - southstpaul"</span>,</span>
<span id="cb157-45"><a href="#cb157-45" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"sartoria - southstpaul"</span>)</span>
<span id="cb157-46"><a href="#cb157-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-47"><a href="#cb157-47" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova2<span class="sc">$</span>p <span class="ot">=</span> <span class="fu">c</span>(boelus_hwy183_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-48"><a href="#cb157-48" aria-hidden="true" tabindex="-1"></a>                            boelus_oneil_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-49"><a href="#cb157-49" aria-hidden="true" tabindex="-1"></a>                            boelus_presseywma_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-50"><a href="#cb157-50" aria-hidden="true" tabindex="-1"></a>                            boelus_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-51"><a href="#cb157-51" aria-hidden="true" tabindex="-1"></a>                            boelus_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-52"><a href="#cb157-52" aria-hidden="true" tabindex="-1"></a>                            boelus_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-53"><a href="#cb157-53" aria-hidden="true" tabindex="-1"></a>                            hwy183_oneil_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-54"><a href="#cb157-54" aria-hidden="true" tabindex="-1"></a>                            hwy183_presseywma_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-55"><a href="#cb157-55" aria-hidden="true" tabindex="-1"></a>                            hwy183_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-56"><a href="#cb157-56" aria-hidden="true" tabindex="-1"></a>                            hwy183_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-57"><a href="#cb157-57" aria-hidden="true" tabindex="-1"></a>                            hwy183_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-58"><a href="#cb157-58" aria-hidden="true" tabindex="-1"></a>                            oneil_presseywma_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-59"><a href="#cb157-59" aria-hidden="true" tabindex="-1"></a>                            oneil_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-60"><a href="#cb157-60" aria-hidden="true" tabindex="-1"></a>                            oneil_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-61"><a href="#cb157-61" aria-hidden="true" tabindex="-1"></a>                            oneil_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-62"><a href="#cb157-62" aria-hidden="true" tabindex="-1"></a>                            presseywma_ravenna_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-63"><a href="#cb157-63" aria-hidden="true" tabindex="-1"></a>                            presseywma_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-64"><a href="#cb157-64" aria-hidden="true" tabindex="-1"></a>                            presseywma_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-65"><a href="#cb157-65" aria-hidden="true" tabindex="-1"></a>                            ravenna_sartoria_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-66"><a href="#cb157-66" aria-hidden="true" tabindex="-1"></a>                            ravenna_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb157-67"><a href="#cb157-67" aria-hidden="true" tabindex="-1"></a>                            sartoria_southstpaul_test<span class="sc">$</span>permanova<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>])</span>
<span id="cb157-68"><a href="#cb157-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-69"><a href="#cb157-69" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova2<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_p_permanova2<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb157-70"><a href="#cb157-70" aria-hidden="true" tabindex="-1"></a>pairwise_p_permanova2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 R2      p  p.adjust
boelus - hwy183          0.22051133 0.0380 0.0634500
boelus - oneil           0.28039084 0.0037 0.0194250
boelus - presseywma      0.18504356 0.0025 0.0194250
boelus - ravenna         0.15284077 0.0289 0.0634500
boelus - sartoria        0.26824432 0.0583 0.0816200
boelus - southstpaul     0.23233857 0.0037 0.0194250
hwy183 - oneil           0.14142951 0.0391 0.0634500
hwy183 - presseywma      0.07667030 0.1888 0.2086737
hwy183 - ravenna         0.06878025 0.3403 0.3573150
hwy183 - sartoria        0.13200045 0.1794 0.2086737
hwy183 - southstpaul     0.12981145 0.0968 0.1195765
oneil - presseywma       0.10537169 0.0226 0.0593250
oneil - ravenna          0.12651229 0.0088 0.0363000
oneil - sartoria         0.18954635 0.0121 0.0363000
oneil - souhstpaul       0.16621765 0.0020 0.0194250
presseywma - ravenna     0.08697461 0.0393 0.0634500
presseywma - sartoria    0.11449614 0.0320 0.0634500
presseywma - southstpaul 0.09555998 0.0423 0.0634500
ravenna - sartoria       0.08651206 0.4432 0.4432000
ravenna - southstpaul    0.10301854 0.0849 0.1114313
sartoria - southstpaul   0.19301852 0.0116 0.0363000</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="betadisper" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> BETADISPER</h1>
<section id="commonname-1" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="commonname-1"><span class="header-section-number">12.1</span> commonName</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for heterogeneity of variance in the commonName groups</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>bd  <span class="ot">=</span> <span class="fu">betadisper</span>(<span class="at">d =</span> distme, <span class="at">group =</span> sampleda<span class="sc">$</span>commonName)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>bd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Homogeneity of multivariate dispersions

Call: betadisper(d = distme, group = sampleda$commonName)

No. of Positive Eigenvalues: 48
No. of Negative Eigenvalues: 1

Average distance to median:
 Red shiner Sand shiner       Water 
     0.5539      0.4995      0.3256 

Eigenvalues for PCoA axes:
(Showing 8 of 49 eigenvalues)
 PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
3.6590 1.6907 1.2405 1.0484 0.8795 0.8095 0.6440 0.5166 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
Groups     2 0.37751 0.188753  26.463 2.003e-08 ***
Residuals 47 0.33523 0.007133                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)    
Groups     2 0.37751 0.188753 26.463    999  0.001 ***
Residuals 47 0.33523 0.007133                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>vectorsA <span class="ot">=</span> bd<span class="sc">$</span>vectors</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>centrioids <span class="ot">=</span> bd<span class="sc">$</span>centroids</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">=</span> <span class="fu">as.data.frame</span>(bd<span class="sc">$</span>distances)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>distance <span class="sc">|&gt;</span> </span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"sample"</span>) <span class="ot">-&gt;</span> distance</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>vectorsA <span class="sc">|&gt;</span> </span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"sample"</span>) <span class="ot">-&gt;</span> vectorsA</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>disperion_data <span class="ot">=</span> <span class="fu">left_join</span>(<span class="at">x =</span> vectorsA,</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> distance,</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by =</span> <span class="st">"sample"</span>)</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>disperion_data<span class="sc">$</span>group <span class="ot">=</span> bd<span class="sc">$</span>group</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(disperion_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "sample"       "PCoA1"        "PCoA2"        "PCoA3"        "PCoA4"       
 [6] "PCoA5"        "PCoA6"        "PCoA7"        "PCoA8"        "PCoA9"       
[11] "PCoA10"       "PCoA11"       "PCoA12"       "PCoA13"       "PCoA14"      
[16] "PCoA15"       "PCoA16"       "PCoA17"       "PCoA18"       "PCoA19"      
[21] "PCoA20"       "PCoA21"       "PCoA22"       "PCoA23"       "PCoA24"      
[26] "PCoA25"       "PCoA26"       "PCoA27"       "PCoA28"       "PCoA29"      
[31] "PCoA30"       "PCoA31"       "PCoA32"       "PCoA33"       "PCoA34"      
[36] "PCoA35"       "PCoA36"       "PCoA37"       "PCoA38"       "PCoA39"      
[41] "PCoA40"       "PCoA41"       "PCoA42"       "PCoA43"       "PCoA44"      
[46] "PCoA45"       "PCoA46"       "PCoA47"       "PCoA48"       "PCoA49"      
[51] "bd$distances" "group"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> disperion_data) <span class="sc">+</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> bd<span class="sc">$</span>distances)) <span class="sc">+</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Distance to Centroid"</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="ot">-&gt;</span> sampleType_distance_to_centroid</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>sampleType_distance_to_centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/betadisper_commonName-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sampleType_distance_to_centroid.png", sampleType_distance_to_centroid, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pairwise-commonname" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="pairwise-commonname"><span class="header-section-number">12.1.1</span> Pairwise: commonName</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Sand shiner</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>red_sand_tab <span class="ot">=</span> <span class="fu">anova</span>(red_sand_test<span class="sc">$</span>betadisper)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>red_sand_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq   Mean Sq F value  Pr(&gt;F)  
Groups     1 0.026931 0.0269306  3.5106 0.06868 .
Residuals 38 0.291506 0.0076712                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Red shiner vs Water</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>red_water_tab <span class="ot">=</span> <span class="fu">anova</span>(red_water_test<span class="sc">$</span>betadisper)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>red_water_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Groups     1 0.37663 0.37663  77.716 2.654e-10 ***
Residuals 34 0.16477 0.00485                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sand shiner vs Water</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>sand_water_tab <span class="ot">=</span> <span class="fu">anova</span>(sand_water_test<span class="sc">$</span>betadisper)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>sand_water_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Groups     1 0.17653 0.17653  18.123 0.0003219 ***
Residuals 22 0.21429 0.00974                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">p =</span> <span class="fu">c</span>(red_sand_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>                                      red_water_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>                                      red_water_tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pairwise_betadisper1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"red - sand"</span>,</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"red - water"</span>,</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"sand - water"</span>)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1<span class="sc">$</span>p.adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(pairwise_betadisper1<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">"BH"</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>pairwise_betadisper1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                        p     p.adjust
red - sand   6.868280e-02 6.868280e-02
red - water  2.653556e-10 3.980334e-10
sand - water 2.653556e-10 3.980334e-10</code></pre>
</div>
</div>
</section>
</section>
<section id="station" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="station"><span class="header-section-number">12.2</span> Station</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for heterogeneity of variance in the commonName groups</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>bd  <span class="ot">=</span> <span class="fu">betadisper</span>(<span class="at">d =</span> distme, <span class="at">group =</span> sampleda<span class="sc">$</span>station)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>bd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Homogeneity of multivariate dispersions

Call: betadisper(d = distme, group = sampleda$station)

No. of Positive Eigenvalues: 48
No. of Negative Eigenvalues: 1

Average distance to median:
     boelus      hwy183       oneil  presseywma     ravenna    sartoria 
     0.3632      0.5263      0.4751      0.5135      0.5682      0.5479 
southstpaul 
     0.4614 

Eigenvalues for PCoA axes:
(Showing 8 of 49 eigenvalues)
 PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
3.6590 1.6907 1.2405 1.0484 0.8795 0.8095 0.6440 0.5166 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq  Mean Sq F value Pr(&gt;F)
Groups     6 0.14722 0.024536  1.4145 0.2312
Residuals 43 0.74592 0.017347               </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     6 0.14722 0.024536 1.4145    999  0.235
Residuals 43 0.74592 0.017347                     </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>vectorsA <span class="ot">=</span> bd<span class="sc">$</span>vectors</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>centrioids <span class="ot">=</span> bd<span class="sc">$</span>centroids</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">=</span> <span class="fu">as.data.frame</span>(bd<span class="sc">$</span>distances)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>distance <span class="sc">|&gt;</span> </span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"sample"</span>) <span class="ot">-&gt;</span> distance</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>vectorsA <span class="sc">|&gt;</span> </span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"sample"</span>) <span class="ot">-&gt;</span> vectorsA</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>disperion_data <span class="ot">=</span> <span class="fu">left_join</span>(<span class="at">x =</span> vectorsA,</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> distance,</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by =</span> <span class="st">"sample"</span>)</span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>disperion_data<span class="sc">$</span>group <span class="ot">=</span> bd<span class="sc">$</span>group</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(disperion_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "sample"       "PCoA1"        "PCoA2"        "PCoA3"        "PCoA4"       
 [6] "PCoA5"        "PCoA6"        "PCoA7"        "PCoA8"        "PCoA9"       
[11] "PCoA10"       "PCoA11"       "PCoA12"       "PCoA13"       "PCoA14"      
[16] "PCoA15"       "PCoA16"       "PCoA17"       "PCoA18"       "PCoA19"      
[21] "PCoA20"       "PCoA21"       "PCoA22"       "PCoA23"       "PCoA24"      
[26] "PCoA25"       "PCoA26"       "PCoA27"       "PCoA28"       "PCoA29"      
[31] "PCoA30"       "PCoA31"       "PCoA32"       "PCoA33"       "PCoA34"      
[36] "PCoA35"       "PCoA36"       "PCoA37"       "PCoA38"       "PCoA39"      
[41] "PCoA40"       "PCoA41"       "PCoA42"       "PCoA43"       "PCoA44"      
[46] "PCoA45"       "PCoA46"       "PCoA47"       "PCoA48"       "PCoA49"      
[51] "bd$distances" "group"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> disperion_data) <span class="sc">+</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> bd<span class="sc">$</span>distances)) <span class="sc">+</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Distance to Centroid"</span>,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="ot">-&gt;</span> station_distance_to_centroid</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>station_distance_to_centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/betadisper_station-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/station_distance_to_centroid.png", station_distance_to_centroid, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="envifit" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Envifit</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm<span class="sc">@</span>sam_data)</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">|&gt;</span> </span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fieldDate =</span> <span class="fu">mdy</span>(meta<span class="sc">$</span>fieldDate),</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">day_of_yr =</span> <span class="fu">yday</span>(fieldDate)) <span class="sc">|&gt;</span> </span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ammonia,</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>         turbidity,</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>         do,</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>         temperature,</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>         no3,</span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>         totalNitrogen,</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>         totalPhosphorus,</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>         day_of_yr)  <span class="ot">-&gt;</span> meta_env</span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>vectors <span class="ot">=</span> pcoares<span class="sc">@</span>pca<span class="sc">$</span>vectors</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>ef <span class="ot">=</span> <span class="fu">envfit</span>(<span class="at">ord =</span> vectors, <span class="at">env =</span> meta_env, <span class="at">perm =</span> <span class="dv">999</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>ef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
***VECTORS

                  Axis.1   Axis.2     r2 Pr(&gt;r)  
ammonia         -0.93034 -0.36670 0.0028  0.942  
turbidity        0.56838  0.82277 0.0360  0.421  
do              -0.40071 -0.91620 0.0525  0.271  
temperature      0.20721  0.97830 0.1508  0.018 *
no3              0.99573 -0.09231 0.0013  0.969  
totalNitrogen   -0.02926  0.99957 0.0052  0.887  
totalPhosphorus  0.27469  0.96153 0.0406  0.390  
day_of_yr        0.64030  0.76812 0.0771  0.151  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Permutation: free
Number of permutations: 999</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(ef)</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="do">## testing doing Envfit on water and fish seperately</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>ps_norm_water <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_norm, ps_norm<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Water"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>ps_norm_fish <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_norm, ps_norm<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">!=</span> <span class="st">"Water"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'
Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Water</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>pcoares2 <span class="ot">&lt;-</span> <span class="fu">get_pcoa</span>(<span class="at">obj=</span>ps_norm_water, <span class="at">distmethod=</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm_water<span class="sc">@</span>sam_data)</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">|&gt;</span> </span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fieldDate =</span> <span class="fu">mdy</span>(meta<span class="sc">$</span>fieldDate),</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">day_of_yr =</span> <span class="fu">yday</span>(fieldDate)) <span class="sc">|&gt;</span> </span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ammonia,</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>         turbidity,</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>         do,</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>         temperature,</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>         no3,</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>         totalNitrogen,</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>         totalPhosphorus,</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>         day_of_yr)  <span class="ot">-&gt;</span> meta_env</span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>vectors2 <span class="ot">=</span> pcoares2<span class="sc">@</span>pca<span class="sc">$</span>vectors</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>ef2 <span class="ot">=</span> <span class="fu">envfit</span>(<span class="at">ord =</span> vectors2, <span class="at">env =</span> meta_env, <span class="at">perm =</span> <span class="dv">999</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>ef2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
***VECTORS

                  Axis.1   Axis.2     r2 Pr(&gt;r)   
ammonia         -0.56879 -0.82248 0.5329  0.064 . 
turbidity        0.62874 -0.77762 0.0871  0.760   
do              -0.99953  0.03065 0.4790  0.088 . 
temperature      0.87337 -0.48706 0.5083  0.071 . 
no3             -0.23939  0.97092 0.4292  0.139   
totalNitrogen    0.08286  0.99656 0.7777  0.007 **
totalPhosphorus  0.99920 -0.04004 0.0249  0.893   
day_of_yr        0.89289 -0.45027 0.6877  0.021 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Permutation: free
Number of permutations: 999</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fish</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1024</span>)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>pcoares3 <span class="ot">&lt;-</span> <span class="fu">get_pcoa</span>(<span class="at">obj=</span>ps_norm_fish, <span class="at">distmethod=</span><span class="st">"bray"</span>, <span class="at">method=</span><span class="st">"hellinger"</span>)</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm_fish<span class="sc">@</span>sam_data)</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">|&gt;</span> </span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fieldDate =</span> <span class="fu">mdy</span>(meta<span class="sc">$</span>fieldDate),</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">day_of_yr =</span> <span class="fu">yday</span>(fieldDate)) <span class="sc">|&gt;</span> </span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ammonia,</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>         turbidity,</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>         do,</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>         temperature,</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>         no3,</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>         totalNitrogen,</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>         totalPhosphorus,</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>         day_of_yr)  <span class="ot">-&gt;</span> meta_env</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>vectors3 <span class="ot">=</span> pcoares3<span class="sc">@</span>pca<span class="sc">$</span>vectors</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>ef3 <span class="ot">=</span> <span class="fu">envfit</span>(<span class="at">ord =</span> vectors3, <span class="at">env =</span> meta_env, <span class="at">perm =</span> <span class="dv">999</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>ef3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
***VECTORS

                  Axis.1   Axis.2     r2 Pr(&gt;r)   
ammonia          0.10073  0.99491 0.0482  0.392   
turbidity       -0.34617  0.93817 0.1553  0.042 * 
do               0.43798 -0.89899 0.1686  0.034 * 
temperature     -0.88012  0.47475 0.1804  0.026 * 
no3             -0.04456 -0.99901 0.0791  0.217   
totalNitrogen   -0.13582 -0.99073 0.3711  0.002 **
totalPhosphorus -0.75207  0.65908 0.0722  0.254   
day_of_yr       -0.27383  0.96178 0.3244  0.003 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Permutation: free
Number of permutations: 999</code></pre>
</div>
</div>
</section>
<section id="ordisurf" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Ordisurf</h1>
</section>
<section id="ordination" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Ordination</h1>
<section id="pcoa-axis-analysis" class="level3" data-number="15.0.1">
<h3 data-number="15.0.1" class="anchored" data-anchor-id="pcoa-axis-analysis"><span class="header-section-number">15.0.1</span> PCoA axis analysis</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting % explained by each axis (ie the Relative_eig for each vector)</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>values <span class="ot">=</span> pcoares<span class="sc">@</span>pca<span class="sc">$</span>values</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>values <span class="sc">|&gt;</span> </span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vector =</span> <span class="fu">row.names</span>(values),</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">vector =</span> <span class="fu">as.numeric</span>(vector)) <span class="sc">|&gt;</span> </span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vector, Eigenvalues, Relative_eig) <span class="ot">-&gt;</span> values</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> values) <span class="sc">+</span></span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> vector,</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> (Relative_eig <span class="sc">*</span> <span class="dv">100</span>))) <span class="sc">+</span></span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">dim</span>(values)[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vector"</span>,</span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"% Variation Explained"</span>) <span class="sc">+</span></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/PCoA_axis_analysis-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="simple-ordintation" class="level3" data-number="15.0.2">
<h3 data-number="15.0.2" class="anchored" data-anchor-id="simple-ordintation"><span class="header-section-number">15.0.2</span> Simple Ordintation</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual PCoA plotting for more control</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>pcoa1 <span class="ot">=</span> <span class="fu">as.data.frame</span>(pcoares<span class="sc">@</span>pca<span class="sc">$</span>vectors)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>pcoa1 <span class="sc">|&gt;</span> </span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">row.names</span>(pcoa1)) <span class="sc">|&gt;</span> </span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample, Axis<span class="fl">.1</span>, Axis<span class="fl">.2</span>, Axis<span class="fl">.3</span>) <span class="ot">-&gt;</span> pcoa1_clean</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="co"># merge PCoA axis data with sample metadata</span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm<span class="sc">@</span>sam_data)</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>pcoa1_clean <span class="ot">=</span> <span class="fu">full_join</span>(pcoa1_clean, meta, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sample"</span> <span class="ot">=</span> <span class="st">"sampleID"</span>))</span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a><span class="co"># names(pcoa1_clean)</span></span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make PCoA Axis Labels</span></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"PCoA 1 ("</span>, <span class="fu">round</span>((values<span class="sc">$</span>Relative_eig[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>),</span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"PCoA 2 ("</span>, <span class="fu">round</span>((values<span class="sc">$</span>Relative_eig[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>),</span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"PCoA 3 ("</span>, <span class="fu">round</span>((values<span class="sc">$</span>Relative_eig[<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>))</span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples colored by commonName, no ASV vector shown</span></span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa1_clean,</span>
<span id="cb211-23"><a href="#cb211-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb211-24"><a href="#cb211-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb211-25"><a href="#cb211-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName)) <span class="sc">+</span></span>
<span id="cb211-26"><a href="#cb211-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb211-27"><a href="#cb211-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb211-28"><a href="#cb211-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb211-29"><a href="#cb211-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb211-30"><a href="#cb211-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb211-31"><a href="#cb211-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb211-32"><a href="#cb211-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb211-33"><a href="#cb211-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb211-34"><a href="#cb211-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">data =</span> pcoa1_clean,</span>
<span id="cb211-35"><a href="#cb211-35" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb211-36"><a href="#cb211-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb211-37"><a href="#cb211-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName)) <span class="sc">+</span></span>
<span id="cb211-38"><a href="#cb211-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb211-39"><a href="#cb211-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb211-40"><a href="#cb211-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample Type"</span>) <span class="sc">+</span></span>
<span id="cb211-41"><a href="#cb211-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb211-42"><a href="#cb211-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb211-43"><a href="#cb211-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb211-44"><a href="#cb211-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> simple_pcoa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>simple_pcoa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/ordintation_commonName-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/siple_pcoa.png", simple_pcoa, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Samples shape by commonName, color by station, no ASV vector shown</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># manually define shapes bc ggplot can only handle 6 or fewer</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">=</span> <span class="fu">list</span>(<span class="at">boelus =</span> <span class="dv">16</span>,</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">hwy183 =</span> <span class="dv">17</span>,</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">oneil =</span> <span class="dv">15</span>,</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">presseywma =</span> <span class="dv">3</span>,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">ravenna =</span> <span class="dv">12</span>,</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">sartoria =</span> <span class="dv">8</span>,</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">southstpaul =</span> <span class="dv">9</span>)</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa1_clean,</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName,</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> station)) <span class="sc">+</span></span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> shapes) <span class="sc">+</span></span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">data =</span> pcoa1_clean,</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName)) <span class="sc">+</span></span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample Type"</span>) <span class="sc">+</span></span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> pcoa_with_station</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a>pcoa_with_station</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/ordination_commonName_station-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/pcoa_with_station.png", pcoa_with_station, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="envfit-significant-variables-plotted" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="envfit-significant-variables-plotted"><span class="header-section-number">15.1</span> envfit significant variables plotted</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="ot">=</span> ef<span class="sc">$</span>vectors<span class="sc">$</span>arrows</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"variable"</span>) <span class="ot">-&gt;</span> ef_vectors</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"temperature"</span>) <span class="ot">-&gt;</span> ef_vectors_sig</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"temperature"</span>) <span class="ot">-&gt;</span> ef_vectors_nonsig</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot these environmental vectors even though they are not significant</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa1_clean,</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName,</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> station)) <span class="sc">+</span></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> shapes)<span class="sc">+</span></span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span>),</span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey58"</span>,</span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb217-28"><a href="#cb217-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb217-29"><a href="#cb217-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb217-30"><a href="#cb217-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb217-31"><a href="#cb217-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb217-32"><a href="#cb217-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.9</span>),</span>
<span id="cb217-33"><a href="#cb217-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb217-34"><a href="#cb217-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray48"</span>)<span class="sc">+</span> </span>
<span id="cb217-35"><a href="#cb217-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb217-36"><a href="#cb217-36" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb217-37"><a href="#cb217-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb217-38"><a href="#cb217-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb217-39"><a href="#cb217-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span>),</span>
<span id="cb217-40"><a href="#cb217-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb217-41"><a href="#cb217-41" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb217-42"><a href="#cb217-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray17"</span>,</span>
<span id="cb217-43"><a href="#cb217-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb217-44"><a href="#cb217-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb217-45"><a href="#cb217-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb217-46"><a href="#cb217-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb217-47"><a href="#cb217-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">1.1</span>,</span>
<span id="cb217-48"><a href="#cb217-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">1.1</span>),</span>
<span id="cb217-49"><a href="#cb217-49" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb217-50"><a href="#cb217-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb217-51"><a href="#cb217-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb217-52"><a href="#cb217-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb217-53"><a href="#cb217-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb217-54"><a href="#cb217-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb217-55"><a href="#cb217-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb217-56"><a href="#cb217-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb217-57"><a href="#cb217-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb217-58"><a href="#cb217-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb217-59"><a href="#cb217-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb217-60"><a href="#cb217-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Station"</span>,</span>
<span id="cb217-61"><a href="#cb217-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample Type"</span>) <span class="sc">+</span></span>
<span id="cb217-62"><a href="#cb217-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb217-63"><a href="#cb217-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb217-64"><a href="#cb217-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb217-65"><a href="#cb217-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> envfit_pcoa</span>
<span id="cb217-66"><a href="#cb217-66" aria-hidden="true" tabindex="-1"></a>envfit_pcoa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/ordination_envfit_lines-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/envfit_pcoa.png", envfit_pcoa, width = 7, height = 5, units = "in", dpi = 300)</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the same figure but change from STATION to RIVER</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa1_clean,</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName,</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> river)) <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span>),</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey58"</span>,</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.9</span>),</span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray48"</span>)<span class="sc">+</span> </span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span>),</span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray17"</span>,</span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">1.1</span>,</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">1.1</span>),</span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"River"</span>,</span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample Type"</span>) <span class="sc">+</span></span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> envfit_pcoa_river</span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a>envfit_pcoa_river</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/ordination_envfit_lines-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/envfit_pcoa_river.png", envfit_pcoa_river, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="water-samples-envfit" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="water-samples-envfit"><span class="header-section-number">15.2</span> Water samples envfit</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>pcoa2 <span class="ot">=</span> <span class="fu">as.data.frame</span>(pcoares2<span class="sc">@</span>pca<span class="sc">$</span>vectors)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>pcoa2 <span class="sc">|&gt;</span> </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">row.names</span>(pcoa2)) <span class="sc">|&gt;</span> </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample, Axis<span class="fl">.1</span>, Axis<span class="fl">.2</span>, Axis<span class="fl">.3</span>) <span class="ot">-&gt;</span> pcoa2_clean</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge PCoA axis data with sample metadata</span></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm_water<span class="sc">@</span>sam_data)</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>pcoa2_clean <span class="ot">=</span> <span class="fu">full_join</span>(pcoa2_clean, meta, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sample"</span> <span class="ot">=</span> <span class="st">"sampleID"</span>))</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>values2 <span class="ot">=</span> pcoares2<span class="sc">@</span>pca<span class="sc">$</span>values</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>values2 <span class="sc">|&gt;</span> </span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vector =</span> <span class="fu">row.names</span>(values2),</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">vector =</span> <span class="fu">as.numeric</span>(vector)) <span class="sc">|&gt;</span> </span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vector, Eigenvalues, Relative_eig) <span class="ot">-&gt;</span> values2</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Envfit vectors</span></span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="ot">=</span> ef2<span class="sc">$</span>vectors<span class="sc">$</span>arrows</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"variable"</span>) <span class="ot">-&gt;</span> ef_vectors</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"totalNitrogen"</span> <span class="sc">|</span> variable <span class="sc">==</span> <span class="st">"day_of_yr"</span>) <span class="ot">-&gt;</span> ef_vectors_sig</span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"totalNitrogen"</span> <span class="sc">&amp;</span> variable <span class="sc">!=</span> <span class="st">"day_of_yr"</span>) <span class="ot">-&gt;</span> ef_vectors_nonsig</span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Make PCoA Axis Labels</span></span>
<span id="cb220-32"><a href="#cb220-32" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"PCoA 1 ("</span>, <span class="fu">round</span>((values2<span class="sc">$</span>Relative_eig[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>),</span>
<span id="cb220-33"><a href="#cb220-33" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"PCoA 2 ("</span>, <span class="fu">round</span>((values2<span class="sc">$</span>Relative_eig[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>),</span>
<span id="cb220-34"><a href="#cb220-34" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"PCoA 3 ("</span>, <span class="fu">round</span>((values2<span class="sc">$</span>Relative_eig[<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>))</span>
<span id="cb220-35"><a href="#cb220-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-36"><a href="#cb220-36" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">=</span> <span class="fu">list</span>(<span class="at">boelus =</span> <span class="dv">16</span>,</span>
<span id="cb220-37"><a href="#cb220-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">hwy183 =</span> <span class="dv">17</span>,</span>
<span id="cb220-38"><a href="#cb220-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">oneil =</span> <span class="dv">15</span>,</span>
<span id="cb220-39"><a href="#cb220-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">presseywma =</span> <span class="dv">3</span>,</span>
<span id="cb220-40"><a href="#cb220-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">ravenna =</span> <span class="dv">12</span>,</span>
<span id="cb220-41"><a href="#cb220-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">sartoria =</span> <span class="dv">8</span>,</span>
<span id="cb220-42"><a href="#cb220-42" aria-hidden="true" tabindex="-1"></a>              <span class="at">southstpaul =</span> <span class="dv">9</span>)</span>
<span id="cb220-43"><a href="#cb220-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-44"><a href="#cb220-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-45"><a href="#cb220-45" aria-hidden="true" tabindex="-1"></a><span class="do">### PLOT </span><span class="al">###</span></span>
<span id="cb220-46"><a href="#cb220-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb220-47"><a href="#cb220-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb220-48"><a href="#cb220-48" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb220-49"><a href="#cb220-49" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb220-50"><a href="#cb220-50" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb220-51"><a href="#cb220-51" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb220-52"><a href="#cb220-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb220-53"><a href="#cb220-53" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb220-54"><a href="#cb220-54" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey58"</span>,</span>
<span id="cb220-55"><a href="#cb220-55" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb220-56"><a href="#cb220-56" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb220-57"><a href="#cb220-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb220-58"><a href="#cb220-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb220-59"><a href="#cb220-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb220-60"><a href="#cb220-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.9</span>),</span>
<span id="cb220-61"><a href="#cb220-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb220-62"><a href="#cb220-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray48"</span>,</span>
<span id="cb220-63"><a href="#cb220-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span> </span>
<span id="cb220-64"><a href="#cb220-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb220-65"><a href="#cb220-65" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb220-66"><a href="#cb220-66" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb220-67"><a href="#cb220-67" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span><span class="fl">0.8</span>,</span>
<span id="cb220-68"><a href="#cb220-68" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb220-69"><a href="#cb220-69" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb220-70"><a href="#cb220-70" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb220-71"><a href="#cb220-71" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray17"</span>,</span>
<span id="cb220-72"><a href="#cb220-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb220-73"><a href="#cb220-73" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb220-74"><a href="#cb220-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb220-75"><a href="#cb220-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb220-76"><a href="#cb220-76" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb220-77"><a href="#cb220-77" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.9</span>),</span>
<span id="cb220-78"><a href="#cb220-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb220-79"><a href="#cb220-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb220-80"><a href="#cb220-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb220-81"><a href="#cb220-81" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb220-82"><a href="#cb220-82" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb220-83"><a href="#cb220-83" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb220-84"><a href="#cb220-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb220-85"><a href="#cb220-85" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb220-86"><a href="#cb220-86" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb220-87"><a href="#cb220-87" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb220-88"><a href="#cb220-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa2_clean,</span>
<span id="cb220-89"><a href="#cb220-89" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb220-90"><a href="#cb220-90" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb220-91"><a href="#cb220-91" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> station),</span>
<span id="cb220-92"><a href="#cb220-92" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb220-93"><a href="#cb220-93" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#619CFF"</span>) <span class="sc">+</span></span>
<span id="cb220-94"><a href="#cb220-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> shapes)<span class="sc">+</span></span>
<span id="cb220-95"><a href="#cb220-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb220-96"><a href="#cb220-96" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb220-97"><a href="#cb220-97" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Station"</span>,</span>
<span id="cb220-98"><a href="#cb220-98" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample Type"</span>) <span class="sc">+</span></span>
<span id="cb220-99"><a href="#cb220-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-100"><a href="#cb220-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-101"><a href="#cb220-101" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb220-102"><a href="#cb220-102" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> envfit_pcoa_water</span>
<span id="cb220-103"><a href="#cb220-103" aria-hidden="true" tabindex="-1"></a>envfit_pcoa_water</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/envfit_water.png", envfit_pcoa_water, width = 7, height = 5, units = "in", dpi = 300)</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the same figure but change from STATION to RIVER</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey58"</span>,</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.9</span>),</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray48"</span>,</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span> </span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span><span class="fl">0.8</span>,</span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray17"</span>,</span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.9</span>),</span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa2_clean,</span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb221-49"><a href="#cb221-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> river),</span>
<span id="cb221-50"><a href="#cb221-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb221-51"><a href="#cb221-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#619CFF"</span>) <span class="sc">+</span></span>
<span id="cb221-52"><a href="#cb221-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb221-53"><a href="#cb221-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb221-54"><a href="#cb221-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"River"</span>,</span>
<span id="cb221-55"><a href="#cb221-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample Type"</span>) <span class="sc">+</span></span>
<span id="cb221-56"><a href="#cb221-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb221-57"><a href="#cb221-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb221-58"><a href="#cb221-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb221-59"><a href="#cb221-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> envfit_pcoa_water_river</span>
<span id="cb221-60"><a href="#cb221-60" aria-hidden="true" tabindex="-1"></a>envfit_pcoa_water_river</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/envfit_pcoa_water_river.png", envfit_pcoa_water_river, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="fish-samples-envfit" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="fish-samples-envfit"><span class="header-section-number">15.3</span> Fish samples envfit</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>pcoa3 <span class="ot">=</span> <span class="fu">as.data.frame</span>(pcoares3<span class="sc">@</span>pca<span class="sc">$</span>vectors)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>pcoa3 <span class="sc">|&gt;</span> </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">row.names</span>(pcoa3)) <span class="sc">|&gt;</span> </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample, Axis<span class="fl">.1</span>, Axis<span class="fl">.2</span>, Axis<span class="fl">.3</span>) <span class="ot">-&gt;</span> pcoa3_clean</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge PCoA axis data with sample metadata</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm_fish<span class="sc">@</span>sam_data)</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>pcoa3_clean <span class="ot">=</span> <span class="fu">full_join</span>(pcoa3_clean, meta, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sample"</span> <span class="ot">=</span> <span class="st">"sampleID"</span>))</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>values3 <span class="ot">=</span> pcoares3<span class="sc">@</span>pca<span class="sc">$</span>values</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>values3 <span class="sc">|&gt;</span> </span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vector =</span> <span class="fu">row.names</span>(values3),</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">vector =</span> <span class="fu">as.numeric</span>(vector)) <span class="sc">|&gt;</span> </span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vector, Eigenvalues, Relative_eig) <span class="ot">-&gt;</span> values3</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Envfit vectors</span></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="ot">=</span> ef3<span class="sc">$</span>vectors<span class="sc">$</span>arrows</span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"variable"</span>) <span class="ot">-&gt;</span> ef_vectors</span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"turbidity"</span> <span class="sc">|</span> </span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">==</span> <span class="st">"do"</span> <span class="sc">|</span></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">==</span> <span class="st">"temperature"</span> <span class="sc">|</span></span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">==</span> <span class="st">"totalNitrogen"</span> <span class="sc">|</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">==</span> <span class="st">"day_of_yr"</span>) <span class="ot">-&gt;</span> ef_vectors_sig</span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>ef_vectors <span class="sc">|&gt;</span> </span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"turbidity"</span> <span class="sc">&amp;</span> </span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">!=</span> <span class="st">"do"</span> <span class="sc">&amp;</span></span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">!=</span> <span class="st">"temperature"</span> <span class="sc">&amp;</span></span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">!=</span> <span class="st">"totalNitrogen"</span> <span class="sc">&amp;</span></span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>         variable <span class="sc">!=</span> <span class="st">"day_of_yr"</span>) <span class="ot">-&gt;</span> ef_vectors_nonsig</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Make PCoA Axis Labels</span></span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"PCoA 1 ("</span>, <span class="fu">round</span>((values3<span class="sc">$</span>Relative_eig[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>),</span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"PCoA 2 ("</span>, <span class="fu">round</span>((values3<span class="sc">$</span>Relative_eig[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>),</span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(<span class="st">"PCoA 3 ("</span>, <span class="fu">round</span>((values3<span class="sc">$</span>Relative_eig[<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"%)"</span>))</span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">=</span> <span class="fu">list</span>(<span class="at">boelus =</span> <span class="dv">16</span>,</span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a>              <span class="at">hwy183 =</span> <span class="dv">17</span>,</span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">oneil =</span> <span class="dv">15</span>,</span>
<span id="cb223-47"><a href="#cb223-47" aria-hidden="true" tabindex="-1"></a>              <span class="at">presseywma =</span> <span class="dv">3</span>,</span>
<span id="cb223-48"><a href="#cb223-48" aria-hidden="true" tabindex="-1"></a>              <span class="at">ravenna =</span> <span class="dv">12</span>,</span>
<span id="cb223-49"><a href="#cb223-49" aria-hidden="true" tabindex="-1"></a>              <span class="at">sartoria =</span> <span class="dv">8</span>,</span>
<span id="cb223-50"><a href="#cb223-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">southstpaul =</span> <span class="dv">9</span>)</span>
<span id="cb223-51"><a href="#cb223-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-52"><a href="#cb223-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-53"><a href="#cb223-53" aria-hidden="true" tabindex="-1"></a><span class="do">### PLOT </span><span class="al">###</span></span>
<span id="cb223-54"><a href="#cb223-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb223-55"><a href="#cb223-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb223-56"><a href="#cb223-56" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb223-57"><a href="#cb223-57" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb223-58"><a href="#cb223-58" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb223-59"><a href="#cb223-59" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb223-60"><a href="#cb223-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb223-61"><a href="#cb223-61" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb223-62"><a href="#cb223-62" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey58"</span>,</span>
<span id="cb223-63"><a href="#cb223-63" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb223-64"><a href="#cb223-64" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb223-65"><a href="#cb223-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb223-66"><a href="#cb223-66" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb223-67"><a href="#cb223-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span><span class="fl">0.9</span>,</span>
<span id="cb223-68"><a href="#cb223-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span><span class="fl">0.9</span>),</span>
<span id="cb223-69"><a href="#cb223-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb223-70"><a href="#cb223-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray48"</span>,</span>
<span id="cb223-71"><a href="#cb223-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb223-72"><a href="#cb223-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>)<span class="sc">+</span> </span>
<span id="cb223-73"><a href="#cb223-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb223-74"><a href="#cb223-74" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb223-75"><a href="#cb223-75" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb223-76"><a href="#cb223-76" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb223-77"><a href="#cb223-77" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb223-78"><a href="#cb223-78" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb223-79"><a href="#cb223-79" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb223-80"><a href="#cb223-80" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray17"</span>,</span>
<span id="cb223-81"><a href="#cb223-81" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb223-82"><a href="#cb223-82" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb223-83"><a href="#cb223-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb223-84"><a href="#cb223-84" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb223-85"><a href="#cb223-85" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span><span class="fl">0.85</span>,</span>
<span id="cb223-86"><a href="#cb223-86" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span><span class="fl">0.90</span>),</span>
<span id="cb223-87"><a href="#cb223-87" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb223-88"><a href="#cb223-88" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb223-89"><a href="#cb223-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb223-90"><a href="#cb223-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb223-91"><a href="#cb223-91" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb223-92"><a href="#cb223-92" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-93"><a href="#cb223-93" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb223-94"><a href="#cb223-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb223-95"><a href="#cb223-95" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb223-96"><a href="#cb223-96" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb223-97"><a href="#cb223-97" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb223-98"><a href="#cb223-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa3_clean,</span>
<span id="cb223-99"><a href="#cb223-99" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb223-100"><a href="#cb223-100" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb223-101"><a href="#cb223-101" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> station,</span>
<span id="cb223-102"><a href="#cb223-102" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName),</span>
<span id="cb223-103"><a href="#cb223-103" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb223-104"><a href="#cb223-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> shapes) <span class="sc">+</span></span>
<span id="cb223-105"><a href="#cb223-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb223-106"><a href="#cb223-106" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb223-107"><a href="#cb223-107" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Station"</span>) <span class="sc">+</span></span>
<span id="cb223-108"><a href="#cb223-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-109"><a href="#cb223-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-110"><a href="#cb223-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-111"><a href="#cb223-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> envfit_pcoa</span>
<span id="cb223-112"><a href="#cb223-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-113"><a href="#cb223-113" aria-hidden="true" tabindex="-1"></a>envfit_pcoa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/envfit_fish.png", envfit_pcoa, width = 7, height =5, units = "in", dpi = 300)</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the same figure but change from STATION to RIVER</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"grey58"</span>,</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_nonsig,</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span><span class="fl">0.9</span>,</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span><span class="fl">0.9</span>),</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray48"</span>,</span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>)<span class="sc">+</span> </span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> Axis<span class="fl">.1</span> <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> Axis<span class="fl">.2</span> <span class="sc">*</span> <span class="fl">0.8</span>),</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>),</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray17"</span>,</span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">8</span>,</span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> ef_vectors_sig,</span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> variable,</span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> Axis<span class="fl">.1</span> <span class="sc">*</span><span class="fl">0.85</span>,</span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Axis<span class="fl">.2</span> <span class="sc">*</span><span class="fl">0.90</span>),</span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>,</span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb224-42"><a href="#cb224-42" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb224-43"><a href="#cb224-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb224-44"><a href="#cb224-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>),</span>
<span id="cb224-45"><a href="#cb224-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb224-46"><a href="#cb224-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.8</span>,</span>
<span id="cb224-47"><a href="#cb224-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray"</span>)<span class="sc">+</span></span>
<span id="cb224-48"><a href="#cb224-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pcoa3_clean,</span>
<span id="cb224-49"><a href="#cb224-49" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>,</span>
<span id="cb224-50"><a href="#cb224-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Axis<span class="fl">.2</span>,</span>
<span id="cb224-51"><a href="#cb224-51" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> river,</span>
<span id="cb224-52"><a href="#cb224-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> commonName),</span>
<span id="cb224-53"><a href="#cb224-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb224-54"><a href="#cb224-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> labs[<span class="dv">1</span>],</span>
<span id="cb224-55"><a href="#cb224-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> labs[<span class="dv">2</span>],</span>
<span id="cb224-56"><a href="#cb224-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"River"</span>) <span class="sc">+</span></span>
<span id="cb224-57"><a href="#cb224-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb224-58"><a href="#cb224-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb224-59"><a href="#cb224-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb224-60"><a href="#cb224-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)) <span class="ot">-&gt;</span> envfit_pcoa_river</span>
<span id="cb224-61"><a href="#cb224-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-62"><a href="#cb224-62" aria-hidden="true" tabindex="-1"></a>envfit_pcoa_river</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/envfit_fish_river.png", envfit_pcoa_river, width = 7, height =5, units = "in", dpi = 300)</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>enfit_combined <span class="ot">=</span> <span class="fu">ggarrange</span>(envfit_pcoa_water, envfit_pcoa)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/enfit_combined.png", enfit_combined, width = 12, height =5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="core-microbiomes-plotted" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="core-microbiomes-plotted"><span class="header-section-number">15.4</span> core microbiomes plotted</h2>
</section>
</section>
<section id="simper" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Simper</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unwanted fish species from the ps_paired_data phyloseobject.size</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>keeps <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Water"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Sand shiner"</span>)</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>ps_paired_data_int <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">%in%</span> keeps, ps_paired_data)</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>ps_paired_data_int <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(ps_paired_data_int) <span class="sc">&gt;</span> <span class="dv">0</span>, ps_paired_data_int)</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Code from Federica Montesanto</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # Prune taxa with zero abundance</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ps &lt;- prune_taxa(taxa_sums(ps_paired_data) &gt; 0, ps_paired_data)</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert tax table to data frame</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>df_tax <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ps_paired_data<span class="sc">@</span>tax_table)</span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>df_tax<span class="sc">$</span>ASV <span class="ot">&lt;-</span> <span class="fu">rownames</span>(df_tax)</span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>df_tax <span class="ot">&lt;-</span> df_tax[, <span class="fu">c</span>(<span class="st">"ASV"</span>, <span class="st">"Kingdom"</span>, <span class="st">"Phylum"</span>, <span class="st">"Class"</span>, <span class="st">"Order"</span>, <span class="st">"Family"</span>, <span class="st">"Genus"</span>, <span class="st">"Species"</span>)]</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add taxonomy information to OTU table</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>asv_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">otu_table</span>(ps_paired_data))</span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">rownames</span>(asv_mat) <span class="sc">==</span> <span class="fu">rownames</span>(df_tax))</span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">colnames</span>(asv_mat) <span class="sc">==</span> <span class="fu">sample_names</span>(ps_paired_data))</span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(asv_mat)</span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ASV <span class="ot">&lt;-</span> <span class="fu">rownames</span>(df)</span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(df, df_tax, <span class="at">by =</span> <span class="st">"ASV"</span>)</span>
<span id="cb226-24"><a href="#cb226-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-25"><a href="#cb226-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-26"><a href="#cb226-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with zeros</span></span>
<span id="cb226-27"><a href="#cb226-27" aria-hidden="true" tabindex="-1"></a><span class="co"># only missing values are in the taxonomy information. 0 doesn't make much sense</span></span>
<span id="cb226-28"><a href="#cb226-28" aria-hidden="true" tabindex="-1"></a><span class="co"># df[is.na(df)] &lt;- 0</span></span>
<span id="cb226-29"><a href="#cb226-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-30"><a href="#cb226-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data type of each column</span></span>
<span id="cb226-31"><a href="#cb226-31" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span>
<span id="cb226-32"><a href="#cb226-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-33"><a href="#cb226-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # Convert non-numeric columns to numeric</span></span>
<span id="cb226-34"><a href="#cb226-34" aria-hidden="true" tabindex="-1"></a>df[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">66</span>,<span class="dv">67</span>,<span class="dv">68</span>,<span class="dv">69</span>,<span class="dv">70</span>,<span class="dv">71</span>,<span class="dv">72</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(df[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">66</span>,<span class="dv">67</span>,<span class="dv">68</span>,<span class="dv">69</span>,<span class="dv">70</span>,<span class="dv">71</span>,<span class="dv">72</span>)], <span class="dv">2</span>, as.numeric)</span>
<span id="cb226-35"><a href="#cb226-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-36"><a href="#cb226-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix</span></span>
<span id="cb226-37"><a href="#cb226-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb226-38"><a href="#cb226-38" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(df[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">66</span>,<span class="dv">67</span>,<span class="dv">68</span>,<span class="dv">69</span>,<span class="dv">70</span>,<span class="dv">71</span>,<span class="dv">72</span>)], <span class="at">method =</span> <span class="st">"bray"</span>)</span>
<span id="cb226-39"><a href="#cb226-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-40"><a href="#cb226-40" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dist_mat)</span>
<span id="cb226-41"><a href="#cb226-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform SIMPER analysis</span></span>
<span id="cb226-42"><a href="#cb226-42" aria-hidden="true" tabindex="-1"></a>simper_res <span class="ot">&lt;-</span> <span class="fu">simper</span>(df[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">66</span>,<span class="dv">67</span>,<span class="dv">68</span>,<span class="dv">69</span>,<span class="dv">70</span>,<span class="dv">71</span>,<span class="dv">72</span>)], <span class="at">distance =</span> dist_mat, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb226-43"><a href="#cb226-43" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(simper_res)</span>
<span id="cb226-44"><a href="#cb226-44" aria-hidden="true" tabindex="-1"></a>simper_res<span class="sc">$</span>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="deseq2" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> DeSeq2</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a function to subset a phyloseq to keep only samples from two levels of a categorical variable. Prune ASVs that are not present in these groups.</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>subset_ps_2_groups <span class="ot">=</span> <span class="cf">function</span>(ps, variable, g1, g2){</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">prune_samples</span>((ps<span class="sc">@</span>sam_data[[variable]] <span class="sc">==</span> g1 <span class="sc">|</span> ps<span class="sc">@</span>sam_data[[variable]] <span class="sc">==</span> g2), ps)</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(data) <span class="sc">&gt;</span> <span class="dv">0</span>, data)</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(<span class="fu">taxa_sums</span>(ps_paired_data), <span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"h"</span>, <span class="at">ylab=</span><span class="st">"Abundance"</span>, <span class="at">main =</span> <span class="st">"ASV rank abundance plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/deseq2_distribution-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all ASVs of the same family.</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>ps_paired_data_FAMILY <span class="ot">=</span> <span class="fu">tax_glom</span>(ps_paired_data,</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">taxrank =</span> <span class="st">"Family"</span>,</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">NArm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>ps_paired_data_FAMILY</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 171 taxa and 60 samples ]
sample_data() Sample Data:       [ 60 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 171 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 171 tips and 170 internal nodes ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check to see if data family distribution is similar to ASV distribution.</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(<span class="fu">taxa_sums</span>(ps_paired_data_FAMILY), <span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"h"</span>, <span class="at">ylab=</span><span class="st">"Abundance"</span>, <span class="at">main =</span> <span class="st">"Family rank abundance plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/deseq2_distribution-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all ASVs of the same order.</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>ps_paired_data_ORDER <span class="ot">=</span> <span class="fu">tax_glom</span>(ps_paired_data,</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">taxrank =</span> <span class="st">"Order"</span>,</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">NArm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>ps_paired_data_ORDER</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 108 taxa and 60 samples ]
sample_data() Sample Data:       [ 60 samples by 30 sample variables ]
tax_table()   Taxonomy Table:    [ 108 taxa by 7 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 108 tips and 107 internal nodes ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check to see if data order distribution is similar to ASV distribution.</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(<span class="fu">taxa_sums</span>(ps_paired_data_ORDER), <span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"h"</span>, <span class="at">ylab=</span><span class="st">"Abundance"</span>, <span class="at">main =</span> <span class="st">"Order rank abundance plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/deseq2_distribution-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all ASVs of the same phylum.</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>ps_paired_data_PHYLA <span class="ot">=</span> <span class="fu">tax_glom</span>(ps_paired_data,</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">taxrank =</span> <span class="st">"Phylum"</span>,</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">NArm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check to see if data order distribution is similar to ASV distribution.</span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(<span class="fu">taxa_sums</span>(ps_paired_data_PHYLA), <span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"h"</span>, <span class="at">ylab=</span><span class="st">"Abundance"</span>, <span class="at">main =</span> <span class="st">"Phyla rank abundance plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/deseq2_distribution-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See how much of the microbiome is made of a few dominate Phyla</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>ps_paired_data_PHYLA_norm <span class="ot">=</span> <span class="fu">transform_sample_counts</span>(ps_paired_data_PHYLA, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="fu">sum</span>(x) )</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co"># How much of the fish microbiome is Proteobacteria, Cyanobacteria, Firmicutes, and Actinobacteria?</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>phyla_fish_norm <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_paired_data_PHYLA_norm<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>, ps_paired_data_PHYLA_norm)</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>fish_dom_taxa <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Proteobacteria"</span>, <span class="st">"Cyanobacteria"</span>, <span class="st">"Firmicutes"</span>, <span class="st">"Actinobacteriota"</span>)</span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>phyla_fish_norm <span class="ot">=</span> <span class="fu">prune_taxa</span>(phyla_fish_norm<span class="sc">@</span>tax_table[,<span class="dv">2</span>] <span class="sc">%in%</span> fish_dom_taxa, phyla_fish_norm)</span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>fish_top_4_abund <span class="ot">=</span> <span class="fu">sample_sums</span>(phyla_fish_norm)</span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(fish_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6794607</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(fish_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9970681</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fish_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9365538</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(fish_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06531268</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How much of the water microbiome is Proteobacteria, Cyanobacteria, Actionbacteria, and bacterodota</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>phyla_water_norm <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_paired_data_PHYLA_norm<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span>, ps_paired_data_PHYLA_norm)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>water_dom_taxa <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Proteobacteria"</span>, <span class="st">"Cyanobacteria"</span>, <span class="st">"Firmicutes"</span>, <span class="st">"Bacteroidota"</span>)</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>ps_water_norm <span class="ot">=</span> <span class="fu">prune_taxa</span>(phyla_water_norm<span class="sc">@</span>tax_table[,<span class="dv">2</span>] <span class="sc">%in%</span> water_dom_taxa, phyla_water_norm)</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>water_top_4_abund <span class="ot">=</span> <span class="fu">sample_sums</span>(ps_water_norm)</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(water_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6792809</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(water_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8889457</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(water_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7694811</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(water_top_4_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0593535</code></pre>
</div>
</div>
<section id="phyla-level" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="phyla-level"><span class="header-section-number">17.1</span> Phyla Level</h2>
<section id="red-shiner-vs-water-differential-phyla" class="level3" data-number="17.1.1">
<h3 data-number="17.1.1" class="anchored" data-anchor-id="red-shiner-vs-water-differential-phyla"><span class="header-section-number">17.1.1</span> Red Shiner vs Water: Differential Phyla</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="do">### RED SHINER VS WATER ####</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phyloseq subset with only Water and Red shiner samples</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>ps_water_red_phy <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data_PHYLA,</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g1 =</span> <span class="st">"Water"</span>,</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g2 =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert phyloseq to DESeq2</span></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">phyloseq_to_deseq2</span>(ps_water_red_phy, <span class="sc">~</span> commonName)</span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define reference group</span></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>diagdds<span class="sc">$</span>commonName <span class="ot">=</span> <span class="fu">relevel</span>(diagdds<span class="sc">$</span>commonName, <span class="at">ref =</span> <span class="st">"Water"</span>)</span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the DESeq function</span></span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">DESeq</span>(diagdds)</span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-18"><a href="#cb252-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results and order by adj p-value.</span></span>
<span id="cb252-19"><a href="#cb252-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">results</span>(diagdds, <span class="at">alpha =</span> alpha)</span>
<span id="cb252-20"><a href="#cb252-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> res[<span class="fu">order</span>(res<span class="sc">$</span>padj, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb252-21"><a href="#cb252-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
out of 19 with nonzero total read count
adjusted p-value &lt; 0.01
LFC &gt; 0 (up)       : 2, 11%
LFC &lt; 0 (down)     : 6, 32%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 0)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These appear as ASVs but they truley represent the order that they belong too. I would like to find a way to change this name.</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>keep_order <span class="ot">=</span> <span class="fu">rownames</span>(res[res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha, ])</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object with only the differential ASVs to get taxonomy info</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This phyloseq object will have the count values</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>water_red_df_phys <span class="ot">=</span> <span class="fu">prune_taxa</span>(keep_order, ps_paired_data_PHYLA)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make significance tab with taxa information</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> res[<span class="fu">which</span>(res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha), ]</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as</span>(sigtab, <span class="st">"data.frame"</span>), <span class="fu">as</span>(water_red_df_phys<span class="sc">@</span>tax_table[<span class="fu">rownames</span>(sigtab), ], <span class="st">"matrix"</span>))</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pretty version of significance table.</span></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>sigtab <span class="sc">|&gt;</span> </span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Phylum"</span>, <span class="st">"log2FoldChange"</span>, <span class="st">"padj"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log2FoldChange =</span> <span class="fu">formatC</span>(log2FoldChange, <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">padj =</span> <span class="fu">formatC</span>(padj, <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Phylum log2FoldChange       padj
ASV_26        Firmicutes           7.93 5.7571e-35
ASV_19      Bacteroidota          -5.37 1.2075e-09
ASV_197  Gemmatimonadota          -7.02 2.3778e-09
ASV_436  Acidobacteriota          -4.26 5.7306e-05
ASV_196   Armatimonadota          -5.52 0.00022876
ASV_114  Planctomycetota           2.34  0.0013965
ASV_598 Bdellovibrionota          -3.81  0.0039393
ASV_5   Actinobacteriota         -0.956  0.0057489</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple plot</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(3,3))</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(diagdds, <span class="at">gene =</span> keep_order[x], <span class="at">intgroup=</span><span class="st">"commonName"</span>)</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot of these resutls</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylum order</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">tapply</span>(sigtab<span class="sc">$</span>log2FoldChange, sigtab<span class="sc">$</span>Phylum, <span class="cf">function</span>(x) <span class="fu">max</span>(x))</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>(x, <span class="cn">TRUE</span>)</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>sigtab<span class="sc">$</span>Phylum <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(sigtab<span class="sc">$</span>Phylum), <span class="at">levels=</span><span class="fu">names</span>(x))</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sigtab, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span>Phylum)) <span class="sc">+</span> </span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Red Shiner vs Water"</span>,</span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Differential Phyla"</span>)<span class="sc">+</span></span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="ot">-&gt;</span> red_water_phy</span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>red_water_phy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla-9.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/red_water_phy.png", red_water_phy, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sand-shiner-vs-water-differential-phyla" class="level3" data-number="17.1.2">
<h3 data-number="17.1.2" class="anchored" data-anchor-id="sand-shiner-vs-water-differential-phyla"><span class="header-section-number">17.1.2</span> Sand Shiner vs Water: Differential Phyla</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SAND SHINER VS WATER ####</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phyloseq subset with only Water and Red shiner samples</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>ps_water_sand_phy <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data_PHYLA,</span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g1 =</span> <span class="st">"Water"</span>,</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g2 =</span> <span class="st">"Sand shiner"</span>)</span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert phyloseq to DESeq2</span></span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">phyloseq_to_deseq2</span>(ps_water_sand_phy, <span class="sc">~</span> commonName)</span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define reference group</span></span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a>diagdds<span class="sc">$</span>commonName <span class="ot">=</span> <span class="fu">relevel</span>(diagdds<span class="sc">$</span>commonName, <span class="at">ref =</span> <span class="st">"Water"</span>)</span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the DESeq function</span></span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">DESeq</span>(diagdds)</span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-18"><a href="#cb259-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results and order by adj p-value.</span></span>
<span id="cb259-19"><a href="#cb259-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">results</span>(diagdds, <span class="at">alpha =</span> alpha)</span>
<span id="cb259-20"><a href="#cb259-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> res[<span class="fu">order</span>(res<span class="sc">$</span>padj, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb259-21"><a href="#cb259-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
out of 20 with nonzero total read count
adjusted p-value &lt; 0.01
LFC &gt; 0 (up)       : 3, 15%
LFC &lt; 0 (down)     : 7, 35%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 0)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These appear as ASVs but they truley represent the order that they belong too. I would like to find a way to change this name.</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>keep_order <span class="ot">=</span> <span class="fu">rownames</span>(res[res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha, ])</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object with only the differential ASVs to get taxonomy info</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This phyloseq object will have the count values</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>water_sand_df_phys <span class="ot">=</span> <span class="fu">prune_taxa</span>(keep_order, ps_paired_data_PHYLA)</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make significance tab with taxa information</span></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> res[<span class="fu">which</span>(res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha), ]</span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as</span>(sigtab, <span class="st">"data.frame"</span>), <span class="fu">as</span>(water_sand_df_phys<span class="sc">@</span>tax_table[<span class="fu">rownames</span>(sigtab), ], <span class="st">"matrix"</span>))</span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pretty version of significance table.</span></span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>sigtab <span class="sc">|&gt;</span> </span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Phylum"</span>, <span class="st">"log2FoldChange"</span>, <span class="st">"padj"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log2FoldChange =</span> <span class="fu">formatC</span>(log2FoldChange, <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">padj =</span> <span class="fu">formatC</span>(padj, <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Phylum log2FoldChange       padj
ASV_26        Firmicutes           7.38 4.9952e-38
ASV_197  Gemmatimonadota          -8.08  4.919e-15
ASV_19      Bacteroidota           -5.7 3.5496e-14
ASV_114  Planctomycetota           3.19 5.9127e-13
ASV_196   Armatimonadota          -6.52 4.2486e-07
ASV_282      Myxococcota          -2.91 0.00061001
ASV_436  Acidobacteriota          -2.69 0.00061001
ASV_941 Latescibacterota           -5.6  0.0014703
ASV_200 Desulfobacterota           2.22  0.0021013
ASV_598 Bdellovibrionota          -4.12  0.0029993</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple plot</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(3,3))</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(diagdds, <span class="at">gene =</span> keep_order[x], <span class="at">intgroup=</span><span class="st">"commonName"</span>)</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-10.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot of these resutls</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylum order</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">tapply</span>(sigtab<span class="sc">$</span>log2FoldChange, sigtab<span class="sc">$</span>Phylum, <span class="cf">function</span>(x) <span class="fu">max</span>(x))</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>(x, <span class="cn">TRUE</span>)</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>sigtab<span class="sc">$</span>Phylum <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(sigtab<span class="sc">$</span>Phylum), <span class="at">levels=</span><span class="fu">names</span>(x))</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sigtab, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span>Phylum)) <span class="sc">+</span> </span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sand Shiner vs Water"</span>,</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Differential Phyla"</span>)<span class="sc">+</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="ot">-&gt;</span> sand_water_phy</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a>sand_water_phy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla2-11.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sand_water_phy.png", sand_water_phy, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sand-shiner-vs-red-shiner-differential-phyla" class="level3" data-number="17.1.3">
<h3 data-number="17.1.3" class="anchored" data-anchor-id="sand-shiner-vs-red-shiner-differential-phyla"><span class="header-section-number">17.1.3</span> Sand Shiner vs Red Shiner: Differential Phyla</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SAND SHINER VS RED SHINER ####</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phyloseq subset with only Water and Red shiner samples</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>ps_red_sand_phy <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data_PHYLA,</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g1 =</span> <span class="st">"Red shiner"</span>,</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g2 =</span> <span class="st">"Sand shiner"</span>)</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert phyloseq to DESeq2</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">phyloseq_to_deseq2</span>(ps_red_sand_phy, <span class="sc">~</span> commonName)</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define reference group</span></span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>diagdds<span class="sc">$</span>commonName <span class="ot">=</span> <span class="fu">relevel</span>(diagdds<span class="sc">$</span>commonName, <span class="at">ref =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the DESeq function</span></span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">DESeq</span>(diagdds)</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results and order by adj p-value.</span></span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">results</span>(diagdds, <span class="at">alpha =</span> alpha)</span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> res[<span class="fu">order</span>(res<span class="sc">$</span>padj, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
out of 17 with nonzero total read count
adjusted p-value &lt; 0.01
LFC &gt; 0 (up)       : 1, 5.9%
LFC &lt; 0 (down)     : 0, 0%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 0)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These appear as ASVs but they truley represent the order that they belong too. I would like to find a way to change this name.</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>keep_order <span class="ot">=</span> <span class="fu">rownames</span>(res[res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha, ])</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object with only the differential ASVs to get taxonomy info</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This phyloseq object will have the count values</span></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>red_sand_df_phys <span class="ot">=</span> <span class="fu">prune_taxa</span>(keep_order, ps_paired_data_PHYLA)</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make significance tab with taxa information</span></span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> res[<span class="fu">which</span>(res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha), ]</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as</span>(sigtab, <span class="st">"data.frame"</span>), <span class="fu">as</span>(red_sand_df_phys<span class="sc">@</span>tax_table[<span class="fu">rownames</span>(sigtab), ], <span class="st">"matrix"</span>))</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pretty version of significance table.</span></span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>sigtab <span class="sc">|&gt;</span> </span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Phylum"</span>, <span class="st">"log2FoldChange"</span>, <span class="st">"padj"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log2FoldChange =</span> <span class="fu">formatC</span>(log2FoldChange, <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">padj =</span> <span class="fu">formatC</span>(padj, <span class="at">format =</span> <span class="st">"g"</span>, <span class="at">digits =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Phylum log2FoldChange       padj
ASV_59 Verrucomicrobiota           2.08 0.00064506</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple plot</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(diagdds, <span class="at">gene =</span> keep_order[x], <span class="at">intgroup=</span><span class="st">"commonName"</span>)</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot of these resutls</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylum order</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">tapply</span>(sigtab<span class="sc">$</span>log2FoldChange, sigtab<span class="sc">$</span>Phylum, <span class="cf">function</span>(x) <span class="fu">max</span>(x))</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>(x, <span class="cn">TRUE</span>)</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a>sigtab<span class="sc">$</span>Phylum <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(sigtab<span class="sc">$</span>Phylum), <span class="at">levels=</span><span class="fu">names</span>(x))</span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sigtab, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span>Phylum)) <span class="sc">+</span> </span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sand Shiner vs Red Shiner"</span>,</span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Differential Phyla"</span>)<span class="sc">+</span></span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="ot">-&gt;</span> sand_red_phy</span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a>sand_red_phy</span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sand_red_phy.png", sand_red_phy, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/DESeq_phyla3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="family-level" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="family-level"><span class="header-section-number">17.2</span> Family Level</h2>
<section id="red-shiner-vs-water" class="level3" data-number="17.2.1">
<h3 data-number="17.2.1" class="anchored" data-anchor-id="red-shiner-vs-water"><span class="header-section-number">17.2.1</span> Red shiner vs Water</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Red SHINER VS WATER ####</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phyloseq subset with only Water and Red shiner samples</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>ps_red_water_fam <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data_FAMILY,</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g1 =</span> <span class="st">"Red shiner"</span>,</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g2 =</span> <span class="st">"Water"</span>)</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert phyloseq to DESeq2</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">phyloseq_to_deseq2</span>(ps_red_water_fam, <span class="sc">~</span> commonName)</span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define reference group</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a>diagdds<span class="sc">$</span>commonName <span class="ot">=</span> <span class="fu">relevel</span>(diagdds<span class="sc">$</span>commonName, <span class="at">ref =</span> <span class="st">"Water"</span>)</span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the DESeq function</span></span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">DESeq</span>(diagdds)</span>
<span id="cb271-17"><a href="#cb271-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-18"><a href="#cb271-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results and order by adj p-value.</span></span>
<span id="cb271-19"><a href="#cb271-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">results</span>(diagdds, <span class="at">alpha =</span> alpha)</span>
<span id="cb271-20"><a href="#cb271-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> res[<span class="fu">order</span>(res<span class="sc">$</span>padj, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb271-21"><a href="#cb271-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
out of 111 with nonzero total read count
adjusted p-value &lt; 0.01
LFC &gt; 0 (up)       : 2, 1.8%
LFC &lt; 0 (down)     : 69, 62%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 2)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These appear as ASVs but they truley represent the family that they belong too. I would like to find a way to change this name.</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>keep_order <span class="ot">=</span> <span class="fu">rownames</span>(res[res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha, ])</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object with only the differential ASVs to get taxonomy info</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This phyloseq object will have the count values</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>red_water_df_fam <span class="ot">=</span> <span class="fu">prune_taxa</span>(keep_order, ps_paired_data_FAMILY)</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make significance tab with taxa information</span></span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> res[<span class="fu">which</span>(res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha), ]</span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as</span>(sigtab, <span class="st">"data.frame"</span>), <span class="fu">as</span>(red_water_df_fam<span class="sc">@</span>tax_table[<span class="fu">rownames</span>(sigtab), ], <span class="st">"matrix"</span>))</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pretty version of significance table.</span></span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a>sigtab <span class="sc">|&gt;</span> </span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Family"</span>, <span class="st">"log2FoldChange"</span>, <span class="st">"padj"</span>) <span class="ot">-&gt;</span> sig_tab_output</span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a>sig_tab_output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Family log2FoldChange          padj
ASV_58             Methylophilaceae     -16.195054 1.485833e-144
ASV_3              Burkholderiaceae     -10.502220  8.254132e-79
ASV_378             Microscillaceae     -12.487165  5.809470e-66
ASV_65            Flavobacteriaceae     -16.403890  1.641036e-63
ASV_525                  env.OPS 17     -12.925722  1.279917e-60
ASV_436         Vicinamibacteraceae     -13.383564  4.965743e-44
ASV_132              Saprospiraceae     -12.882732  1.584623e-42
ASV_46             Chitinophagaceae     -12.129869  9.279785e-42
ASV_566             Hyphomonadaceae     -12.521898  1.210707e-41
ASV_102              Rhodocyclaceae     -15.502556  5.174462e-41
ASV_421           Blastocatellaceae     -11.474875  6.867363e-41
ASV_491          Rhodanobacteraceae     -11.400145  1.496015e-36
ASV_96            Crocinitomicaceae     -14.921575  1.327415e-32
ASV_19                Spirosomaceae     -14.679078  1.011275e-29
ASV_197           Gemmatimonadaceae     -13.394129  1.307539e-29
ASV_113           Pseudanabaenaceae     -14.516528  2.942660e-26
ASV_99             Caulobacteraceae     -11.000458  1.465703e-25
ASV_554             Pedosphaeraceae     -12.358282  9.187685e-25
ASV_287         Verrucomicrobiaceae      -8.717510  1.107337e-24
ASV_286        NS11-12 marine group     -13.250640  6.181351e-24
ASV_5               Sporichthyaceae     -10.823952  1.244733e-23
ASV_276              Alcaligenaceae     -11.847340  1.370981e-20
ASV_82          Steroidobacteraceae     -11.394212  1.630840e-19
ASV_419              Geobacteraceae     -10.879974  6.681607e-19
ASV_157          Ilumatobacteraceae     -10.100377  4.801345e-18
ASV_1406        Pseudohongiellaceae     -27.885429  2.350660e-17
ASV_388              Reyranellaceae      -8.259140  2.118896e-16
ASV_196            Armatimonadaceae     -12.645113  5.892499e-16
ASV_185           Microbacteriaceae      -8.558377  7.968217e-16
ASV_59               Rubritaleaceae      -6.737366  7.968217e-16
ASV_172              Sutterellaceae     -10.913136  4.714601e-15
ASV_167           Sphingomonadaceae      -7.790855  1.444972e-14
ASV_598          Bdellovibrionaceae     -11.074855  6.887780e-14
ASV_14   Rhizobiales Incertae Sedis      -5.757657  8.485558e-14
ASV_344            NS9 marine group     -10.670172  1.002905e-13
ASV_433           Cyclobacteriaceae     -11.515349  1.983974e-12
ASV_57          Chthoniobacteraceae      -7.615525  4.873049e-11
ASV_543         Desulfuromonadaceae     -10.594692  9.896318e-11
ASV_39             Rhodobacteraceae      -5.428719  2.150393e-09
ASV_393           Methylomonadaceae      -7.232654  3.462685e-09
ASV_61             Beijerinckiaceae      -4.624814  6.095668e-09
ASV_852             Eggerthellaceae      19.470768  8.183720e-09
ASV_290           Rubinisphaeraceae      -5.003727  1.299310e-08
ASV_782           Nitrosomonadaceae     -11.588236  2.252195e-08
ASV_41             Xanthomonadaceae      -9.120691  2.351916e-08
ASV_2                Comamonadaceae     -10.834301  3.057052e-07
ASV_603                   Iamiaceae      -6.354741  8.800334e-07
ASV_380               Moraxellaceae      -5.959418  9.855381e-07
ASV_500              Rickettsiaceae      -8.481265  1.378126e-06
ASV_657     Bacteroidetes vadinHA17     -10.826425  5.302430e-06
ASV_16                 Cyanobiaceae      -6.761411  7.490430e-06
ASV_372              Unknown Family      -9.920252  1.091002e-05
ASV_1363                 Halieaceae      -9.320463  1.990069e-05
ASV_440            Oxalobacteraceae      -8.331286  2.052548e-05
ASV_114                 Gemmataceae      -3.067957  2.835515e-05
ASV_36            Streptomycetaceae       2.847554  5.878277e-05
ASV_449           Hyphomicrobiaceae      -5.732094  1.204053e-04
ASV_352          Chitinibacteraceae      -7.274266  2.805409e-04
ASV_223           Xanthobacteraceae      -6.632155  3.050582e-04
ASV_621                 Devosiaceae     -10.162137  3.680621e-04
ASV_297            Pseudomonadaceae      -5.355571  5.326911e-04
ASV_443            Methylococcaceae      -6.109709  6.937009e-04
ASV_524                 Gaiellaceae      -6.875520  7.050727e-04
ASV_781            Pyrinomonadaceae      -9.365474  7.151653e-04
ASV_243              Micrococcaceae      -5.685683  8.835286e-04
ASV_789              Cryomorphaceae      -8.949806  1.105613e-03
ASV_200            Desulfocapsaceae      -3.987721  1.707238e-03
ASV_1768             Prevotellaceae      -6.956462  2.104990e-03
ASV_552              Isosphaeraceae      -5.446974  3.802347e-03
ASV_989          Spongiibacteraceae      -9.044818  7.168474e-03
ASV_553                Rhizobiaceae      -3.936657  9.861863e-03</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(sig_tab_output, <span class="st">"red_water_fam_deseq.csv"</span>)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">71</span>){</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(diagdds, <span class="at">gene =</span> keep_order[x], <span class="at">intgroup=</span><span class="st">"commonName"</span>)</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-24.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-25.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-26.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-27.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-28.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-29.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-30.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-31.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-32.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-33.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-34.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-35.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-36.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-37.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-38.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-39.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-40.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-41.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-42.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-43.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-44.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-45.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-46.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-47.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-48.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-49.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-50.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-51.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-52.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-53.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-54.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-55.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-56.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-57.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-58.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-59.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-60.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-61.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-62.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-63.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-64.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-65.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-66.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-67.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-68.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-69.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-70.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-71.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot of these resutls</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylum order</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">tapply</span>(sigtab<span class="sc">$</span>log2FoldChange, sigtab<span class="sc">$</span>Family, <span class="cf">function</span>(x) <span class="fu">max</span>(x))</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>(x, <span class="cn">TRUE</span>)</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>sigtab<span class="sc">$</span>Family <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(sigtab<span class="sc">$</span>Family), <span class="at">levels=</span><span class="fu">names</span>(x))</span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sigtab, <span class="fu">aes</span>(<span class="at">x=</span>Family, <span class="at">y=</span>log2FoldChange)) <span class="sc">+</span> </span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Red Shiner vs Water"</span>,</span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Differential Families"</span>)<span class="sc">+</span></span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="ot">-&gt;</span> red_water_fam</span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a>red_water_fam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam1-72.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/red_water_fam.png", red_water_fam, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sand-shiner-vs-water" class="level3" data-number="17.2.2">
<h3 data-number="17.2.2" class="anchored" data-anchor-id="sand-shiner-vs-water"><span class="header-section-number">17.2.2</span> Sand shiner vs Water</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SAND SHINER VS WATER ####</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phyloseq subset with only Water and Red shiner samples</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>ps_sand_water_fam <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data_FAMILY,</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g1 =</span> <span class="st">"Sand shiner"</span>,</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g2 =</span> <span class="st">"Water"</span>)</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert phyloseq to DESeq2</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">phyloseq_to_deseq2</span>(ps_sand_water_fam, <span class="sc">~</span> commonName)</span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define reference group</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a>diagdds<span class="sc">$</span>commonName <span class="ot">=</span> <span class="fu">relevel</span>(diagdds<span class="sc">$</span>commonName, <span class="at">ref =</span> <span class="st">"Water"</span>)</span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the DESeq function</span></span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">DESeq</span>(diagdds)</span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results and order by adj p-value.</span></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">results</span>(diagdds, <span class="at">alpha =</span> alpha)</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> res[<span class="fu">order</span>(res<span class="sc">$</span>padj, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb278-20"><a href="#cb278-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
out of 141 with nonzero total read count
adjusted p-value &lt; 0.01
LFC &gt; 0 (up)       : 11, 7.8%
LFC &lt; 0 (down)     : 44, 31%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 0)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These appear as ASVs but they truley represent the family that they belong too. I would like to find a way to change this name.</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>keep_order <span class="ot">=</span> <span class="fu">rownames</span>(res[res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha, ])</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object with only the differential ASVs to get taxonomy info</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This phyloseq object will have the count values</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>sand_water_df_fam <span class="ot">=</span> <span class="fu">prune_taxa</span>(keep_order, ps_paired_data_FAMILY)</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make significance tab with taxa information</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> res[<span class="fu">which</span>(res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha), ]</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as</span>(sigtab, <span class="st">"data.frame"</span>), <span class="fu">as</span>(sand_water_df_fam<span class="sc">@</span>tax_table[<span class="fu">rownames</span>(sigtab), ], <span class="st">"matrix"</span>))</span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pretty version of significance table.</span></span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>sigtab <span class="sc">|&gt;</span> </span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Family"</span>, <span class="st">"log2FoldChange"</span>, <span class="st">"padj"</span>) <span class="ot">-&gt;</span> sig_tab_output</span>
<span id="cb280-15"><a href="#cb280-15" aria-hidden="true" tabindex="-1"></a>sig_tab_output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          Family log2FoldChange         padj
ASV_19             Spirosomaceae     -12.636049 3.346509e-39
ASV_276           Alcaligenaceae      -8.636136 1.835159e-38
ASV_286     NS11-12 marine group     -10.953377 4.944519e-37
ASV_5            Sporichthyaceae      -6.970392 1.105683e-35
ASV_91          Mycoplasmataceae      24.262970 2.760925e-32
ASV_525               env.OPS 17      -9.681358 9.203216e-29
ASV_566          Hyphomonadaceae      -8.871449 1.556663e-28
ASV_132           Saprospiraceae     -10.099671 1.281715e-27
ASV_378          Microscillaceae      -9.382671 1.716354e-25
ASV_65         Flavobacteriaceae     -11.323394 6.269189e-25
ASV_96         Crocinitomicaceae     -11.264520 1.766167e-22
ASV_46          Chitinophagaceae      -7.796326 5.695059e-21
ASV_2             Comamonadaceae     -10.487866 1.069081e-20
ASV_491       Rhodanobacteraceae      -7.918614 2.684107e-20
ASV_197        Gemmatimonadaceae     -10.180598 1.912151e-18
ASV_113        Pseudanabaenaceae     -11.545723 1.795847e-16
ASV_436      Vicinamibacteraceae      -7.090633 2.570638e-16
ASV_554          Pedosphaeraceae      -8.890149 1.283450e-15
ASV_1406     Pseudohongiellaceae     -24.185628 3.446017e-15
ASV_3           Burkholderiaceae      -5.707207 2.074514e-14
ASV_102           Rhodocyclaceae      -7.859951 1.566408e-12
ASV_169          Enterococcaceae      21.306353 7.709286e-12
ASV_196         Armatimonadaceae      -8.451548 1.415416e-10
ASV_1           Acetobacteraceae       3.722596 5.087304e-10
ASV_99          Caulobacteraceae      -6.979682 2.179267e-09
ASV_421        Blastocatellaceae      -6.025407 3.120364e-09
ASV_167        Sphingomonadaceae      -4.943849 7.448576e-09
ASV_185        Microbacteriaceae      -4.059208 8.011524e-09
ASV_598       Bdellovibrionaceae      -7.462252 4.108291e-08
ASV_344         NS9 marine group      -6.923803 4.285411e-08
ASV_157       Ilumatobacteraceae      -3.128357 9.177612e-08
ASV_433        Cyclobacteriaceae      -8.852443 1.006758e-07
ASV_41          Xanthomonadaceae      -4.728952 1.694104e-07
ASV_36         Streptomycetaceae       6.216526 4.572292e-07
ASV_82       Steroidobacteraceae      -5.318296 1.574202e-06
ASV_16              Cyanobiaceae      -5.712136 1.574202e-06
ASV_927                     WX65       5.063001 5.696493e-06
ASV_172           Sutterellaceae      -4.894674 1.285967e-05
ASV_272      Erysipelotrichaceae       7.954836 2.724110e-05
ASV_287      Verrucomicrobiaceae      -2.064351 6.206863e-05
ASV_782        Nitrosomonadaceae      -7.394074 7.599065e-05
ASV_388           Reyranellaceae      -2.277713 2.161169e-04
ASV_352       Chitinibacteraceae      -5.556850 4.888417e-04
ASV_393        Methylomonadaceae      -2.929118 7.110608e-04
ASV_372           Unknown Family      -7.750685 8.966444e-04
ASV_150           Clostridiaceae       3.234083 9.159462e-04
ASV_657  Bacteroidetes vadinHA17      -7.630934 9.778057e-04
ASV_4             Aeromonadaceae       5.233405 1.486859e-03
ASV_39          Rhodobacteraceae      -1.077229 1.486859e-03
ASV_58          Methylophilaceae      -6.100620 1.667422e-03
ASV_260              Bacillaceae       3.475159 1.749899e-03
ASV_543      Desulfuromonadaceae      -4.651166 2.269892e-03
ASV_500           Rickettsiaceae      -5.711707 2.797569e-03
ASV_1300          Caldilineaceae       5.606052 4.987500e-03
ASV_471            Pirellulaceae       1.511123 8.611897e-03</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(sig_tab_output, <span class="st">"sand_water_fam_deseq.csv"</span>)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">55</span>){</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(diagdds, <span class="at">gene =</span> keep_order[x], <span class="at">intgroup=</span><span class="st">"commonName"</span>)</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-24.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-25.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-26.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-27.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-28.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-29.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-30.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-31.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-32.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-33.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-34.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-35.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-36.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-37.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-38.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-39.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-40.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-41.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-42.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-43.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-44.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-45.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-46.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-47.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-48.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-49.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-50.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-51.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-52.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-53.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-54.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-55.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot of these resutls</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylum order</span></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">tapply</span>(sigtab<span class="sc">$</span>log2FoldChange, sigtab<span class="sc">$</span>Family, <span class="cf">function</span>(x) <span class="fu">max</span>(x))</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>(x, <span class="cn">TRUE</span>)</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>sigtab<span class="sc">$</span>Family <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(sigtab<span class="sc">$</span>Family), <span class="at">levels=</span><span class="fu">names</span>(x))</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sigtab, <span class="fu">aes</span>(<span class="at">x=</span>Family, <span class="at">y=</span>log2FoldChange)) <span class="sc">+</span> </span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sand Shiner vs Water"</span>,</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Differential Families"</span>)<span class="sc">+</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="ot">-&gt;</span> sand_water_fam</span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a>sand_water_fam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam2-56.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sand_water_fam.png", sand_water_fam, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="look-for-patterns-in-family-selection-between-species" class="level3" data-number="17.2.3">
<h3 data-number="17.2.3" class="anchored" data-anchor-id="look-for-patterns-in-family-selection-between-species"><span class="header-section-number">17.2.3</span> Look for patterns in family selection between species</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>red_dif_fams <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"red_water_fam_deseq.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 71 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Family
dbl (2): log2FoldChange, padj

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>sand_dif_fams <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"sand_water_fam_deseq.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 55 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Family
dbl (2): log2FoldChange, padj

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These families were differentially expressed in both red shiners and sand shiners compared to the water</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>red_dif_fams <span class="sc">|&gt;</span> </span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(red_dif_fams<span class="sc">$</span>Family <span class="sc">%in%</span> sand_dif_fams<span class="sc">$</span>Family) <span class="sc">|&gt;</span> </span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Family) <span class="ot">-&gt;</span> keep_list</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="co"># keep_list</span></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>red_dif_fams <span class="sc">|&gt;</span> </span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Family <span class="sc">%in%</span> keep_list<span class="sc">$</span>Family) <span class="sc">|&gt;</span> </span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log2FoldChange_red =</span> log2FoldChange) <span class="sc">|&gt;</span> </span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Family, log2FoldChange_red) <span class="ot">-&gt;</span> red_dif_fams2</span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a>sand_dif_fams <span class="sc">|&gt;</span> </span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Family <span class="sc">%in%</span> keep_list<span class="sc">$</span>Family) <span class="sc">|&gt;</span> </span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log2FoldChange_sand =</span> log2FoldChange) <span class="sc">|&gt;</span> </span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Family, log2FoldChange_sand) <span class="ot">-&gt;</span> sand_dif_fams2</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(red_dif_fams2, sand_dif_fams2, <span class="at">by =</span> <span class="st">"Family"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 45 × 3
   Family              log2FoldChange_red log2FoldChange_sand
   &lt;chr&gt;                            &lt;dbl&gt;               &lt;dbl&gt;
 1 Methylophilaceae                 -16.2               -6.10
 2 Burkholderiaceae                 -10.5               -5.71
 3 Microscillaceae                  -12.5               -9.38
 4 Flavobacteriaceae                -16.4              -11.3 
 5 env.OPS 17                       -12.9               -9.68
 6 Vicinamibacteraceae              -13.4               -7.09
 7 Saprospiraceae                   -12.9              -10.1 
 8 Chitinophagaceae                 -12.1               -7.80
 9 Hyphomonadaceae                  -12.5               -8.87
10 Rhodocyclaceae                   -15.5               -7.86
# ℹ 35 more rows</code></pre>
</div>
</div>
</section>
<section id="sand-shiner-vs-red-shiner" class="level3" data-number="17.2.4">
<h3 data-number="17.2.4" class="anchored" data-anchor-id="sand-shiner-vs-red-shiner"><span class="header-section-number">17.2.4</span> Sand shiner vs Red shiner</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SAND SHINER VS RED SHINER ####</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phyloseq subset with only Water and Red shiner samples</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>ps_sand_red_fam <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data_FAMILY,</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g1 =</span> <span class="st">"Sand shiner"</span>,</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">g2 =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert phyloseq to DESeq2</span></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">phyloseq_to_deseq2</span>(ps_sand_red_fam, <span class="sc">~</span> commonName)</span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define reference group</span></span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a>diagdds<span class="sc">$</span>commonName <span class="ot">=</span> <span class="fu">relevel</span>(diagdds<span class="sc">$</span>commonName, <span class="at">ref =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the DESeq function</span></span>
<span id="cb291-16"><a href="#cb291-16" aria-hidden="true" tabindex="-1"></a>diagdds <span class="ot">=</span> <span class="fu">DESeq</span>(diagdds)</span>
<span id="cb291-17"><a href="#cb291-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-18"><a href="#cb291-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-19"><a href="#cb291-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results and order by adj p-value.</span></span>
<span id="cb291-20"><a href="#cb291-20" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">results</span>(diagdds, <span class="at">alpha =</span> alpha)</span>
<span id="cb291-21"><a href="#cb291-21" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> res[<span class="fu">order</span>(res<span class="sc">$</span>padj, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb291-22"><a href="#cb291-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
out of 136 with nonzero total read count
adjusted p-value &lt; 0.01
LFC &gt; 0 (up)       : 0, 0%
LFC &lt; 0 (down)     : 3, 2.2%
outliers [1]       : 0, 0%
low counts [2]     : 0, 0%
(mean count &lt; 0)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These appear as ASVs but they truley represent the family that they belong too. I would like to find a way to change this name.</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>keep_order <span class="ot">=</span> <span class="fu">rownames</span>(res[res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha, ])</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a phyloseq object with only the differential ASVs to get taxonomy info</span></span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This phyloseq object will have the count values</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>sand_red_df_fam <span class="ot">=</span> <span class="fu">prune_taxa</span>(keep_order, ps_paired_data_FAMILY)</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make significance tab with taxa information</span></span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> res[<span class="fu">which</span>(res<span class="sc">$</span>padj <span class="sc">&lt;</span> alpha), ]</span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>sigtab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as</span>(sigtab, <span class="st">"data.frame"</span>), <span class="fu">as</span>(sand_red_df_fam<span class="sc">@</span>tax_table[<span class="fu">rownames</span>(sigtab), ], <span class="st">"matrix"</span>))</span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display pretty version of significance table.</span></span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a>sigtab <span class="sc">|&gt;</span> </span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Family"</span>, <span class="st">"log2FoldChange"</span>, <span class="st">"padj"</span>)<span class="ot">-&gt;</span> sig_tab_output</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>sig_tab_output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Family log2FoldChange         padj
ASV_307  Ruminococcaceae     -24.986374 5.920088e-14
ASV_852  Eggerthellaceae     -23.673063 9.171799e-13
ASV_311 Lactobacillaceae      -9.098667 1.349228e-03</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(sig_tab_output, <span class="st">"sand_red_fam_deseq.csv"</span>)</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(diagdds, <span class="at">gene =</span> keep_order[x], <span class="at">intgroup=</span><span class="st">"commonName"</span>)</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam3-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot of these resutls</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylum order</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">tapply</span>(sigtab<span class="sc">$</span>log2FoldChange, sigtab<span class="sc">$</span>Family, <span class="cf">function</span>(x) <span class="fu">max</span>(x))</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sort</span>(x, <span class="cn">TRUE</span>)</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>sigtab<span class="sc">$</span>Family <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(sigtab<span class="sc">$</span>Family), <span class="at">levels=</span><span class="fu">names</span>(x))</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sigtab, <span class="fu">aes</span>(<span class="at">x=</span>Family, <span class="at">y=</span>log2FoldChange)) <span class="sc">+</span> </span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sand Shiner vs Red Shiner"</span>,</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Differential Families"</span>)<span class="sc">+</span></span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="sc">-</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>)) <span class="ot">-&gt;</span> sand_red_fam</span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>sand_red_fam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/Deseq_fam3-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sand_red_fam.png", sand_red_fam, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="overview-of-abundant-phyla" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Overview of abundant phyla</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unwanted fish species from the ps_paired_data phyloseobject.size</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>keeps <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Water"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Sand shiner"</span>)</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>ps_paired_data_int <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">%in%</span> keeps, ps_paired_data)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>ps_paired_data_int <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(ps_paired_data_int) <span class="sc">&gt;</span> <span class="dv">0</span>, ps_paired_data_int)</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_paired_data_int)</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand shiner"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Water"</span>))</span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>river <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"elkhorn"</span>, <span class="st">"mloup"</span>, <span class="st">"sloup"</span>))</span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb298-17"><a href="#cb298-17" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">show =</span> <span class="fl">0.001</span>)</span>
<span id="cb298-18"><a href="#cb298-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-19"><a href="#cb298-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb298-20"><a href="#cb298-20" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb298-21"><a href="#cb298-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> <span class="fu">c</span>(<span class="st">"commonName"</span>),</span>
<span id="cb298-22"><a href="#cb298-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">FALSE</span>,</span>
<span id="cb298-23"><a href="#cb298-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>)<span class="sc">+</span> </span>
<span id="cb298-24"><a href="#cb298-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb298-25"><a href="#cb298-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb298-26"><a href="#cb298-26" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb298-27"><a href="#cb298-27" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">"mm"</span>)),</span>
<span id="cb298-28"><a href="#cb298-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="ot">-&gt;</span> rel_abund_phy_all</span>
<span id="cb298-29"><a href="#cb298-29" aria-hidden="true" tabindex="-1"></a>rel_abund_phy_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/phyla_rel_abund1-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/rel_abund_phy_all.png", rel_abund_phy_all, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manually define phyla colors</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>phyla_list <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Proteobacteria"</span>, <span class="st">"Cyanobacteria"</span>, <span class="st">"Firmicutes"</span>, <span class="st">"Actinobacteriota"</span>, <span class="st">"Bacteroidota"</span>, <span class="st">"Planctomycetota"</span>, <span class="st">"Verrucomicrobiota"</span>, <span class="st">"Desulfobacterota"</span>, <span class="st">"Chloroflexi"</span>, <span class="st">"Patescibacteria"</span>)</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>phyla_colors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Patescibacteria"</span> <span class="ot">=</span> <span class="st">"#6a3d9a"</span>, </span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Chloroflexi"</span> <span class="ot">=</span> <span class="st">"#cab2d6"</span>, </span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Desulfobacterota"</span> <span class="ot">=</span> <span class="st">"#ff7f00"</span>, </span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Verrucomicrobiota"</span> <span class="ot">=</span> <span class="st">"#fdbf6f"</span>, </span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Planctomycetota"</span> <span class="ot">=</span> <span class="st">"#e31a1c"</span>, </span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Bacteroidota"</span> <span class="ot">=</span> <span class="st">"#fb9a99"</span>,</span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Actinobacteriota"</span> <span class="ot">=</span> <span class="st">"#33a02c"</span>,</span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Firmicutes"</span> <span class="ot">=</span> <span class="st">"#b2df8a"</span>,</span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Cyanobacteria"</span> <span class="ot">=</span> <span class="st">"#1f78b4"</span>,</span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Proteobacteria"</span> <span class="ot">=</span> <span class="st">"#a6cee3"</span>)</span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a><span class="co"># SLOUP -----------------------------------------------------------------------------------------------</span></span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only sloup river samples (water and fecal)</span></span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a>ps_s_samples <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_paired_data_int, ps_paired_data_int<span class="sc">@</span>sam_data<span class="sc">$</span>river <span class="sc">==</span> <span class="st">"sloup"</span>)</span>
<span id="cb300-19"><a href="#cb300-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-20"><a href="#cb300-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Change Sand shiner to Sand S. and Red Shiner to Red S.</span></span>
<span id="cb300-21"><a href="#cb300-21" aria-hidden="true" tabindex="-1"></a>ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Red shiner"</span>] <span class="ot">=</span> <span class="st">"Red S."</span></span>
<span id="cb300-22"><a href="#cb300-22" aria-hidden="true" tabindex="-1"></a>ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Sand shiner"</span>] <span class="ot">=</span> <span class="st">"Sand S."</span></span>
<span id="cb300-23"><a href="#cb300-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-24"><a href="#cb300-24" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb300-25"><a href="#cb300-25" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_s_samples)</span>
<span id="cb300-26"><a href="#cb300-26" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb300-27"><a href="#cb300-27" aria-hidden="true" tabindex="-1"></a><span class="co"># print(meco_dataset)</span></span>
<span id="cb300-28"><a href="#cb300-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-29"><a href="#cb300-29" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb300-30"><a href="#cb300-30" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand S."</span>, <span class="st">"Red S."</span>, <span class="st">"Water"</span>))</span>
<span id="cb300-31"><a href="#cb300-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-32"><a href="#cb300-32" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb300-33"><a href="#cb300-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-34"><a href="#cb300-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb300-35"><a href="#cb300-35" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">input_taxaname =</span> phyla_list)</span>
<span id="cb300-36"><a href="#cb300-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-37"><a href="#cb300-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb300-38"><a href="#cb300-38" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb300-39"><a href="#cb300-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> phyla_colors,</span>
<span id="cb300-40"><a href="#cb300-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> <span class="st">"commonName"</span>,</span>
<span id="cb300-41"><a href="#cb300-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">FALSE</span>,</span>
<span id="cb300-42"><a href="#cb300-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb300-43"><a href="#cb300-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sloup"</span>) <span class="sc">+</span></span>
<span id="cb300-44"><a href="#cb300-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb300-45"><a href="#cb300-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb300-46"><a href="#cb300-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb300-47"><a href="#cb300-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb300-48"><a href="#cb300-48" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">5</span>,</span>
<span id="cb300-49"><a href="#cb300-49" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb300-50"><a href="#cb300-50" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">r =</span> .<span class="dv">5</span>, </span>
<span id="cb300-51"><a href="#cb300-51" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">l =</span> <span class="dv">2</span>, </span>
<span id="cb300-52"><a href="#cb300-52" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">unit =</span> <span class="st">"pt"</span>)) <span class="ot">-&gt;</span> s_fig</span>
<span id="cb300-53"><a href="#cb300-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-54"><a href="#cb300-54" aria-hidden="true" tabindex="-1"></a><span class="co"># MLOUP ---------------------------------------------------------------------------------</span></span>
<span id="cb300-55"><a href="#cb300-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-56"><a href="#cb300-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only mloup river samples (water and fecal)</span></span>
<span id="cb300-57"><a href="#cb300-57" aria-hidden="true" tabindex="-1"></a>ps_m_samples <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_paired_data_int, ps_paired_data_int<span class="sc">@</span>sam_data<span class="sc">$</span>river <span class="sc">==</span> <span class="st">"mloup"</span>)</span>
<span id="cb300-58"><a href="#cb300-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-59"><a href="#cb300-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Change Sand shiner to Sand S. and Red Shiner to Red S.</span></span>
<span id="cb300-60"><a href="#cb300-60" aria-hidden="true" tabindex="-1"></a>ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Red shiner"</span>] <span class="ot">=</span> <span class="st">"Red S."</span></span>
<span id="cb300-61"><a href="#cb300-61" aria-hidden="true" tabindex="-1"></a>ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Sand shiner"</span>] <span class="ot">=</span> <span class="st">"Sand S."</span></span>
<span id="cb300-62"><a href="#cb300-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-63"><a href="#cb300-63" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb300-64"><a href="#cb300-64" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_m_samples)</span>
<span id="cb300-65"><a href="#cb300-65" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb300-66"><a href="#cb300-66" aria-hidden="true" tabindex="-1"></a><span class="co"># print(meco_dataset)</span></span>
<span id="cb300-67"><a href="#cb300-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-68"><a href="#cb300-68" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb300-69"><a href="#cb300-69" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand S."</span>, <span class="st">"Red S."</span>, <span class="st">"Water"</span>))</span>
<span id="cb300-70"><a href="#cb300-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-71"><a href="#cb300-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb300-72"><a href="#cb300-72" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb300-73"><a href="#cb300-73" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">input_taxaname =</span> phyla_list)</span>
<span id="cb300-74"><a href="#cb300-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-75"><a href="#cb300-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb300-76"><a href="#cb300-76" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb300-77"><a href="#cb300-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> phyla_colors,</span>
<span id="cb300-78"><a href="#cb300-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> <span class="st">"commonName"</span>,</span>
<span id="cb300-79"><a href="#cb300-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">FALSE</span>,</span>
<span id="cb300-80"><a href="#cb300-80" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb300-81"><a href="#cb300-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mloup"</span>) <span class="sc">+</span></span>
<span id="cb300-82"><a href="#cb300-82" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb300-83"><a href="#cb300-83" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb300-84"><a href="#cb300-84" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb300-85"><a href="#cb300-85" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb300-86"><a href="#cb300-86" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">5</span>,</span>
<span id="cb300-87"><a href="#cb300-87" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb300-88"><a href="#cb300-88" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">r =</span> .<span class="dv">5</span>, </span>
<span id="cb300-89"><a href="#cb300-89" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">l =</span> <span class="dv">2</span>, </span>
<span id="cb300-90"><a href="#cb300-90" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">unit =</span> <span class="st">"pt"</span>)) <span class="ot">-&gt;</span> m_fig</span>
<span id="cb300-91"><a href="#cb300-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-92"><a href="#cb300-92" aria-hidden="true" tabindex="-1"></a><span class="co"># ELKHORN -------------------------------------------------------------------------------</span></span>
<span id="cb300-93"><a href="#cb300-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-94"><a href="#cb300-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only elkhorn river samples (water and fecal)</span></span>
<span id="cb300-95"><a href="#cb300-95" aria-hidden="true" tabindex="-1"></a>ps_elk_samples <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_paired_data_int, ps_paired_data_int<span class="sc">@</span>sam_data<span class="sc">$</span>river <span class="sc">==</span> <span class="st">"elkhorn"</span>)</span>
<span id="cb300-96"><a href="#cb300-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-97"><a href="#cb300-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Change Sand shiner to Sand S. and Red Shiner to Red S.</span></span>
<span id="cb300-98"><a href="#cb300-98" aria-hidden="true" tabindex="-1"></a>ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Red shiner"</span>] <span class="ot">=</span> <span class="st">"Red S."</span></span>
<span id="cb300-99"><a href="#cb300-99" aria-hidden="true" tabindex="-1"></a>ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Sand shiner"</span>] <span class="ot">=</span> <span class="st">"Sand S."</span></span>
<span id="cb300-100"><a href="#cb300-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-101"><a href="#cb300-101" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb300-102"><a href="#cb300-102" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_elk_samples)</span>
<span id="cb300-103"><a href="#cb300-103" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb300-104"><a href="#cb300-104" aria-hidden="true" tabindex="-1"></a><span class="co"># print(meco_dataset)</span></span>
<span id="cb300-105"><a href="#cb300-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-106"><a href="#cb300-106" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb300-107"><a href="#cb300-107" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand S."</span>, <span class="st">"Red S."</span>, <span class="st">"Water"</span>))</span>
<span id="cb300-108"><a href="#cb300-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-109"><a href="#cb300-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb300-110"><a href="#cb300-110" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb300-111"><a href="#cb300-111" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">input_taxaname =</span> phyla_list)</span>
<span id="cb300-112"><a href="#cb300-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-113"><a href="#cb300-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb300-114"><a href="#cb300-114" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb300-115"><a href="#cb300-115" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> phyla_colors,</span>
<span id="cb300-116"><a href="#cb300-116" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> <span class="st">"commonName"</span>,</span>
<span id="cb300-117"><a href="#cb300-117" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">FALSE</span>,</span>
<span id="cb300-118"><a href="#cb300-118" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb300-119"><a href="#cb300-119" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elkhorn"</span>) <span class="sc">+</span></span>
<span id="cb300-120"><a href="#cb300-120" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb300-121"><a href="#cb300-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb300-122"><a href="#cb300-122" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb300-123"><a href="#cb300-123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb300-124"><a href="#cb300-124" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">5</span>,</span>
<span id="cb300-125"><a href="#cb300-125" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb300-126"><a href="#cb300-126" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">r =</span> .<span class="dv">5</span>, </span>
<span id="cb300-127"><a href="#cb300-127" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">l =</span> <span class="dv">2</span>, </span>
<span id="cb300-128"><a href="#cb300-128" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">unit =</span> <span class="st">"pt"</span>)) <span class="ot">-&gt;</span> elk_fig</span>
<span id="cb300-129"><a href="#cb300-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-130"><a href="#cb300-130" aria-hidden="true" tabindex="-1"></a><span class="co"># COMBINE INTO ONE FIGURE ----------------------------------------------------------</span></span>
<span id="cb300-131"><a href="#cb300-131" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(elk_fig, m_fig, s_fig,</span>
<span id="cb300-132"><a href="#cb300-132" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol=</span><span class="dv">3</span>, </span>
<span id="cb300-133"><a href="#cb300-133" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow=</span><span class="dv">1</span>, </span>
<span id="cb300-134"><a href="#cb300-134" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb300-135"><a href="#cb300-135" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend=</span><span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/phy_rel_abund2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manually define phyla colors</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>phyla_list <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Proteobacteria"</span>, <span class="st">"Cyanobacteria"</span>, <span class="st">"Firmicutes"</span>, <span class="st">"Actinobacteriota"</span>, <span class="st">"Bacteroidota"</span>, <span class="st">"Planctomycetota"</span>, <span class="st">"Verrucomicrobiota"</span>, <span class="st">"Desulfobacterota"</span>, <span class="st">"Chloroflexi"</span>, <span class="st">"Patescibacteria"</span>)</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>phyla_colors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Patescibacteria"</span> <span class="ot">=</span> <span class="st">"#6a3d9a"</span>, </span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Chloroflexi"</span> <span class="ot">=</span> <span class="st">"#cab2d6"</span>, </span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Desulfobacterota"</span> <span class="ot">=</span> <span class="st">"#ff7f00"</span>, </span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Verrucomicrobiota"</span> <span class="ot">=</span> <span class="st">"#fdbf6f"</span>, </span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Planctomycetota"</span> <span class="ot">=</span> <span class="st">"#e31a1c"</span>, </span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Bacteroidota"</span> <span class="ot">=</span> <span class="st">"#fb9a99"</span>,</span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Actinobacteriota"</span> <span class="ot">=</span> <span class="st">"#33a02c"</span>,</span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Firmicutes"</span> <span class="ot">=</span> <span class="st">"#b2df8a"</span>,</span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Cyanobacteria"</span> <span class="ot">=</span> <span class="st">"#1f78b4"</span>,</span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Proteobacteria"</span> <span class="ot">=</span> <span class="st">"#a6cee3"</span>)</span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a><span class="co"># SLOUP -----------------------------------------------------------------------------------------------</span></span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only sloup river samples (water and fecal)</span></span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a>ps_s_samples <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_paired_data_int, ps_paired_data_int<span class="sc">@</span>sam_data<span class="sc">$</span>river <span class="sc">==</span> <span class="st">"sloup"</span>)</span>
<span id="cb301-19"><a href="#cb301-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-20"><a href="#cb301-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Change Sand shiner to Sand S. and Red Shiner to Red S.</span></span>
<span id="cb301-21"><a href="#cb301-21" aria-hidden="true" tabindex="-1"></a>ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Red shiner"</span>] <span class="ot">=</span> <span class="st">"Red S."</span></span>
<span id="cb301-22"><a href="#cb301-22" aria-hidden="true" tabindex="-1"></a>ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_s_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Sand shiner"</span>] <span class="ot">=</span> <span class="st">"Sand S."</span></span>
<span id="cb301-23"><a href="#cb301-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-24"><a href="#cb301-24" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb301-25"><a href="#cb301-25" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_s_samples)</span>
<span id="cb301-26"><a href="#cb301-26" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb301-27"><a href="#cb301-27" aria-hidden="true" tabindex="-1"></a><span class="co"># print(meco_dataset)</span></span>
<span id="cb301-28"><a href="#cb301-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-29"><a href="#cb301-29" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb301-30"><a href="#cb301-30" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand S."</span>, <span class="st">"Red S."</span>, <span class="st">"Water"</span>))</span>
<span id="cb301-31"><a href="#cb301-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-32"><a href="#cb301-32" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb301-33"><a href="#cb301-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-34"><a href="#cb301-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb301-35"><a href="#cb301-35" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">input_taxaname =</span> phyla_list, <span class="at">groupmean =</span> <span class="st">"commonName"</span>)</span>
<span id="cb301-36"><a href="#cb301-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-37"><a href="#cb301-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb301-38"><a href="#cb301-38" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb301-39"><a href="#cb301-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> phyla_colors,</span>
<span id="cb301-40"><a href="#cb301-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-41"><a href="#cb301-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb301-42"><a href="#cb301-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sloup"</span>) <span class="sc">+</span></span>
<span id="cb301-43"><a href="#cb301-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb301-44"><a href="#cb301-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb301-45"><a href="#cb301-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb301-46"><a href="#cb301-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb301-47"><a href="#cb301-47" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">5</span>,</span>
<span id="cb301-48"><a href="#cb301-48" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb301-49"><a href="#cb301-49" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">r =</span> .<span class="dv">5</span>, </span>
<span id="cb301-50"><a href="#cb301-50" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">l =</span> <span class="dv">2</span>, </span>
<span id="cb301-51"><a href="#cb301-51" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">unit =</span> <span class="st">"pt"</span>)) <span class="ot">-&gt;</span> s_fig</span>
<span id="cb301-52"><a href="#cb301-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-53"><a href="#cb301-53" aria-hidden="true" tabindex="-1"></a><span class="co"># MLOUP ---------------------------------------------------------------------------------</span></span>
<span id="cb301-54"><a href="#cb301-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-55"><a href="#cb301-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only mloup river samples (water and fecal)</span></span>
<span id="cb301-56"><a href="#cb301-56" aria-hidden="true" tabindex="-1"></a>ps_m_samples <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_paired_data_int, ps_paired_data_int<span class="sc">@</span>sam_data<span class="sc">$</span>river <span class="sc">==</span> <span class="st">"mloup"</span>)</span>
<span id="cb301-57"><a href="#cb301-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-58"><a href="#cb301-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Change Sand shiner to Sand S. and Red Shiner to Red S.</span></span>
<span id="cb301-59"><a href="#cb301-59" aria-hidden="true" tabindex="-1"></a>ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Red shiner"</span>] <span class="ot">=</span> <span class="st">"Red S."</span></span>
<span id="cb301-60"><a href="#cb301-60" aria-hidden="true" tabindex="-1"></a>ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_m_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Sand shiner"</span>] <span class="ot">=</span> <span class="st">"Sand S."</span></span>
<span id="cb301-61"><a href="#cb301-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-62"><a href="#cb301-62" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb301-63"><a href="#cb301-63" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_m_samples)</span>
<span id="cb301-64"><a href="#cb301-64" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb301-65"><a href="#cb301-65" aria-hidden="true" tabindex="-1"></a><span class="co"># print(meco_dataset)</span></span>
<span id="cb301-66"><a href="#cb301-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-67"><a href="#cb301-67" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb301-68"><a href="#cb301-68" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand S."</span>, <span class="st">"Red S."</span>, <span class="st">"Water"</span>))</span>
<span id="cb301-69"><a href="#cb301-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-70"><a href="#cb301-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb301-71"><a href="#cb301-71" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb301-72"><a href="#cb301-72" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">input_taxaname =</span> phyla_list, <span class="at">groupmean =</span> <span class="st">"commonName"</span>)</span>
<span id="cb301-73"><a href="#cb301-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-74"><a href="#cb301-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb301-75"><a href="#cb301-75" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb301-76"><a href="#cb301-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> phyla_colors,</span>
<span id="cb301-77"><a href="#cb301-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-78"><a href="#cb301-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb301-79"><a href="#cb301-79" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mloup"</span>) <span class="sc">+</span></span>
<span id="cb301-80"><a href="#cb301-80" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb301-81"><a href="#cb301-81" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb301-82"><a href="#cb301-82" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb301-83"><a href="#cb301-83" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb301-84"><a href="#cb301-84" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">5</span>,</span>
<span id="cb301-85"><a href="#cb301-85" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb301-86"><a href="#cb301-86" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">r =</span> .<span class="dv">5</span>, </span>
<span id="cb301-87"><a href="#cb301-87" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">l =</span> <span class="dv">2</span>, </span>
<span id="cb301-88"><a href="#cb301-88" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">unit =</span> <span class="st">"pt"</span>)) <span class="ot">-&gt;</span> m_fig</span>
<span id="cb301-89"><a href="#cb301-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-90"><a href="#cb301-90" aria-hidden="true" tabindex="-1"></a><span class="co"># ELKHORN -------------------------------------------------------------------------------</span></span>
<span id="cb301-91"><a href="#cb301-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-92"><a href="#cb301-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only elkhorn river samples (water and fecal)</span></span>
<span id="cb301-93"><a href="#cb301-93" aria-hidden="true" tabindex="-1"></a>ps_elk_samples <span class="ot">=</span> <span class="fu">subset_samples</span>(ps_paired_data_int, ps_paired_data_int<span class="sc">@</span>sam_data<span class="sc">$</span>river <span class="sc">==</span> <span class="st">"elkhorn"</span>)</span>
<span id="cb301-94"><a href="#cb301-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-95"><a href="#cb301-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Change Sand shiner to Sand S. and Red Shiner to Red S.</span></span>
<span id="cb301-96"><a href="#cb301-96" aria-hidden="true" tabindex="-1"></a>ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Red shiner"</span>] <span class="ot">=</span> <span class="st">"Red S."</span></span>
<span id="cb301-97"><a href="#cb301-97" aria-hidden="true" tabindex="-1"></a>ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName[ps_elk_samples<span class="sc">@</span>sam_data<span class="sc">$</span>commonName <span class="sc">==</span> <span class="st">"Sand shiner"</span>] <span class="ot">=</span> <span class="st">"Sand S."</span></span>
<span id="cb301-98"><a href="#cb301-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-99"><a href="#cb301-99" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb301-100"><a href="#cb301-100" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_elk_samples)</span>
<span id="cb301-101"><a href="#cb301-101" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb301-102"><a href="#cb301-102" aria-hidden="true" tabindex="-1"></a><span class="co"># print(meco_dataset)</span></span>
<span id="cb301-103"><a href="#cb301-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-104"><a href="#cb301-104" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb301-105"><a href="#cb301-105" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand S."</span>, <span class="st">"Red S."</span>, <span class="st">"Water"</span>))</span>
<span id="cb301-106"><a href="#cb301-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-107"><a href="#cb301-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb301-108"><a href="#cb301-108" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span>
<span id="cb301-109"><a href="#cb301-109" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>, <span class="at">input_taxaname =</span> phyla_list, <span class="at">groupmean =</span> <span class="st">"commonName"</span>)</span>
<span id="cb301-110"><a href="#cb301-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-111"><a href="#cb301-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb301-112"><a href="#cb301-112" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb301-113"><a href="#cb301-113" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> phyla_colors,</span>
<span id="cb301-114"><a href="#cb301-114" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-115"><a href="#cb301-115" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb301-116"><a href="#cb301-116" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elkhorn"</span>) <span class="sc">+</span></span>
<span id="cb301-117"><a href="#cb301-117" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb301-118"><a href="#cb301-118" aria-hidden="true" tabindex="-1"></a>                  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb301-119"><a href="#cb301-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb301-120"><a href="#cb301-120" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb301-121"><a href="#cb301-121" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> .<span class="dv">5</span>,</span>
<span id="cb301-122"><a href="#cb301-122" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">b =</span> <span class="dv">0</span>, </span>
<span id="cb301-123"><a href="#cb301-123" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">r =</span> .<span class="dv">5</span>, </span>
<span id="cb301-124"><a href="#cb301-124" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">l =</span> <span class="dv">2</span>, </span>
<span id="cb301-125"><a href="#cb301-125" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">unit =</span> <span class="st">"pt"</span>)) <span class="ot">-&gt;</span> elk_fig</span>
<span id="cb301-126"><a href="#cb301-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-127"><a href="#cb301-127" aria-hidden="true" tabindex="-1"></a><span class="co"># COMBINE INTO ONE FIGURE ----------------------------------------------------------</span></span>
<span id="cb301-128"><a href="#cb301-128" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(s_fig, m_fig, elk_fig, </span>
<span id="cb301-129"><a href="#cb301-129" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol=</span><span class="dv">3</span>, </span>
<span id="cb301-130"><a href="#cb301-130" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow=</span><span class="dv">1</span>, </span>
<span id="cb301-131"><a href="#cb301-131" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-132"><a href="#cb301-132" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend=</span><span class="st">"bottom"</span>) <span class="ot">-&gt;</span> rel_abund_phy_means</span>
<span id="cb301-133"><a href="#cb301-133" aria-hidden="true" tabindex="-1"></a>rel_abund_phy_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/phy_rel_abund3-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/rel_abund_phy_means.png", rel_abund_phy_means, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="overview-of-abundant-families" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Overview of abundant families</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># begin using microbiota process</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>meco_dataset <span class="ot">&lt;-</span> <span class="fu">phyloseq2meco</span>(ps_paired_data_int)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define factors to be used in analysis</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>commonName <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sand shiner"</span>, <span class="st">"Red shiner"</span>, <span class="st">"Water"</span>))</span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span>sample_table<span class="sc">$</span>river <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"elkhorn"</span>, <span class="st">"mloup"</span>, <span class="st">"sloup"</span>))</span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>meco_dataset<span class="sc">$</span><span class="fu">cal_abund</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>The result is stored in object$taxa_abund ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trans_abund object</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> trans_abund<span class="sc">$</span><span class="fu">new</span>(meco_dataset, <span class="at">taxrank =</span> <span class="st">"Family"</span>, <span class="at">ntaxa =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>The transformed abundance data is stored in object$data_abund ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>shades <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#a6cee3"</span>,</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#1f78b4"</span>,</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#074c70"</span>,</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#b2df8a"</span>,</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#33a02c"</span>,</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#295205"</span>,</span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#fb9a99"</span>,</span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#e31a1c"</span>,</span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#5e0e0d"</span>,</span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#fdbf6f"</span>,</span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#f29c07"</span>,</span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#ff7f00"</span>,</span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#cab2d6"</span>,</span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#6a3d9a"</span>,</span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#411159"</span>,</span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#ffff99"</span>,</span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#fafa07"</span>,</span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#b15928"</span>,</span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a>           <span class="st">"#572409"</span>)</span>
<span id="cb307-20"><a href="#cb307-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-21"><a href="#cb307-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Bar plot</span></span>
<span id="cb307-22"><a href="#cb307-22" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot_bar</span>(<span class="at">others_color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb307-23"><a href="#cb307-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> <span class="fu">c</span>(<span class="st">"commonName"</span>),</span>
<span id="cb307-24"><a href="#cb307-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">xtext_keep =</span> <span class="cn">FALSE</span>,</span>
<span id="cb307-25"><a href="#cb307-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">color_values =</span> shades,</span>
<span id="cb307-26"><a href="#cb307-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend_text_italic =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb307-27"><a href="#cb307-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb307-28"><a href="#cb307-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb307-29"><a href="#cb307-29" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb307-30"><a href="#cb307-30" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">"mm"</span>)),</span>
<span id="cb307-31"><a href="#cb307-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb307-32"><a href="#cb307-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="ot">-&gt;</span> rel_abund_fam_all</span>
<span id="cb307-33"><a href="#cb307-33" aria-hidden="true" tabindex="-1"></a>rel_abund_fam_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/fam_rel_abund-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/rel_abund_fam_all.png", rel_abund_fam_all, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="core-microbiomes" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Core Microbiomes</h1>
<section id="taxonomic-resolution" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="taxonomic-resolution"><span class="header-section-number">20.1</span> Taxonomic resolution</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract taxa tables from phyloseq objects</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>taxa_tab <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm<span class="sc">@</span>tax_table)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine taxonomic resolution for water and fish fecal samples</span></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>tax_reso <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">phylum =</span> (<span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(taxa_tab<span class="sc">$</span>Phylum))) <span class="sc">/</span> <span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>],</span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">class =</span> (<span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(taxa_tab<span class="sc">$</span>Class))) <span class="sc">/</span> <span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>],</span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> (<span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(taxa_tab<span class="sc">$</span>Order))) <span class="sc">/</span> <span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>],</span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> (<span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(taxa_tab<span class="sc">$</span>Family))) <span class="sc">/</span> <span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>],</span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">genus =</span> (<span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(taxa_tab<span class="sc">$</span>Genus))) <span class="sc">/</span> <span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>],</span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">species =</span> (<span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(taxa_tab<span class="sc">$</span>Species))) <span class="sc">/</span> <span class="fu">dim</span>(taxa_tab)[<span class="dv">1</span>])</span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a>tax_reso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  phylum class order family genus species
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1  0.953 0.952 0.925  0.766 0.581   0.115</code></pre>
</div>
</div>
</section>
<section id="core-definition-and-function-writing" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="core-definition-and-function-writing"><span class="header-section-number">20.2</span> Core Definition and Function writing</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the % samples an ASV must be present in to be considered part of the core microbiome</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">=</span> <span class="fl">0.80</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This function finds the core microbiome of a group.</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ps = a phyloseq object containing the data. Ensure that abundances are count data not relative proportion</span></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># variable = a categorical variable in the phyloseq sample data.</span></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># g = the level of variable that you wish to find the core microbiome of.</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># perc = the percent of samples that a ASV must be present in to be considered part of the core Microbiome.</span></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a>find_core <span class="ot">=</span> <span class="cf">function</span>(ps, variable, g, perc){</span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data subset with only group samples and ASVs that are present in those samples</span></span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">prune_samples</span>(ps<span class="sc">@</span>sam_data[[variable]] <span class="sc">==</span> g, ps)</span>
<span id="cb312-11"><a href="#cb312-11" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">speciesSums</span>(data) <span class="sc">&gt;</span> <span class="dv">0</span>, data)</span>
<span id="cb312-12"><a href="#cb312-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-13"><a href="#cb312-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find core</span></span>
<span id="cb312-14"><a href="#cb312-14" aria-hidden="true" tabindex="-1"></a>  core_microbiome <span class="ot">=</span> <span class="fu">apply</span>(<span class="at">X =</span> <span class="fu">otu_table</span>(data),</span>
<span id="cb312-15"><a href="#cb312-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">MARGIN =</span> <span class="fu">ifelse</span>(<span class="fu">taxa_are_rows</span>(data), <span class="at">yes =</span> <span class="dv">1</span>, <span class="at">no =</span> <span class="dv">2</span>),</span>
<span id="cb312-16"><a href="#cb312-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">FUN =</span> <span class="cf">function</span>(x){<span class="fu">sum</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)})</span>
<span id="cb312-17"><a href="#cb312-17" aria-hidden="true" tabindex="-1"></a>  core_microbiome <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Prevalence=</span>core_microbiome, <span class="at">TotalAbundance=</span><span class="fu">taxa_sums</span>(data))</span>
<span id="cb312-18"><a href="#cb312-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-19"><a href="#cb312-19" aria-hidden="true" tabindex="-1"></a>  sample_minimum <span class="ot">=</span> <span class="fu">dim</span>(data<span class="sc">@</span>otu_table)[<span class="dv">2</span>] <span class="sc">*</span> perc</span>
<span id="cb312-20"><a href="#cb312-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-21"><a href="#cb312-21" aria-hidden="true" tabindex="-1"></a>  core <span class="ot">&lt;-</span> <span class="fu">rownames</span>(core_microbiome)[core_microbiome<span class="sc">$</span>Prevalence <span class="sc">&gt;=</span> sample_minimum]</span>
<span id="cb312-22"><a href="#cb312-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-23"><a href="#cb312-23" aria-hidden="true" tabindex="-1"></a>  core1 <span class="ot">&lt;-</span> <span class="fu">prune_taxa</span>(core, data)</span>
<span id="cb312-24"><a href="#cb312-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-25"><a href="#cb312-25" aria-hidden="true" tabindex="-1"></a>  coverage <span class="ot">=</span> (<span class="fu">sum</span>(<span class="fu">otu_table</span>(core1)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">otu_table</span>(data))) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb312-26"><a href="#cb312-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb312-27"><a href="#cb312-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compile function output</span></span>
<span id="cb312-28"><a href="#cb312-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">core1 =</span> core1,</span>
<span id="cb312-29"><a href="#cb312-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">coverage =</span> coverage,</span>
<span id="cb312-30"><a href="#cb312-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">prev_abund =</span> core_microbiome))</span>
<span id="cb312-31"><a href="#cb312-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb312-32"><a href="#cb312-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-33"><a href="#cb312-33" aria-hidden="true" tabindex="-1"></a><span class="co"># test = find_core(ps = ps_paired_data, variable = "commonName", g = "Water", perc = percent)</span></span>
<span id="cb312-34"><a href="#cb312-34" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb312-35"><a href="#cb312-35" aria-hidden="true" tabindex="-1"></a><span class="co"># test$core1@tax_table[ , c("Phylum", "Genus", "Species")]</span></span>
<span id="cb312-36"><a href="#cb312-36" aria-hidden="true" tabindex="-1"></a><span class="co"># test$coverage</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="water-core" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="water-core"><span class="header-section-number">20.3</span> Water Core</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>core_water <span class="ot">=</span> <span class="fu">find_core</span>(<span class="at">ps =</span> ps_paired_data, <span class="at">variable =</span> <span class="st">"commonName"</span>, <span class="at">g =</span> <span class="st">"Water"</span>, <span class="at">perc =</span> percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'speciesSums' is deprecated.
Use 'taxa_sums' instead.
See help("Deprecated") and help("phyloseq-deprecated").</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>core_water<span class="sc">$</span>core1<span class="sc">@</span>tax_table[ , <span class="fu">c</span>(<span class="st">"Phylum"</span>, <span class="st">"Genus"</span>, <span class="st">"Species"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [104 taxa by 3 taxonomic ranks]:
        Phylum              Genus                       Species          
ASV_107 "Actinobacteriota"  "CL500-29 marine group"     NA               
ASV_157 "Actinobacteriota"  "CL500-29 marine group"     NA               
ASV_5   "Actinobacteriota"  NA                          NA               
ASV_31  "Actinobacteriota"  "Candidatus Planktophila"   NA               
ASV_152 "Actinobacteriota"  "Candidatus Planktophila"   NA               
ASV_214 "Actinobacteriota"  "hgcI clade"                NA               
ASV_12  "Actinobacteriota"  "hgcI clade"                NA               
ASV_85  "Actinobacteriota"  NA                          NA               
ASV_40  "Actinobacteriota"  "hgcI clade"                NA               
ASV_183 "Verrucomicrobiota" NA                          NA               
ASV_824 "Acidobacteriota"   NA                          NA               
ASV_387 "Proteobacteria"    NA                          NA               
ASV_4   "Proteobacteria"    "Aeromonas"                 "salmonicida"    
ASV_726 "Proteobacteria"    NA                          NA               
ASV_82  "Proteobacteria"    NA                          NA               
ASV_122 "Proteobacteria"    NA                          NA               
ASV_997 "Proteobacteria"    NA                          NA               
ASV_184 "Proteobacteria"    NA                          NA               
ASV_705 "Proteobacteria"    NA                          NA               
ASV_491 "Proteobacteria"    "Ahniella"                  "affigens"       
ASV_215 "Proteobacteria"    "Arenimonas"                NA               
ASV_41  "Proteobacteria"    "Arenimonas"                NA               
ASV_2   "Proteobacteria"    NA                          NA               
ASV_9   "Proteobacteria"    NA                          NA               
ASV_42  "Proteobacteria"    NA                          NA               
ASV_94  "Proteobacteria"    NA                          NA               
ASV_44  "Proteobacteria"    "Ramlibacter"               NA               
ASV_261 "Proteobacteria"    NA                          NA               
ASV_11  "Proteobacteria"    "Acidovorax"                "facilis"        
ASV_64  "Proteobacteria"    "Acidovorax"                "carolinensis"   
ASV_93  "Proteobacteria"    "Limnohabitans"             NA               
ASV_20  "Proteobacteria"    "Limnohabitans"             NA               
ASV_461 "Proteobacteria"    "Chitinibacter"             NA               
ASV_327 "Proteobacteria"    "Methylotenera"             NA               
ASV_71  "Proteobacteria"    "Methylotenera"             NA               
ASV_188 "Proteobacteria"    "Methylotenera"             NA               
ASV_58  "Proteobacteria"    "Candidatus Methylopumilus" NA               
ASV_288 "Proteobacteria"    "Dechloromonas"             NA               
ASV_172 "Proteobacteria"    NA                          NA               
ASV_54  "Proteobacteria"    "Polynucleobacter"          NA               
ASV_3   "Proteobacteria"    "Polynucleobacter"          "asymbioticus"   
ASV_32  "Proteobacteria"    "Polynucleobacter"          "cosmopolitanus" 
ASV_102 "Proteobacteria"    "C39"                       NA               
ASV_282 "Myxococcota"       NA                          NA               
ASV_414 "Chloroflexi"       NA                          NA               
ASV_504 "Proteobacteria"    "Roseomonas"                "terricola"      
ASV_178 "Proteobacteria"    NA                          NA               
ASV_39  "Proteobacteria"    NA                          NA               
ASV_14  "Proteobacteria"    NA                          NA               
ASV_377 "Proteobacteria"    "Altererythrobacter"        NA               
ASV_73  "Proteobacteria"    "Novosphingobium"           NA               
ASV_88  "Proteobacteria"    "Novosphingobium"           "aromaticivorans"
ASV_263 "Proteobacteria"    "Novosphingobium"           NA               
ASV_53  "Proteobacteria"    "Sphingorhabdus"            NA               
ASV_173 "Proteobacteria"    "Sphingorhabdus"            NA               
ASV_156 "Proteobacteria"    "Rhizorhapis"               NA               
ASV_22  "Bacteroidota"      "Flavobacterium"            "saccharophilum" 
ASV_65  "Bacteroidota"      "Flavobacterium"            "cheonhonense"   
ASV_47  "Bacteroidota"      "Flavobacterium"            NA               
ASV_29  "Cyanobacteria"     "Cyanobium PCC-6307"        NA               
ASV_60  "Cyanobacteria"     NA                          NA               
ASV_220 "Cyanobacteria"     NA                          NA               
ASV_312 "Cyanobacteria"     NA                          NA               
ASV_442 "Cyanobacteria"     NA                          NA               
ASV_81  "Cyanobacteria"     NA                          NA               
ASV_70  "Cyanobacteria"     NA                          NA               
ASV_18  "Cyanobacteria"     NA                          NA               
ASV_127 "Cyanobacteria"     NA                          NA               
ASV_388 "Proteobacteria"    "Reyranella"                NA               
ASV_421 "Acidobacteriota"   "Blastocatella"             NA               
ASV_176 "Actinobacteriota"  "MWH-Ta3"                   NA               
ASV_84  "Actinobacteriota"  "Aurantimicrobium"          NA               
ASV_103 "Actinobacteriota"  "Rhodoluna"                 NA               
ASV_72  "Actinobacteriota"  NA                          NA               
ASV_116 "Actinobacteriota"  "Rhodoluna"                 NA               
ASV_125 "Actinobacteriota"  "Candidatus Planktoluna"    NA               
ASV_112 "Actinobacteriota"  "Candidatus Aquiluna"       NA               
ASV_66  "Actinobacteriota"  NA                          NA               
ASV_142 "Actinobacteriota"  "Longivirga"                NA               
ASV_113 "Cyanobacteria"     "Pseudanabaena PCC-7429"    NA               
ASV_158 "Verrucomicrobiota" "Prosthecobacter"           NA               
ASV_343 "Verrucomicrobiota" NA                          NA               
ASV_531 "Verrucomicrobiota" "Luteolibacter"             NA               
ASV_59  "Verrucomicrobiota" "Luteolibacter"             NA               
ASV_436 "Acidobacteriota"   NA                          NA               
ASV_360 "Acidobacteriota"   NA                          NA               
ASV_598 "Bdellovibrionota"  "OM27 clade"                NA               
ASV_419 "Desulfobacterota"  NA                          NA               
ASV_51  "Fusobacteriota"    "Cetobacterium"             NA               
ASV_378 "Bacteroidota"      "OLB12"                     NA               
ASV_344 "Bacteroidota"      NA                          NA               
ASV_96  "Bacteroidota"      "Fluviicola"                NA               
ASV_286 "Bacteroidota"      NA                          NA               
ASV_333 "Bacteroidota"      NA                          NA               
ASV_19  "Bacteroidota"      "Pseudarcicella"            NA               
ASV_74  "Bacteroidota"      "Candidatus Aquirestis"     NA               
ASV_242 "Bacteroidota"      "Dinghuibacter"             NA               
ASV_316 "Bacteroidota"      "Dinghuibacter"             NA               
ASV_193 "Bacteroidota"      "Dinghuibacter"             NA               
ASV_331 "Bacteroidota"      "Lacibacter"                "cauensis"       
ASV_218 "Bacteroidota"      "Sediminibacterium"         NA               
ASV_46  "Bacteroidota"      "Sediminibacterium"         NA               
ASV_154 "Bacteroidota"      "Sediminibacterium"         NA               
ASV_253 "Bacteroidota"      "Lacihabitans"              NA               </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>core_water<span class="sc">$</span>coverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61.99535</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(core_water<span class="sc">$</span>core1<span class="sc">@</span>tax_table,</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"water_core.csv"</span>,</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(core_water$core1@tax_table, file = "water_core.csv", :
attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap Showing the water core microbiome ASVS across all sample types</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>water_core <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">row.names</span>(core_water<span class="sc">$</span>core1<span class="sc">@</span>otu_table), ps_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'
Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">=</span> <span class="fu">as.data.frame</span>(ps_norm<span class="sc">@</span>sam_data)</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>water_core_otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(water_core<span class="sc">@</span>otu_table)</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water_core_otu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                110      110-10 110-3 110-5 110-6       110-8 110-9         111
ASV_107 0.002632223 0.000000000     0     0     0 0.000000000     0 0.002104964
ASV_157 0.000000000 0.002018648     0     0     0 0.002045633     0 0.001182564
ASV_5   0.032045788 0.000000000     0     0     0 0.000000000     0 0.041555309
ASV_31  0.010498286 0.000000000     0     0     0 0.000000000     0 0.015326033
ASV_152 0.001805828 0.000000000     0     0     0 0.000000000     0 0.001679241
ASV_214 0.002111900 0.000000000     0     0     0 0.000000000     0 0.001537334
        111-1 111-2 111-3 111-4 111-5         113 113-1      113-10 113-4
ASV_107     0     0     0     0     0 0.001472697     0 0.000000000     0
ASV_157     0     0     0     0     0 0.001356431     0 0.005373891     0
ASV_5       0     0     0     0     0 0.044917258     0 0.000000000     0
ASV_31      0     0     0     0     0 0.012285393     0 0.000000000     0
ASV_152     0     0     0     0     0 0.002286556     0 0.000000000     0
ASV_214     0     0     0     0     0 0.002402821     0 0.000000000     0
             113-6       113-7       113-8         114 114-2 114-3       114-5
ASV_107 0.00000000 0.000000000 0.000000000 0.001617931     0     0 0.000000000
ASV_157 0.01032387 0.007668133 0.002926622 0.001420623     0     0 0.001088139
ASV_5   0.00000000 0.000000000 0.000000000 0.051260803     0     0 0.000000000
ASV_31  0.00000000 0.000000000 0.000000000 0.015705773     0     0 0.000000000
ASV_152 0.00000000 0.000000000 0.000000000 0.002091472     0     0 0.000000000
ASV_214 0.00000000 0.000000000 0.000000000 0.001854702     0     0 0.000000000
        114-6         116 116-2       116-3       116-5       116-7      116-8
ASV_107     0 0.000126968     0 0.000000000 0.000000000 0.000000000 0.00000000
ASV_157     0 0.011257830     0 0.002514435 0.007953969 0.002838866 0.00168216
ASV_5       0 0.020484171     0 0.000000000 0.000000000 0.000000000 0.00000000
ASV_31      0 0.010834603     0 0.000000000 0.000000000 0.000000000 0.00000000
ASV_152     0 0.000000000     0 0.000000000 0.000000000 0.000000000 0.00000000
ASV_214     0 0.000000000     0 0.000000000 0.000000000 0.000000000 0.00000000
              116-9         120 120-10 120-4         121 121-1 121-4 121-9
ASV_107 0.000000000 0.001976462      0     0 0.003187759     0     0     0
ASV_157 0.009799411 0.006019226      0     0 0.003460995     0     0     0
ASV_5   0.000000000 0.031982751      0     0 0.054191903     0     0     0
ASV_31  0.000000000 0.008714401      0     0 0.011658090     0     0     0
ASV_152 0.000000000 0.000000000      0     0 0.002049274     0     0     0
ASV_214 0.000000000 0.000000000      0     0 0.001229564     0     0     0
                122 122-5         124 124-5 124-7 124-8 124-9          125
ASV_107 0.002772300     0 0.002685554     0     0     0     0 0.0013189806
ASV_157 0.001686244     0 0.003128228     0     0     0     0 0.0021699358
ASV_5   0.064706050     0 0.049963111     0     0     0     0 0.0301025401
ASV_31  0.016805282     0 0.015611628     0     0     0     0 0.0055099349
ASV_152 0.003715453     0 0.002833112     0     0     0     0 0.0013402544
ASV_214 0.001371860     0 0.001268998     0     0     0     0 0.0005743948
              125-2       125-4 125-5
ASV_107 0.000000000 0.000000000     0
ASV_157 0.002284752 0.001488356     0
ASV_5   0.000000000 0.000000000     0
ASV_31  0.000000000 0.000000000     0
ASV_152 0.000000000 0.000000000     0
ASV_214 0.000000000 0.000000000     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>water_core_otu <span class="sc">|&gt;</span> </span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ASV"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">51</span>,</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sample"</span>,</span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>) <span class="ot">-&gt;</span> intermediate_table</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a>intermediate_table <span class="ot">=</span> <span class="fu">left_join</span>(intermediate_table, meta, <span class="at">by =</span> <span class="fu">join_by</span>(sample <span class="sc">==</span> sampleID))</span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a>intermediate_table <span class="sc">|&gt;</span> </span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_abund =</span> <span class="fu">log</span>(rel_abund, <span class="at">base =</span> <span class="dv">10</span>))<span class="ot">-&gt;</span> water_core_longer</span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(water_core_longer<span class="sc">$</span>rel_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get order of samples to group by sample type</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">|&gt;</span> </span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(commonName) <span class="ot">-&gt;</span> sample_order</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Order asvs based on plot_heatmap order</span></span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>asv_order <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">282</span>, <span class="dv">436</span>, <span class="dv">94</span>, <span class="dv">102</span>, <span class="dv">44</span>, <span class="dv">122</span>, <span class="dv">531</span>, <span class="dv">288</span>, <span class="dv">4</span>, <span class="dv">184</span>, <span class="dv">172</span>, <span class="dv">461</span>, <span class="dv">343</span>, <span class="dv">504</span>, <span class="dv">388</span>, <span class="dv">66</span>, <span class="dv">157</span>, <span class="dv">59</span>, <span class="dv">14</span>, <span class="dv">142</span>, <span class="dv">84</span>, <span class="dv">39</span>, <span class="dv">82</span>, <span class="dv">51</span>, <span class="dv">41</span>, <span class="dv">261</span>, <span class="dv">29</span>, <span class="dv">316</span>, <span class="dv">88</span>, <span class="dv">81</span>, <span class="dv">53</span>, <span class="dv">18</span>, <span class="dv">47</span>, <span class="dv">286</span>, <span class="dv">154</span>, <span class="dv">2</span>, <span class="dv">331</span>, <span class="dv">127</span>, <span class="dv">183</span>, <span class="dv">112</span>, <span class="dv">242</span>, <span class="dv">11</span>, <span class="dv">70</span>, <span class="dv">54</span>, <span class="dv">156</span>, <span class="dv">32</span>, <span class="dv">220</span>, <span class="dv">65</span>, <span class="dv">214</span>, <span class="dv">442</span>, <span class="dv">173</span>, <span class="dv">58</span>, <span class="dv">218</span>, <span class="dv">152</span>, <span class="dv">215</span>, <span class="dv">20</span>, <span class="dv">188</span>, <span class="dv">107</span>, <span class="dv">312</span>, <span class="dv">60</span>, <span class="dv">22</span>, <span class="dv">74</span>, <span class="dv">491</span>, <span class="dv">72</span>, <span class="dv">5</span>, <span class="dv">64</span>, <span class="dv">42</span>, <span class="dv">253</span>, <span class="dv">344</span>, <span class="dv">116</span>, <span class="dv">31</span>, <span class="dv">96</span>, <span class="dv">3</span>, <span class="dv">360</span>, <span class="dv">421</span>, <span class="dv">378</span>, <span class="dv">103</span>, <span class="dv">387</span>, <span class="dv">193</span>, <span class="dv">333</span>, <span class="dv">12</span>, <span class="dv">176</span>, <span class="dv">40</span>, <span class="dv">263</span>, <span class="dv">113</span>, <span class="dv">19</span>, <span class="dv">9</span>, <span class="dv">73</span>, <span class="dv">178</span>, <span class="dv">598</span>, <span class="dv">46</span>, <span class="dv">705</span>, <span class="dv">419</span>, <span class="dv">93</span>, <span class="dv">158</span>, <span class="dv">71</span>, <span class="dv">125</span>, <span class="dv">414</span>, <span class="dv">85</span>, <span class="dv">377</span>, <span class="dv">997</span>, <span class="dv">824</span>, <span class="dv">327</span>, <span class="dv">726</span>)</span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>asv_order <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"ASV_"</span>, <span class="fu">as.character</span>(asv_order))</span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>asv_order_df <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> water_core_longer)<span class="sc">+</span></span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(sample, <span class="at">level =</span> sample_order<span class="sc">$</span>sampleID),</span>
<span id="cb331-14"><a href="#cb331-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> asv_order),</span>
<span id="cb331-15"><a href="#cb331-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb331-16"><a href="#cb331-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb331-17"><a href="#cb331-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb331-18"><a href="#cb331-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb331-19"><a href="#cb331-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> sample_order<span class="sc">$</span>commonName)<span class="sc">+</span></span>
<span id="cb331-20"><a href="#cb331-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb331-21"><a href="#cb331-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb331-22"><a href="#cb331-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>)) <span class="ot">-&gt;</span> water_core_heatmap</span>
<span id="cb331-23"><a href="#cb331-23" aria-hidden="true" tabindex="-1"></a>water_core_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/core_water-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/water_core_heatmap.png", water_core_heatmap, width = 7, height = 7, units = "in", dpi = 300)</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_heatmap</span>(water_core, </span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.label =</span> <span class="st">"commonName"</span>,</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.order =</span> <span class="st">"commonName"</span>)<span class="sc">+</span></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Relative</span><span class="sc">\n</span><span class="st">Abundance"</span>) <span class="ot">-&gt;</span> p</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>scales<span class="sc">$</span>scales[[<span class="dv">1</span>]]<span class="sc">$</span>name <span class="ot">=</span> <span class="st">"Sample Type"</span></span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in discrete y-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/core_water-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/plot_heatmap.png", p, dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water_core_longer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 32
  ASV   sample rel_abund   X.4   X.3   X.2   X.1 X     miseqID sample_or_control
  &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;            
1 ASV_… 110        -2.58   129   280   280   938 A42   A42     sample           
2 ASV_… 110-10   -Inf        9    20    20   206 S202  S202    sample           
3 ASV_… 110-3    -Inf        3    14    14   197 S195  S195    sample           
4 ASV_… 110-5    -Inf        4    15    15   198 S196  S196    sample           
5 ASV_… 110-6    -Inf        6    17    17   200 S198  S198    sample           
6 ASV_… 110-8    -Inf        7    18    18   204 S200  S200    sample           
# ℹ 22 more variables: sampleType &lt;chr&gt;, station &lt;chr&gt;, river &lt;chr&gt;,
#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, speciesCode &lt;int&gt;, commonName &lt;chr&gt;,
#   fieldDate &lt;chr&gt;, ammonia &lt;dbl&gt;, turbidity &lt;dbl&gt;, do &lt;dbl&gt;,
#   temperature &lt;dbl&gt;, no3 &lt;dbl&gt;, totalNitrogen &lt;dbl&gt;, totalPhosphorus &lt;dbl&gt;,
#   phosphatePhosphorus &lt;lgl&gt;, kjedahlNitrogen &lt;lgl&gt;, pH &lt;lgl&gt;,
#   suspendedSolids &lt;lgl&gt;, ecoli &lt;lgl&gt;, specificConductance &lt;lgl&gt;, is.neg &lt;lgl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># core_water$core1@tax_table = table to associate asv_x with taxonomy info</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>water_taxtab <span class="ot">=</span> <span class="fu">as.data.frame</span>(core_water<span class="sc">$</span>core1<span class="sc">@</span>tax_table)</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>water_taxtab<span class="sc">$</span>ASV <span class="ot">=</span> <span class="fu">row.names</span>(water_taxtab)</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a>asv_order_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> asv_order)</span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>sorted_tax_tab <span class="ot">=</span> <span class="fu">left_join</span>(<span class="at">x =</span> asv_order_df,</span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> water_taxtab,</span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="st">"ASV"</span>)</span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sorted_tax_tab, <span class="at">file =</span> <span class="st">"sorted_for_fig_water_core_tax.csv"</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(sorted_tax_tab, file =
"sorted_for_fig_water_core_tax.csv", : attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> water_core_longer)<span class="sc">+</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample,</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> asv_order),</span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> sorted_tax_tab<span class="sc">$</span>Family)<span class="sc">+</span></span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> commonName,</span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>),</span>
<span id="cb339-15"><a href="#cb339-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(.<span class="dv">1</span>,<span class="st">"lines"</span>)) <span class="ot">-&gt;</span> water_core_heatmap</span>
<span id="cb339-16"><a href="#cb339-16" aria-hidden="true" tabindex="-1"></a>water_core_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/test-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/water_core_heatmap.png", water_core_heatmap, width = 11, height = 9, units = "in", dpi = 300)</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a version with ASVs sorted by phylum</span></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>water_taxtab <span class="sc">|&gt;</span> </span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Phylum) <span class="ot">-&gt;</span> phy_sorted_tax</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(phy_sorted_tax,</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"phy_sorted_water_core.csv"</span>,</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(phy_sorted_tax, file = "phy_sorted_water_core.csv", :
attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> water_core_longer)<span class="sc">+</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample,</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> phy_sorted_tax<span class="sc">$</span>ASV),</span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> phy_sorted_tax<span class="sc">$</span>Family)<span class="sc">+</span></span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> commonName,</span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb342-13"><a href="#cb342-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb342-14"><a href="#cb342-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>),</span>
<span id="cb342-15"><a href="#cb342-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(.<span class="dv">1</span>,<span class="st">"lines"</span>)) <span class="ot">-&gt;</span> water_core_heatmap_phy_sort</span>
<span id="cb342-16"><a href="#cb342-16" aria-hidden="true" tabindex="-1"></a>water_core_heatmap_phy_sort</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/test-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/water_core_heatmap_phy_sort.png", water_core_heatmap_phy_sort, width = 11, height = 9, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="red-shiner-core" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="red-shiner-core"><span class="header-section-number">20.4</span> Red Shiner Core</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>core_red <span class="ot">=</span> <span class="fu">find_core</span>(<span class="at">ps =</span> ps_paired_data, <span class="at">variable =</span> <span class="st">"commonName"</span>, <span class="at">g =</span> <span class="st">"Red shiner"</span>, <span class="at">perc =</span> percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'speciesSums' is deprecated.
Use 'taxa_sums' instead.
See help("Deprecated") and help("phyloseq-deprecated").</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>core_red<span class="sc">$</span>core1<span class="sc">@</span>tax_table[ , <span class="fu">c</span>(<span class="st">"Phylum"</span>, <span class="st">"Genus"</span>, <span class="st">"Species"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [4 taxa by 3 taxonomic ranks]:
       Phylum             Genus          Species       
ASV_1  "Proteobacteria"   "Roseomonas"   "gilardii"    
ASV_14 "Proteobacteria"   NA             NA            
ASV_36 "Actinobacteriota" "Streptomyces" "albidoflavus"
ASV_66 "Actinobacteriota" NA             NA            </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>core_red<span class="sc">$</span>coverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27.02706</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(core_red<span class="sc">$</span>core1<span class="sc">@</span>tax_table,</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"red_core.csv"</span>,</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(core_red$core1@tax_table, file = "red_core.csv", row.names
= TRUE, : attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap Showing the Red core microbiome ASVS across all sample types</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>red_core <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">row.names</span>(core_red<span class="sc">$</span>core1<span class="sc">@</span>otu_table), ps_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'
Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_heatmap</span>(red_core, </span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.label =</span> <span class="st">"commonName"</span>,</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.order =</span> <span class="st">"commonName"</span>)<span class="sc">+</span></span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Relative</span><span class="sc">\n</span><span class="st">Abundance"</span>) <span class="ot">-&gt;</span> p</span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>scales<span class="sc">$</span>scales[[<span class="dv">1</span>]]<span class="sc">$</span>name <span class="ot">=</span> <span class="st">"Sample Type"</span></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in discrete y-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/core_red-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/plot_heatmap_red.png", p, dpi = 300)</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap Showing the water core microbiome ASVS across all sample types</span></span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>red_core <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">row.names</span>(core_red<span class="sc">$</span>core1<span class="sc">@</span>otu_table), ps_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'
Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>red_core_otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(red_core<span class="sc">@</span>otu_table)</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(red_core_otu )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               110      110-10      110-3       110-5       110-6      110-8
ASV_1  0.000000000 0.271940786 0.79696506 0.532099272 0.106310609 0.16593234
ASV_14 0.008906709 0.026146304 0.00000000 0.015075377 0.048921696 0.02171518
ASV_36 0.000000000 0.016245314 0.05834608 0.041329094 0.007671154 0.01070024
ASV_66 0.001744613 0.009035855 0.00000000 0.005640447 0.018092343 0.01014949
             110-9          111       111-1      111-2       111-3        111-4
ASV_1  0.402161215 0.0008750976 0.123614245 0.04313621 0.106283030 0.0642432556
ASV_14 0.002920561 0.0052742367 0.004807221 0.03933528 0.000000000 0.0017146776
ASV_36 0.024313668 0.0000000000 0.006082606 0.00000000 0.005725191 0.0042866941
ASV_66 0.001971379 0.0011589130 0.002550770 0.03915849 0.001321198 0.0009716507
             111-5         113      113-1     113-10        113-4       113-6
ASV_1  0.370597776 0.000000000 0.30184102 0.31655260 0.0164210189 0.120139872
ASV_14 0.008456905 0.012207883 0.03539318 0.05840304 0.0016821532 0.075680626
ASV_36 0.025834106 0.000000000 0.01598402 0.02448669 0.0009612304 0.007409874
ASV_66 0.006255792 0.003332946 0.02411874 0.03320659 0.0013617430 0.050620265
             113-7      113-8         114       114-2       114-3      114-5
ASV_1  0.107982401 0.15686692 0.000000000 0.373230938 0.099240639 0.24855392
ASV_14 0.086863608 0.02250838 0.006905805 0.010202962 0.005498822 0.02605807
ASV_36 0.007165305 0.01037620 0.000000000 0.021283598 0.004975124 0.01603574
ASV_66 0.043871779 0.01670835 0.002643937 0.005046626 0.004778738 0.01517668
             114-6         116       116-2       116-3       116-5       116-7
ASV_1  0.040159457 0.000761808 0.017215099 0.276774073 0.402436961 0.450546955
ASV_14 0.004207884 0.038217369 0.001569085 0.035108959 0.030292774 0.019228585
ASV_36 0.002509966 0.000000000 0.000000000 0.020022351 0.022338805 0.038532874
ASV_66 0.002657611 0.002243101 0.000000000 0.007450177 0.006600102 0.004050115
             116-8      116-9         120      120-10       120-4         121
ASV_1  0.008986277 0.27815605 0.000000000 0.166214014 0.078018067 0.001184025
ASV_14 0.015980522 0.04494847 0.012038451 0.004236828 0.003695593 0.009107883
ASV_36 0.000000000 0.01835664 0.000000000 0.007821836 0.003421845 0.000000000
ASV_66 0.002434706 0.00763710 0.003863085 0.000000000 0.000000000 0.001821577
             121-1      121-4       121-9          122       122-5          124
ASV_1  0.067817509 0.02729786 0.012248123 0.0006573495 0.014582239 0.0018002066
ASV_14 0.005394575 0.00276434 0.005057290 0.0058875647 0.014319496 0.0049284344
ASV_36 0.004315660 0.00000000 0.001264322 0.0000000000 0.000000000 0.0002360927
ASV_66 0.000000000 0.00276434 0.001501383 0.0009145732 0.003809774 0.0017706950
             124-5       124-7       124-8       124-9         125       125-2
ASV_1  0.094658288 0.108641289 0.274169466 0.214465502 0.002403948 0.070947571
ASV_14 0.023369992 0.003889969 0.014744308 0.017841279 0.006509807 0.009018759
ASV_36 0.006677141 0.006807447 0.015864128 0.013473497 0.000000000 0.003848004
ASV_66 0.005302435 0.002778550 0.005412467 0.002961208 0.000000000 0.000000000
             125-4       125-5
ASV_1  0.177639643 0.067582504
ASV_14 0.016897216 0.020527396
ASV_36 0.006828927 0.003631770
ASV_66 0.003502014 0.004894994</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>red_core_otu <span class="sc">|&gt;</span> </span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ASV"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">51</span>,</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sample"</span>,</span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>) <span class="ot">-&gt;</span> intermediate_table</span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>intermediate_table <span class="ot">=</span> <span class="fu">left_join</span>(intermediate_table, meta, <span class="at">by =</span> <span class="fu">join_by</span>(sample <span class="sc">==</span> sampleID))</span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>intermediate_table <span class="sc">|&gt;</span> </span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_abund =</span> <span class="fu">log</span>(rel_abund, <span class="at">base =</span> <span class="dv">10</span>))<span class="ot">-&gt;</span> red_core_longer</span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get order of samples to group by sample type</span></span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">|&gt;</span> </span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(commonName) <span class="ot">-&gt;</span> sample_order</span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a><span class="co"># order of asvs</span></span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>asv_order <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">36</span>, <span class="dv">66</span>, <span class="dv">14</span>)</span>
<span id="cb364-17"><a href="#cb364-17" aria-hidden="true" tabindex="-1"></a>asv_order <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"ASV_"</span>, <span class="fu">as.character</span>(asv_order))</span>
<span id="cb364-18"><a href="#cb364-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot heatmap</span></span>
<span id="cb364-19"><a href="#cb364-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> red_core_longer)<span class="sc">+</span></span>
<span id="cb364-20"><a href="#cb364-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(sample, <span class="at">level =</span> sample_order<span class="sc">$</span>sampleID),</span>
<span id="cb364-21"><a href="#cb364-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> asv_order),</span>
<span id="cb364-22"><a href="#cb364-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb364-23"><a href="#cb364-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb364-24"><a href="#cb364-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb364-25"><a href="#cb364-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb364-26"><a href="#cb364-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> sample_order<span class="sc">$</span>commonName)<span class="sc">+</span></span>
<span id="cb364-27"><a href="#cb364-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb364-28"><a href="#cb364-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb364-29"><a href="#cb364-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>)) <span class="ot">-&gt;</span> red_core_heatmap</span>
<span id="cb364-30"><a href="#cb364-30" aria-hidden="true" tabindex="-1"></a>red_core_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/core_red-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/red_core_heatmap.png", red_core_heatmap, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(red_core_longer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 32
  ASV   sample rel_abund   X.4   X.3   X.2   X.1 X     miseqID sample_or_control
  &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;            
1 ASV_1 110    -Inf        129   280   280   938 A42   A42     sample           
2 ASV_1 110-10   -0.566      9    20    20   206 S202  S202    sample           
3 ASV_1 110-3    -0.0986     3    14    14   197 S195  S195    sample           
4 ASV_1 110-5    -0.274      4    15    15   198 S196  S196    sample           
5 ASV_1 110-6    -0.973      6    17    17   200 S198  S198    sample           
6 ASV_1 110-8    -0.780      7    18    18   204 S200  S200    sample           
# ℹ 22 more variables: sampleType &lt;chr&gt;, station &lt;chr&gt;, river &lt;chr&gt;,
#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, speciesCode &lt;int&gt;, commonName &lt;chr&gt;,
#   fieldDate &lt;chr&gt;, ammonia &lt;dbl&gt;, turbidity &lt;dbl&gt;, do &lt;dbl&gt;,
#   temperature &lt;dbl&gt;, no3 &lt;dbl&gt;, totalNitrogen &lt;dbl&gt;, totalPhosphorus &lt;dbl&gt;,
#   phosphatePhosphorus &lt;lgl&gt;, kjedahlNitrogen &lt;lgl&gt;, pH &lt;lgl&gt;,
#   suspendedSolids &lt;lgl&gt;, ecoli &lt;lgl&gt;, specificConductance &lt;lgl&gt;, is.neg &lt;lgl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># core_red$core1@tax_table = table to associate asv_x with taxonomy info</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>red_taxtab <span class="ot">=</span> <span class="fu">as.data.frame</span>(core_red<span class="sc">$</span>core1<span class="sc">@</span>tax_table)</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>red_taxtab<span class="sc">$</span>ASV <span class="ot">=</span> <span class="fu">row.names</span>(red_taxtab)</span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a version with ASVs sorted by phylum</span></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>red_taxtab <span class="sc">|&gt;</span> </span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Phylum) <span class="ot">-&gt;</span> phy_sorted_tax</span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(phy_sorted_tax,</span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"phy_sorted_red_core.csv"</span>,</span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(phy_sorted_tax, file = "phy_sorted_red_core.csv",
col.names = TRUE): attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> red_core_longer)<span class="sc">+</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample,</span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> phy_sorted_tax<span class="sc">$</span>ASV),</span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> phy_sorted_tax<span class="sc">$</span>Family)<span class="sc">+</span></span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> commonName,</span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb370-14"><a href="#cb370-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>),</span>
<span id="cb370-15"><a href="#cb370-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(.<span class="dv">1</span>,<span class="st">"lines"</span>)) <span class="ot">-&gt;</span> red_core_heatmap_phy_sort</span>
<span id="cb370-16"><a href="#cb370-16" aria-hidden="true" tabindex="-1"></a>red_core_heatmap_phy_sort</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/heatmap2-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/red_core_heatmap_edit.png", red_core_heatmap_phy_sort, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sand-shiner-core" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="sand-shiner-core"><span class="header-section-number">20.5</span> Sand Shiner Core</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>core_sand <span class="ot">=</span> <span class="fu">find_core</span>(<span class="at">ps =</span> ps_paired_data, <span class="at">variable =</span> <span class="st">"commonName"</span>, <span class="at">g =</span> <span class="st">"Sand shiner"</span>, <span class="at">perc =</span> percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'speciesSums' is deprecated.
Use 'taxa_sums' instead.
See help("Deprecated") and help("phyloseq-deprecated").</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>core_sand<span class="sc">$</span>core1<span class="sc">@</span>tax_table[ , <span class="fu">c</span>(<span class="st">"Phylum"</span>, <span class="st">"Genus"</span>, <span class="st">"Species"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Taxonomy Table:     [7 taxa by 3 taxonomic ranks]:
        Phylum             Genus          Species       
ASV_1   "Proteobacteria"   "Roseomonas"   "gilardii"    
ASV_14  "Proteobacteria"   NA             NA            
ASV_61  "Proteobacteria"   NA             NA            
ASV_36  "Actinobacteriota" "Streptomyces" "albidoflavus"
ASV_66  "Actinobacteriota" NA             NA            
ASV_142 "Actinobacteriota" "Longivirga"   NA            
ASV_114 "Planctomycetota"  NA             NA            </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>core_sand<span class="sc">$</span>coverage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.04076</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(core_sand<span class="sc">$</span>core1<span class="sc">@</span>tax_table,</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"sand_core.csv"</span>,</span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(core_sand$core1@tax_table, file = "sand_core.csv", :
attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap Showing the Red core microbiome ASVS across all sample types</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>sand_core <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">row.names</span>(core_sand<span class="sc">$</span>core1<span class="sc">@</span>otu_table), ps_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'
Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_heatmap</span>(sand_core, </span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.label =</span> <span class="st">"commonName"</span>,</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.order =</span> <span class="st">"commonName"</span>)<span class="sc">+</span></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Relative</span><span class="sc">\n</span><span class="st">Abundance"</span>) <span class="ot">-&gt;</span> p</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>scales<span class="sc">$</span>scales[[<span class="dv">1</span>]]<span class="sc">$</span>name <span class="ot">=</span> <span class="st">"Sample Type"</span></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in discrete y-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/core_sand-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/plot_heatmap_sand.png", p, dpi = 300)</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap Showing the water core microbiome ASVS across all sample types</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>sand_core <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">row.names</span>(core_sand<span class="sc">$</span>core1<span class="sc">@</span>otu_table), ps_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'
Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>sand_core_otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(sand_core<span class="sc">@</span>otu_table)</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sand_core_otu )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                110      110-10      110-3       110-5       110-6       110-8
ASV_1   0.000000000 0.271940786 0.79696506 0.532099272 0.106310609 0.165932337
ASV_14  0.008906709 0.026146304 0.00000000 0.015075377 0.048921696 0.021715185
ASV_61  0.000000000 0.029799096 0.00000000 0.011998769 0.053263859 0.014319434
ASV_36  0.000000000 0.016245314 0.05834608 0.041329094 0.007671154 0.010700236
ASV_66  0.001744613 0.009035855 0.00000000 0.005640447 0.018092343 0.010149489
ASV_142 0.001407933 0.003460540 0.00000000 0.001692134 0.006875090 0.001888277
               110-9          111       111-1       111-2       111-3
ASV_1   0.4021612150 0.0008750976 0.123614245 0.043136215 0.106283030
ASV_14  0.0029205607 0.0052742367 0.004807221 0.039335278 0.000000000
ASV_61  0.0030665888 0.0012298668 0.006376925 0.038274551 0.000000000
ASV_36  0.0243136682 0.0000000000 0.006082606 0.000000000 0.005725191
ASV_66  0.0019713785 0.0011589130 0.002550770 0.039158490 0.001321198
ASV_142 0.0007301402 0.0009224001 0.000000000 0.003270574 0.000000000
               111-4       111-5         113      113-1      113-10
ASV_1   0.0642432556 0.370597776 0.000000000 0.30184102 0.316552598
ASV_14  0.0017146776 0.008456905 0.012207883 0.03539318 0.058403042
ASV_61  0.0017718336 0.007761816 0.003255435 0.01626944 0.009480355
ASV_36  0.0042866941 0.025834106 0.000000000 0.01598402 0.024486692
ASV_66  0.0009716507 0.006255792 0.003332946 0.02411874 0.033206591
ASV_142 0.0000000000 0.002316960 0.001821494 0.00613672 0.010849176
               113-4       113-6       113-7       113-8         114
ASV_1   0.0164210189 0.120139872 0.107982401 0.156866919 0.000000000
ASV_14  0.0016821532 0.075680626 0.086863608 0.022508381 0.006905805
ASV_61  0.0000000000 0.015069520 0.029038341 0.006066088 0.001973087
ASV_36  0.0009612304 0.007409874 0.007165305 0.010376204 0.000000000
ASV_66  0.0013617430 0.050620265 0.043871779 0.016708349 0.002643937
ASV_142 0.0000000000 0.020647740 0.020238843 0.003724791 0.001499546
              114-2       114-3       114-5       114-6         116       116-2
ASV_1   0.373230938 0.099240639 0.248553920 0.040159457 0.000761808 0.017215099
ASV_14  0.010202962 0.005498822 0.026058072 0.004207884 0.038217369 0.001569085
ASV_61  0.010202962 0.005367897 0.012484966 0.001845563 0.000000000 0.000000000
ASV_36  0.021283598 0.004975124 0.016035737 0.002509966 0.000000000 0.000000000
ASV_66  0.005046626 0.004778738 0.015176679 0.002657611 0.002243101 0.000000000
ASV_142 0.001974767 0.001702016 0.006414295 0.000000000 0.001354325 0.000000000
              116-3       116-5       116-7       116-8       116-9         120
ASV_1   0.276774073 0.402436961 0.450546955 0.008986277 0.278156054 0.000000000
ASV_14  0.035108959 0.030292774 0.019228585 0.015980522 0.044948473 0.012038451
ASV_61  0.002980071 0.000000000 0.001400507 0.002080567 0.011915716 0.000000000
ASV_36  0.020022351 0.022338805 0.038532874 0.000000000 0.018356643 0.000000000
ASV_66  0.007450177 0.006600102 0.004050115 0.002434706 0.007637100 0.003863085
ASV_142 0.006891414 0.007784735 0.002346796 0.002478973 0.007821126 0.002605336
             120-10       120-4         121       121-1       121-4       121-9
ASV_1   0.166214014 0.078018067 0.001184025 0.067817509 0.027297858 0.012248123
ASV_14  0.004236828 0.003695593 0.009107883 0.005394575 0.002764340 0.005057290
ASV_61  0.008690929 0.007528059 0.002094813 0.011251541 0.006046994 0.004109048
ASV_36  0.007821836 0.003421845 0.000000000 0.004315660 0.000000000 0.001264322
ASV_66  0.000000000 0.000000000 0.001821577 0.000000000 0.002764340 0.001501383
ASV_142 0.000000000 0.000000000 0.001047407 0.000000000 0.000000000 0.001343343
                 122       122-5          124       124-5       124-7
ASV_1   0.0006573495 0.014582239 0.0018002066 0.094658288 0.108641289
ASV_14  0.0058875647 0.014319496 0.0049284344 0.023369992 0.003889969
ASV_61  0.0000000000 0.000000000 0.0000000000 0.011979576 0.000000000
ASV_36  0.0000000000 0.000000000 0.0002360927 0.006677141 0.006807447
ASV_66  0.0009145732 0.003809774 0.0017706950 0.005302435 0.002778550
ASV_142 0.0007716711 0.004992118 0.0015050907 0.003534957 0.000000000
              124-8       124-9          125       125-2       125-4
ASV_1   0.274169466 0.214465502 0.0024039484 0.070947571 0.177639643
ASV_14  0.014744308 0.017841279 0.0065098073 0.009018759 0.016897216
ASV_61  0.010824935 0.005848386 0.0010849679 0.011664262 0.018035370
ASV_36  0.015864128 0.013473497 0.0000000000 0.003848004 0.006828927
ASV_66  0.005412467 0.002961208 0.0000000000 0.000000000 0.003502014
ASV_142 0.000000000 0.001184483 0.0005105731 0.004088504 0.000000000
              125-5
ASV_1   0.067582504
ASV_14  0.020527396
ASV_61  0.010737407
ASV_36  0.003631770
ASV_66  0.004894994
ASV_142 0.006474025</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>sand_core_otu <span class="sc">|&gt;</span> </span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ASV"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">51</span>,</span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"sample"</span>,</span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rel_abund"</span>) <span class="ot">-&gt;</span> intermediate_table</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a>intermediate_table <span class="ot">=</span> <span class="fu">left_join</span>(intermediate_table, meta, <span class="at">by =</span> <span class="fu">join_by</span>(sample <span class="sc">==</span> sampleID))</span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a>intermediate_table <span class="sc">|&gt;</span> </span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_abund =</span> <span class="fu">log</span>(rel_abund, <span class="at">base =</span> <span class="dv">10</span>))<span class="ot">-&gt;</span> sand_core_longer</span>
<span id="cb392-11"><a href="#cb392-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-12"><a href="#cb392-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get order of samples to group by sample type</span></span>
<span id="cb392-13"><a href="#cb392-13" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">|&gt;</span> </span>
<span id="cb392-14"><a href="#cb392-14" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb392-15"><a href="#cb392-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(commonName) <span class="ot">-&gt;</span> sample_order</span>
<span id="cb392-16"><a href="#cb392-16" aria-hidden="true" tabindex="-1"></a><span class="co"># order of asvs</span></span>
<span id="cb392-17"><a href="#cb392-17" aria-hidden="true" tabindex="-1"></a>asv_order <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">114</span>, <span class="dv">61</span>, <span class="dv">1</span>, <span class="dv">36</span>, <span class="dv">66</span>, <span class="dv">142</span>, <span class="dv">14</span>)</span>
<span id="cb392-18"><a href="#cb392-18" aria-hidden="true" tabindex="-1"></a>asv_order <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"ASV_"</span>, <span class="fu">as.character</span>(asv_order))</span>
<span id="cb392-19"><a href="#cb392-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot heatmap</span></span>
<span id="cb392-20"><a href="#cb392-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sand_core_longer)<span class="sc">+</span></span>
<span id="cb392-21"><a href="#cb392-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(sample, <span class="at">level =</span> sample_order<span class="sc">$</span>sampleID),</span>
<span id="cb392-22"><a href="#cb392-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> asv_order),</span>
<span id="cb392-23"><a href="#cb392-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb392-24"><a href="#cb392-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb392-25"><a href="#cb392-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb392-26"><a href="#cb392-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb392-27"><a href="#cb392-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> sample_order<span class="sc">$</span>commonName)<span class="sc">+</span></span>
<span id="cb392-28"><a href="#cb392-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb392-29"><a href="#cb392-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb392-30"><a href="#cb392-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>)) <span class="ot">-&gt;</span> sand_core_heatmap</span>
<span id="cb392-31"><a href="#cb392-31" aria-hidden="true" tabindex="-1"></a>sand_core_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/core_sand-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sand_core_heatmap.png", sand_core_heatmap, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sand_core_longer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 32
  ASV   sample rel_abund   X.4   X.3   X.2   X.1 X     miseqID sample_or_control
  &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;            
1 ASV_1 110    -Inf        129   280   280   938 A42   A42     sample           
2 ASV_1 110-10   -0.566      9    20    20   206 S202  S202    sample           
3 ASV_1 110-3    -0.0986     3    14    14   197 S195  S195    sample           
4 ASV_1 110-5    -0.274      4    15    15   198 S196  S196    sample           
5 ASV_1 110-6    -0.973      6    17    17   200 S198  S198    sample           
6 ASV_1 110-8    -0.780      7    18    18   204 S200  S200    sample           
# ℹ 22 more variables: sampleType &lt;chr&gt;, station &lt;chr&gt;, river &lt;chr&gt;,
#   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, speciesCode &lt;int&gt;, commonName &lt;chr&gt;,
#   fieldDate &lt;chr&gt;, ammonia &lt;dbl&gt;, turbidity &lt;dbl&gt;, do &lt;dbl&gt;,
#   temperature &lt;dbl&gt;, no3 &lt;dbl&gt;, totalNitrogen &lt;dbl&gt;, totalPhosphorus &lt;dbl&gt;,
#   phosphatePhosphorus &lt;lgl&gt;, kjedahlNitrogen &lt;lgl&gt;, pH &lt;lgl&gt;,
#   suspendedSolids &lt;lgl&gt;, ecoli &lt;lgl&gt;, specificConductance &lt;lgl&gt;, is.neg &lt;lgl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># core_red$core1@tax_table = table to associate asv_x with taxonomy info</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>sand_taxtab <span class="ot">=</span> <span class="fu">as.data.frame</span>(core_sand<span class="sc">$</span>core1<span class="sc">@</span>tax_table)</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>sand_taxtab<span class="sc">$</span>ASV <span class="ot">=</span> <span class="fu">row.names</span>(sand_taxtab)</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a version with ASVs sorted by phylum</span></span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>sand_taxtab <span class="sc">|&gt;</span> </span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Phylum) <span class="ot">-&gt;</span> phy_sorted_tax</span>
<span id="cb396-8"><a href="#cb396-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-9"><a href="#cb396-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(phy_sorted_tax,</span>
<span id="cb396-10"><a href="#cb396-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"phy_sorted_sand_core.csv"</span>,</span>
<span id="cb396-11"><a href="#cb396-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in write.csv(phy_sorted_tax, file = "phy_sorted_sand_core.csv", :
attempt to set 'col.names' ignored</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sand_core_longer)<span class="sc">+</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample,</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">factor</span>(ASV, <span class="at">level =</span> phy_sorted_tax<span class="sc">$</span>ASV),</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> rel_abund))<span class="sc">+</span></span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample"</span>,</span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ASV"</span>,</span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> phy_sorted_tax<span class="sc">$</span>Family)<span class="sc">+</span></span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> commonName,</span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb398-12"><a href="#cb398-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb398-13"><a href="#cb398-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb398-14"><a href="#cb398-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">3.75</span>),</span>
<span id="cb398-15"><a href="#cb398-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(.<span class="dv">1</span>,<span class="st">"lines"</span>)) <span class="ot">-&gt;</span> sand_core_heatmap_phy_sort</span>
<span id="cb398-16"><a href="#cb398-16" aria-hidden="true" tabindex="-1"></a>sand_core_heatmap_phy_sort</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/heatmap2_sand-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/sand_core_heatmap_edit.png", sand_core_heatmap_phy_sort, width = 7, height = 5, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">ggarrange</span>(water_core_heatmap_phy_sort, red_core_heatmap_phy_sort, sand_core_heatmap_phy_sort,</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/combined_heatmap.png", test, width = 7, height = 15, units = "in", dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="shared-and-unique-taxa" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Shared and Unique Taxa</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make function to create data subsets including samples of a specific type and removing ASVs that are not present in samples of that type.</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>subset_ps <span class="ot">=</span> <span class="cf">function</span>(ps, variable, g){</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">prune_samples</span>(ps<span class="sc">@</span>sam_data[[variable]] <span class="sc">==</span> g, ps)</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">prune_taxa</span>(<span class="fu">speciesSums</span>(data) <span class="sc">&gt;</span> <span class="dv">0</span>, data)</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb401-7"><a href="#cb401-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-8"><a href="#cb401-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data subsets</span></span>
<span id="cb401-9"><a href="#cb401-9" aria-hidden="true" tabindex="-1"></a>water <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_paired_data,</span>
<span id="cb401-10"><a href="#cb401-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb401-11"><a href="#cb401-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">g =</span> <span class="st">"Water"</span>)</span>
<span id="cb401-12"><a href="#cb401-12" aria-hidden="true" tabindex="-1"></a>water_list <span class="ot">=</span> <span class="fu">row.names</span>(water<span class="sc">@</span>otu_table)</span>
<span id="cb401-13"><a href="#cb401-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-14"><a href="#cb401-14" aria-hidden="true" tabindex="-1"></a>red <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_paired_data,</span>
<span id="cb401-15"><a href="#cb401-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb401-16"><a href="#cb401-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">g =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb401-17"><a href="#cb401-17" aria-hidden="true" tabindex="-1"></a>red_list <span class="ot">=</span> <span class="fu">row.names</span>(red<span class="sc">@</span>otu_table)</span>
<span id="cb401-18"><a href="#cb401-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-19"><a href="#cb401-19" aria-hidden="true" tabindex="-1"></a>sand <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_paired_data,</span>
<span id="cb401-20"><a href="#cb401-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb401-21"><a href="#cb401-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">g =</span> <span class="st">"Sand shiner"</span>)</span>
<span id="cb401-22"><a href="#cb401-22" aria-hidden="true" tabindex="-1"></a>sand_list <span class="ot">=</span> <span class="fu">row.names</span>(sand<span class="sc">@</span>otu_table)</span>
<span id="cb401-23"><a href="#cb401-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-24"><a href="#cb401-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of the group data</span></span>
<span id="cb401-25"><a href="#cb401-25" aria-hidden="true" tabindex="-1"></a>ASV_ven <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Water =</span> water_list,</span>
<span id="cb401-26"><a href="#cb401-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">`</span><span class="at">Red Shiner</span><span class="st">`</span> <span class="ot">=</span> red_list,</span>
<span id="cb401-27"><a href="#cb401-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">`</span><span class="at">Sand Shiner</span><span class="st">`</span> <span class="ot">=</span> sand_list)</span>
<span id="cb401-28"><a href="#cb401-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-29"><a href="#cb401-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot venn diagram</span></span>
<span id="cb401-30"><a href="#cb401-30" aria-hidden="true" tabindex="-1"></a>venndiagram <span class="ot">=</span> <span class="fu">ggvenn</span>(ASV_ven, <span class="fu">c</span>(<span class="st">"Water"</span>, <span class="st">"Red Shiner"</span>, <span class="st">"Sand Shiner"</span>),</span>
<span id="cb401-31"><a href="#cb401-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">text_size =</span> <span class="dv">3</span>,</span>
<span id="cb401-32"><a href="#cb401-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill_color =</span> <span class="fu">c</span>(<span class="st">"#c5f9d7"</span>, <span class="st">"#f27a7d"</span>,<span class="st">"#f7d486"</span>),</span>
<span id="cb401-33"><a href="#cb401-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">stroke_size =</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb401-34"><a href="#cb401-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb401-35"><a href="#cb401-35" aria-hidden="true" tabindex="-1"></a>venndiagram</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ks_FishMicrobe_diversity_version3_files/figure-html/venn_diagram-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figs/venndiagram.png", venndiagram, dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>water_data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"asv"</span> <span class="ot">=</span> <span class="fu">row.names</span>(water<span class="sc">@</span>otu_table),</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"abundance"</span> <span class="ot">=</span> <span class="fu">taxa_sums</span>(water))</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>red_data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"asv"</span> <span class="ot">=</span> <span class="fu">row.names</span>(red<span class="sc">@</span>otu_table),</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"abundance"</span> <span class="ot">=</span> <span class="fu">taxa_sums</span>(red))</span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>sand_data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"asv"</span> <span class="ot">=</span> <span class="fu">row.names</span>(sand<span class="sc">@</span>otu_table),</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"abundance"</span> <span class="ot">=</span> <span class="fu">taxa_sums</span>(sand))</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a><span class="do">## RED SHINER TO WATER ##</span></span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get phyloseq with only water and red samples/taxa</span></span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>water_red <span class="ot">=</span> <span class="fu">subset_ps_2_groups</span>(<span class="at">ps =</span> ps_paired_data,</span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb403-12"><a href="#cb403-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">g1 =</span> <span class="st">"Water"</span>,</span>
<span id="cb403-13"><a href="#cb403-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">g2 =</span> <span class="st">"Red shiner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Found more than one class "phylo" in cache; using the first, from namespace 'phyloseq'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Also defined by 'tidytree'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in water but not Red shiners</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>water_only <span class="ot">=</span> <span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv)]</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Red shiners but not in water</span></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>red_only <span class="ot">=</span> <span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv)]</span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in both Red shiners and water</span></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a>water_and_red <span class="ot">=</span> <span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv)]</span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a><span class="co"># find the percentage of reads sourced from each category.</span></span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a>water_red_asvs <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"asv"</span> <span class="ot">=</span> <span class="fu">row.names</span>(water_red<span class="sc">@</span>otu_table),</span>
<span id="cb406-12"><a href="#cb406-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"abundance"</span> <span class="ot">=</span> <span class="fu">taxa_sums</span>(water_red)) <span class="sc">|&gt;</span> </span>
<span id="cb406-13"><a href="#cb406-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="fu">case_when</span>(asv <span class="sc">%in%</span> water_only <span class="sc">~</span> <span class="st">"water"</span>,</span>
<span id="cb406-14"><a href="#cb406-14" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> red_only <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb406-15"><a href="#cb406-15" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> water_and_red <span class="sc">~</span> <span class="st">"both"</span>),</span>
<span id="cb406-16"><a href="#cb406-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">"total_reads"</span> <span class="ot">=</span> <span class="fu">sum</span>(abundance)) <span class="sc">|&gt;</span> </span>
<span id="cb406-17"><a href="#cb406-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span> </span>
<span id="cb406-18"><a href="#cb406-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">"group_sum"</span> <span class="ot">=</span> <span class="fu">sum</span>(abundance)) <span class="sc">|&gt;</span> </span>
<span id="cb406-19"><a href="#cb406-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="fu">sum</span>(group_sum),</span>
<span id="cb406-20"><a href="#cb406-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">"%reads"</span> <span class="ot">=</span> group_sum <span class="sc">/</span> total_reads)</span>
<span id="cb406-21"><a href="#cb406-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-22"><a href="#cb406-22" aria-hidden="true" tabindex="-1"></a><span class="do">## JUST FIND THE NUMBERS FOR THE THREE WAY VEN DIAGRAM ##</span></span>
<span id="cb406-23"><a href="#cb406-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-24"><a href="#cb406-24" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in water but not sand shiners or red shiners</span></span>
<span id="cb406-25"><a href="#cb406-25" aria-hidden="true" tabindex="-1"></a>water_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv)]</span>
<span id="cb406-26"><a href="#cb406-26" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_only %in% water_data$asv)</span></span>
<span id="cb406-27"><a href="#cb406-27" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_only %in% red_data$asv)</span></span>
<span id="cb406-28"><a href="#cb406-28" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_only %in% sand_data$asv)</span></span>
<span id="cb406-29"><a href="#cb406-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-30"><a href="#cb406-30" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Red shiners but not in water or sand shiners</span></span>
<span id="cb406-31"><a href="#cb406-31" aria-hidden="true" tabindex="-1"></a>red_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv)]</span>
<span id="cb406-32"><a href="#cb406-32" aria-hidden="true" tabindex="-1"></a><span class="co"># table(red_only %in% red_data$asv)</span></span>
<span id="cb406-33"><a href="#cb406-33" aria-hidden="true" tabindex="-1"></a><span class="co"># table(red_only %in% water_data$asv)</span></span>
<span id="cb406-34"><a href="#cb406-34" aria-hidden="true" tabindex="-1"></a><span class="co"># table(red_only %in% sand_data$asv)</span></span>
<span id="cb406-35"><a href="#cb406-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-36"><a href="#cb406-36" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Sand shiners but not in water or red shiners</span></span>
<span id="cb406-37"><a href="#cb406-37" aria-hidden="true" tabindex="-1"></a>sand_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv)]</span>
<span id="cb406-38"><a href="#cb406-38" aria-hidden="true" tabindex="-1"></a><span class="co"># table(sand_only %in% sand_data$asv)</span></span>
<span id="cb406-39"><a href="#cb406-39" aria-hidden="true" tabindex="-1"></a><span class="co"># table(sand_only %in% water_data$asv)</span></span>
<span id="cb406-40"><a href="#cb406-40" aria-hidden="true" tabindex="-1"></a><span class="co"># table(sand_only %in% red_data$asv)</span></span>
<span id="cb406-41"><a href="#cb406-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-42"><a href="#cb406-42" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Water and Red shiners but NOT sand shiners</span></span>
<span id="cb406-43"><a href="#cb406-43" aria-hidden="true" tabindex="-1"></a>water_red_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv)]</span>
<span id="cb406-44"><a href="#cb406-44" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_red_only %in% water_data$asv)</span></span>
<span id="cb406-45"><a href="#cb406-45" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_red_only %in% red_data$asv)</span></span>
<span id="cb406-46"><a href="#cb406-46" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_red_only %in% sand_data$asv)</span></span>
<span id="cb406-47"><a href="#cb406-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-48"><a href="#cb406-48" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Red shiners and Sand shiners but NOT in water</span></span>
<span id="cb406-49"><a href="#cb406-49" aria-hidden="true" tabindex="-1"></a>red_sand_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv)]</span>
<span id="cb406-50"><a href="#cb406-50" aria-hidden="true" tabindex="-1"></a><span class="co"># table(red_sand_only %in% red_data$asv)</span></span>
<span id="cb406-51"><a href="#cb406-51" aria-hidden="true" tabindex="-1"></a><span class="co"># table(red_sand_only %in% sand_data$asv)</span></span>
<span id="cb406-52"><a href="#cb406-52" aria-hidden="true" tabindex="-1"></a><span class="co"># table(red_sand_only %in% water_data$asv)</span></span>
<span id="cb406-53"><a href="#cb406-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-54"><a href="#cb406-54" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Sand shiners and Water but NOT in Red shiners</span></span>
<span id="cb406-55"><a href="#cb406-55" aria-hidden="true" tabindex="-1"></a>water_sand_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv)]</span>
<span id="cb406-56"><a href="#cb406-56" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_sand_only %in% water_data$asv)</span></span>
<span id="cb406-57"><a href="#cb406-57" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_sand_only %in% sand_data$asv)</span></span>
<span id="cb406-58"><a href="#cb406-58" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_sand_only %in% red_data$asv)</span></span>
<span id="cb406-59"><a href="#cb406-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-60"><a href="#cb406-60" aria-hidden="true" tabindex="-1"></a><span class="co"># list of ASVs found in Sand shiners, Red shiners, and Water</span></span>
<span id="cb406-61"><a href="#cb406-61" aria-hidden="true" tabindex="-1"></a>water_red_sand_only <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table)[(<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> water_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> red_data<span class="sc">$</span>asv) <span class="sc">&amp;</span> (<span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table) <span class="sc">%in%</span> sand_data<span class="sc">$</span>asv)]</span>
<span id="cb406-62"><a href="#cb406-62" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_red_sand_only %in% water_data$asv)</span></span>
<span id="cb406-63"><a href="#cb406-63" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_red_sand_only %in% red_data$asv)</span></span>
<span id="cb406-64"><a href="#cb406-64" aria-hidden="true" tabindex="-1"></a><span class="co"># table(water_red_sand_only %in% sand_data$asv)</span></span>
<span id="cb406-65"><a href="#cb406-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-66"><a href="#cb406-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-67"><a href="#cb406-67" aria-hidden="true" tabindex="-1"></a><span class="co"># find the percentage of reads sourced from each category.</span></span>
<span id="cb406-68"><a href="#cb406-68" aria-hidden="true" tabindex="-1"></a>percent_reads_venn <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"asv"</span> <span class="ot">=</span> <span class="fu">row.names</span>(ps_paired_data_int<span class="sc">@</span>otu_table),</span>
<span id="cb406-69"><a href="#cb406-69" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"abundance"</span> <span class="ot">=</span> <span class="fu">taxa_sums</span>(ps_paired_data_int)) <span class="sc">|&gt;</span> </span>
<span id="cb406-70"><a href="#cb406-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="fu">case_when</span>(asv <span class="sc">%in%</span> water_only <span class="sc">~</span> <span class="st">"water"</span>,</span>
<span id="cb406-71"><a href="#cb406-71" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> red_only <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb406-72"><a href="#cb406-72" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> sand_only <span class="sc">~</span> <span class="st">"sand"</span>,</span>
<span id="cb406-73"><a href="#cb406-73" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> water_red_only <span class="sc">~</span> <span class="st">"water_red"</span>,</span>
<span id="cb406-74"><a href="#cb406-74" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> red_sand_only <span class="sc">~</span> <span class="st">"red_sand"</span>,</span>
<span id="cb406-75"><a href="#cb406-75" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> water_sand_only <span class="sc">~</span> <span class="st">"water_sand"</span>,</span>
<span id="cb406-76"><a href="#cb406-76" aria-hidden="true" tabindex="-1"></a>                             asv <span class="sc">%in%</span> water_red_sand_only <span class="sc">~</span> <span class="st">"water_red_sand"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb406-77"><a href="#cb406-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span> </span>
<span id="cb406-78"><a href="#cb406-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">"group_sum"</span> <span class="ot">=</span> <span class="fu">sum</span>(abundance)) <span class="sc">|&gt;</span> </span>
<span id="cb406-79"><a href="#cb406-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="fu">sum</span>(group_sum),</span>
<span id="cb406-80"><a href="#cb406-80" aria-hidden="true" tabindex="-1"></a>         <span class="st">"%reads"</span> <span class="ot">=</span> group_sum <span class="sc">/</span> total_reads)</span>
<span id="cb406-81"><a href="#cb406-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-82"><a href="#cb406-82" aria-hidden="true" tabindex="-1"></a>percent_reads_venn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  group          group_sum total_reads `%reads`
  &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 red                29258      789624  0.0371 
2 red_sand          165646      789624  0.210  
3 sand               18136      789624  0.0230 
4 water             200047      789624  0.253  
5 water_red          47564      789624  0.0602 
6 water_red_sand    321902      789624  0.408  
7 water_sand          7071      789624  0.00895</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for % overlap between two groups</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>perc_overlap <span class="ot">=</span> <span class="cf">function</span>(a,b){</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>  percent <span class="ot">=</span> <span class="fu">table</span>(a <span class="sc">%in%</span> b)[<span class="st">"TRUE"</span>] <span class="sc">/</span> <span class="fu">length</span>(a)</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(percent)</span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a><span class="co"># % total overlap between red shiner and water</span></span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(merged)) shows all the values unique to red shiners, unique to the river, and 1 representation of each value in both. Thus the overlap is length(mrged) - length(unique(mrged))</span></span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a>mrged <span class="ot">=</span> <span class="fu">c</span>(red_list, water_list)</span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a>red_water_tot <span class="ot">=</span> (<span class="fu">length</span>(mrged) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">unique</span>(mrged))) <span class="sc">/</span> (<span class="fu">length</span>(mrged))</span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a><span class="co"># % red shiner microbes found in water</span></span>
<span id="cb408-13"><a href="#cb408-13" aria-hidden="true" tabindex="-1"></a>red_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> red_list,</span>
<span id="cb408-14"><a href="#cb408-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">b =</span> water_list)</span>
<span id="cb408-15"><a href="#cb408-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-16"><a href="#cb408-16" aria-hidden="true" tabindex="-1"></a><span class="co"># % water microbes found in red shiner</span></span>
<span id="cb408-17"><a href="#cb408-17" aria-hidden="true" tabindex="-1"></a>water_in_red <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> water_list,</span>
<span id="cb408-18"><a href="#cb408-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">b =</span> red_list)</span>
<span id="cb408-19"><a href="#cb408-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-20"><a href="#cb408-20" aria-hidden="true" tabindex="-1"></a><span class="co"># % red shiner core found in water</span></span>
<span id="cb408-21"><a href="#cb408-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-22"><a href="#cb408-22" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb408-23"><a href="#cb408-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-24"><a href="#cb408-24" aria-hidden="true" tabindex="-1"></a><span class="co"># % total overlap between sand shiner and water</span></span>
<span id="cb408-25"><a href="#cb408-25" aria-hidden="true" tabindex="-1"></a>mrged <span class="ot">=</span> <span class="fu">c</span>(sand_list, water_list)</span>
<span id="cb408-26"><a href="#cb408-26" aria-hidden="true" tabindex="-1"></a>sand_water_tot <span class="ot">=</span> (<span class="fu">length</span>(mrged) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">unique</span>(mrged))) <span class="sc">/</span> (<span class="fu">length</span>(mrged))</span>
<span id="cb408-27"><a href="#cb408-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-28"><a href="#cb408-28" aria-hidden="true" tabindex="-1"></a><span class="co"># % sand shiner microbes found in water</span></span>
<span id="cb408-29"><a href="#cb408-29" aria-hidden="true" tabindex="-1"></a>sand_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> sand_list,</span>
<span id="cb408-30"><a href="#cb408-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> water_list)</span>
<span id="cb408-31"><a href="#cb408-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-32"><a href="#cb408-32" aria-hidden="true" tabindex="-1"></a><span class="co"># % water microbes found in sand shiner</span></span>
<span id="cb408-33"><a href="#cb408-33" aria-hidden="true" tabindex="-1"></a>water_in_sand <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> water_list,</span>
<span id="cb408-34"><a href="#cb408-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> sand_list)</span>
<span id="cb408-35"><a href="#cb408-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-36"><a href="#cb408-36" aria-hidden="true" tabindex="-1"></a><span class="co"># % sand shiner core found in water</span></span>
<span id="cb408-37"><a href="#cb408-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-38"><a href="#cb408-38" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb408-39"><a href="#cb408-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-40"><a href="#cb408-40" aria-hidden="true" tabindex="-1"></a>overlap_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">Species</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Red Shiner"</span>, <span class="st">"Sand Shiner"</span>),</span>
<span id="cb408-41"><a href="#cb408-41" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">% Total Water - Fish overlap</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(red_water_tot, sand_water_tot),</span>
<span id="cb408-42"><a href="#cb408-42" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">% Fish microbes in Water</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(red_in_water, sand_in_water),</span>
<span id="cb408-43"><a href="#cb408-43" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">% Water microbes in Fish</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(water_in_red, water_in_sand))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Species</th>
<th>% Fish ASVs found in water</th>
<th>% Water ASVs found in Fish</th>
<th>% Total overlap between fish and water</th>
<th>% Core fish microbes found in water</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Red Shiner</td>
<td>0.3736264</td>
<td>0.3338008</td>
<td>0.1762963</td>
<td></td>
</tr>
<tr class="even">
<td>Sand Shiner</td>
<td>0.4134791</td>
<td>0.3183731</td>
<td>0.1798732</td>
<td></td>
</tr>
</tbody>
</table>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data set including all water samples taken at the paired data set station throughout the summer</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>keep_fish <span class="ot">=</span> ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID[ps_paired_data<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>]</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>keep_station <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"southstpaul"</span>, <span class="st">"ravenna"</span>, <span class="st">"presseywma"</span>, <span class="st">"hwy183"</span>, <span class="st">"oneil"</span>, <span class="st">"sartoria"</span>, <span class="st">"boelus"</span>)</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep all water samples from stations in the final analysis and all fecal samples</span></span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>ps_station_seasonal <span class="ot">=</span> <span class="fu">prune_samples</span>((ps_total<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span> <span class="sc">&amp;</span> ps_total<span class="sc">@</span>sam_data<span class="sc">$</span>station <span class="sc">%in%</span> keep_station) <span class="sc">|</span> ps_total<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span>, ps_total)</span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep water samples as before and keep only fecal samples included in the final analysis.</span></span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a>ps_station_seasonal <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_station_seasonal<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span> <span class="sc">|</span> (ps_station_seasonal<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span> <span class="sc">&amp;</span> ps_station_seasonal<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID <span class="sc">%in%</span> keep_fish), ps_station_seasonal)</span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------</span></span>
<span id="cb409-15"><a href="#cb409-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-16"><a href="#cb409-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data set including water samples taken throughout Nebraska and throughout the summer but only the fecal samples included in the final analysis.</span></span>
<span id="cb409-17"><a href="#cb409-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-18"><a href="#cb409-18" aria-hidden="true" tabindex="-1"></a>ps_seasonal_spatial <span class="ot">=</span> <span class="fu">prune_samples</span>(ps_total<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"water"</span> <span class="sc">|</span> (ps_total<span class="sc">@</span>sam_data<span class="sc">$</span>sampleType <span class="sc">==</span> <span class="st">"fecal"</span> <span class="sc">&amp;</span> ps_total<span class="sc">@</span>sam_data<span class="sc">$</span>sampleID <span class="sc">%in%</span> keep_fish), ps_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lists of ASVS for same stations + wider timeframe</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>water_station_seasonal <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_station_seasonal,</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">variable =</span> <span class="st">"sampleType"</span>,</span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">g =</span> <span class="st">"water"</span>)</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>water_station_seasonal <span class="ot">=</span> <span class="fu">row.names</span>(water_station_seasonal<span class="sc">@</span>otu_table)</span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a>red_station_seasonal <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_station_seasonal,</span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">g =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a>red_station_seasonal <span class="ot">=</span> <span class="fu">row.names</span>(red_station_seasonal<span class="sc">@</span>otu_table)</span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a>sand_station_seasonal <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_station_seasonal,</span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb410-14"><a href="#cb410-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">g =</span> <span class="st">"Sand shiner"</span>)</span>
<span id="cb410-15"><a href="#cb410-15" aria-hidden="true" tabindex="-1"></a>sand_station_seasonal <span class="ot">=</span> <span class="fu">row.names</span>(sand_station_seasonal<span class="sc">@</span>otu_table)</span>
<span id="cb410-16"><a href="#cb410-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-17"><a href="#cb410-17" aria-hidden="true" tabindex="-1"></a><span class="co"># lists of ASVs for all water samples and current fecal samples</span></span>
<span id="cb410-18"><a href="#cb410-18" aria-hidden="true" tabindex="-1"></a>water_seasonal_spatial <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_seasonal_spatial,</span>
<span id="cb410-19"><a href="#cb410-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">variable =</span> <span class="st">"sampleType"</span>,</span>
<span id="cb410-20"><a href="#cb410-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">g =</span> <span class="st">"water"</span>)</span>
<span id="cb410-21"><a href="#cb410-21" aria-hidden="true" tabindex="-1"></a>water_seasonal_spatial <span class="ot">=</span> <span class="fu">row.names</span>(water_seasonal_spatial<span class="sc">@</span>otu_table)</span>
<span id="cb410-22"><a href="#cb410-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-23"><a href="#cb410-23" aria-hidden="true" tabindex="-1"></a>red_seasonal_spatial <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_seasonal_spatial,</span>
<span id="cb410-24"><a href="#cb410-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb410-25"><a href="#cb410-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">g =</span> <span class="st">"Red shiner"</span>)</span>
<span id="cb410-26"><a href="#cb410-26" aria-hidden="true" tabindex="-1"></a>red_seasonal_spatial <span class="ot">=</span> <span class="fu">row.names</span>(red_seasonal_spatial<span class="sc">@</span>otu_table)</span>
<span id="cb410-27"><a href="#cb410-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-28"><a href="#cb410-28" aria-hidden="true" tabindex="-1"></a>sand_seasonal_spatial <span class="ot">=</span> <span class="fu">subset_ps</span>(<span class="at">ps =</span> ps_seasonal_spatial,</span>
<span id="cb410-29"><a href="#cb410-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">variable =</span> <span class="st">"commonName"</span>,</span>
<span id="cb410-30"><a href="#cb410-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">g =</span> <span class="st">"Sand shiner"</span>)</span>
<span id="cb410-31"><a href="#cb410-31" aria-hidden="true" tabindex="-1"></a>sand_seasonal_spatial <span class="ot">=</span> <span class="fu">row.names</span>(sand_seasonal_spatial<span class="sc">@</span>otu_table)</span>
<span id="cb410-32"><a href="#cb410-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-33"><a href="#cb410-33" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------</span></span>
<span id="cb410-34"><a href="#cb410-34" aria-hidden="true" tabindex="-1"></a><span class="co"># PAIRED DATA </span></span>
<span id="cb410-35"><a href="#cb410-35" aria-hidden="true" tabindex="-1"></a><span class="co"># % red shiner microbes found in water</span></span>
<span id="cb410-36"><a href="#cb410-36" aria-hidden="true" tabindex="-1"></a>red_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> red_list,</span>
<span id="cb410-37"><a href="#cb410-37" aria-hidden="true" tabindex="-1"></a>                            <span class="at">b =</span> water_list)</span>
<span id="cb410-38"><a href="#cb410-38" aria-hidden="true" tabindex="-1"></a><span class="co"># % sand shiner microbes found in water</span></span>
<span id="cb410-39"><a href="#cb410-39" aria-hidden="true" tabindex="-1"></a>sand_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> sand_list,</span>
<span id="cb410-40"><a href="#cb410-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> water_list)</span>
<span id="cb410-41"><a href="#cb410-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-42"><a href="#cb410-42" aria-hidden="true" tabindex="-1"></a><span class="co"># INCLUDE OTHER WATER SAMPLES AT THE SAME STATIONS THROUGH TIME</span></span>
<span id="cb410-43"><a href="#cb410-43" aria-hidden="true" tabindex="-1"></a>set2_red_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> red_station_seasonal,</span>
<span id="cb410-44"><a href="#cb410-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">b =</span> water_station_seasonal)</span>
<span id="cb410-45"><a href="#cb410-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-46"><a href="#cb410-46" aria-hidden="true" tabindex="-1"></a>set2_sand_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> sand_station_seasonal,</span>
<span id="cb410-47"><a href="#cb410-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">b =</span> water_station_seasonal)</span>
<span id="cb410-48"><a href="#cb410-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-49"><a href="#cb410-49" aria-hidden="true" tabindex="-1"></a><span class="co"># INCLUED WATER SAMPLES TAKEN AT ALL LOCATIONS AND ALL DATES IN 2019</span></span>
<span id="cb410-50"><a href="#cb410-50" aria-hidden="true" tabindex="-1"></a>set3_red_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> red_seasonal_spatial,</span>
<span id="cb410-51"><a href="#cb410-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">b =</span> water_seasonal_spatial)</span>
<span id="cb410-52"><a href="#cb410-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-53"><a href="#cb410-53" aria-hidden="true" tabindex="-1"></a>set3_sand_in_water <span class="ot">=</span> <span class="fu">perc_overlap</span>(<span class="at">a =</span> sand_seasonal_spatial,</span>
<span id="cb410-54"><a href="#cb410-54" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">b =</span> water_seasonal_spatial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Table showing the percentage of Fish ASVs found in water in 3 different data subsets.</p>
<ul>
<li>set 1: Only water samples with fecal samples in the same place on the same day</li>
<li>set 2: Include all water samples taken at stations inluded in set 1. (This only adds 4 samples).</li>
<li>set 3: Include all water samples regardless of location or date.</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Species</th>
<th>Set 1: % fish ASVs in water samples</th>
<th>Set 2: % fish ASVs in water samples</th>
<th>Set 3: % fish ASVs in water samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Red Shiner</td>
<td>0.3736264</td>
<td>0.433281</td>
<td>0.5855573</td>
</tr>
<tr class="even">
<td>Sand Shiner</td>
<td>0.4134791</td>
<td>0.4899818</td>
<td>0.6448087</td>
</tr>
</tbody>
</table>
</section>
<section id="taxa-rel-abundances" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Taxa Rel Abundances</h1>
</section>
<section id="session-info" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Session info</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.2 (2022-10-31 ucrt)
 os       Windows 10 x64 (build 22621)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_United States.utf8
 ctype    English_United States.utf8
 tz       America/Chicago
 date     2023-07-12
 pandoc   3.1.1 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 ! package              * version   date (UTC) lib source
   abind                  1.4-5     2016-07-21 [1] CRAN (R 4.2.0)
   ade4                   1.7-22    2023-02-06 [1] CRAN (R 4.2.2)
   annotate               1.74.0    2022-04-28 [1] Bioconductor
   AnnotationDbi          1.58.0    2022-04-26 [1] Bioconductor
   ape                    5.7       2023-02-16 [1] CRAN (R 4.2.2)
   aplot                  0.1.10    2023-03-08 [1] CRAN (R 4.2.3)
   backports              1.4.1     2021-12-13 [1] CRAN (R 4.2.0)
   Biobase              * 2.56.0    2022-04-26 [1] Bioconductor
   BiocGenerics         * 0.42.0    2022-04-26 [1] Bioconductor
   BiocParallel           1.30.3    2022-06-07 [1] Bioconductor
   biomformat             1.24.0    2022-04-26 [1] Bioconductor
   Biostrings             2.64.0    2022-04-26 [1] Bioconductor
   bit                    4.0.5     2022-11-15 [1] CRAN (R 4.2.2)
   bit64                  4.0.5     2020-08-30 [1] CRAN (R 4.2.1)
   bitops                 1.0-7     2021-04-24 [1] CRAN (R 4.2.0)
   blob                   1.2.4     2023-03-17 [1] CRAN (R 4.2.3)
   broom                  1.0.4     2023-03-11 [1] CRAN (R 4.2.3)
   cachem                 1.0.7     2023-02-24 [1] CRAN (R 4.2.3)
   callr                  3.7.3     2022-11-02 [1] CRAN (R 4.2.2)
   car                    3.1-1     2022-10-19 [1] CRAN (R 4.2.1)
   carData                3.0-5     2022-01-06 [1] CRAN (R 4.2.1)
   cellranger             1.1.0     2016-07-27 [1] CRAN (R 4.2.1)
   class                  7.3-21    2023-01-23 [1] CRAN (R 4.2.2)
   classInt               0.4-9     2023-02-28 [1] CRAN (R 4.2.3)
   cli                    3.6.0     2023-01-09 [1] CRAN (R 4.2.2)
   cluster                2.1.4     2022-08-22 [2] CRAN (R 4.2.2)
   codetools              0.2-19    2023-02-01 [1] CRAN (R 4.2.2)
   coin                   1.4-2     2021-10-08 [1] CRAN (R 4.2.1)
   colorspace             2.1-0     2023-01-23 [1] CRAN (R 4.2.2)
   cowplot                1.1.1     2020-12-30 [1] CRAN (R 4.2.2)
   crayon                 1.5.2     2022-09-29 [1] CRAN (R 4.2.2)
   data.table             1.14.8    2023-02-17 [1] CRAN (R 4.2.2)
   DBI                    1.1.3     2022-06-18 [1] CRAN (R 4.2.1)
   dbplyr                 2.3.2     2023-03-21 [1] CRAN (R 4.2.3)
   DelayedArray           0.22.0    2022-04-26 [1] Bioconductor
   DESeq2               * 1.36.0    2022-04-26 [1] Bioconductor
   devtools               2.4.5     2022-10-11 [1] CRAN (R 4.2.2)
   digest                 0.6.31    2022-12-11 [1] CRAN (R 4.2.2)
   dplyr                * 1.1.0     2023-01-29 [1] CRAN (R 4.2.2)
   dunn.test            * 1.3.5     2017-10-27 [1] CRAN (R 4.2.0)
   e1071                  1.7-13    2023-02-01 [1] CRAN (R 4.2.2)
   ellipsis               0.3.2     2021-04-29 [1] CRAN (R 4.2.1)
   evaluate               0.20      2023-01-17 [1] CRAN (R 4.2.2)
   fansi                  1.0.4     2023-01-22 [1] CRAN (R 4.2.2)
   farver                 2.1.1     2022-07-06 [1] CRAN (R 4.2.1)
   fastmap                1.1.1     2023-02-24 [1] CRAN (R 4.2.3)
   file2meco            * 0.5.0     2022-11-15 [1] CRAN (R 4.2.2)
   forcats              * 1.0.0     2023-01-29 [1] CRAN (R 4.2.2)
   foreach                1.5.2     2022-02-02 [1] CRAN (R 4.2.1)
   fs                     1.6.1     2023-02-06 [1] CRAN (R 4.2.2)
   gargle                 1.3.0     2023-01-30 [1] CRAN (R 4.2.2)
   genefilter             1.78.0    2022-04-26 [1] Bioconductor
   geneplotter            1.74.0    2022-04-26 [1] Bioconductor
   generics               0.1.3     2022-07-05 [1] CRAN (R 4.2.1)
   GenomeInfoDb         * 1.32.3    2022-08-11 [1] Bioconductor
   GenomeInfoDbData       1.2.8     2022-08-12 [1] Bioconductor
   GenomicRanges        * 1.48.0    2022-04-26 [1] Bioconductor
   ggfun                  0.0.9     2022-11-21 [1] CRAN (R 4.2.2)
   ggmap                * 3.0.2     2023-03-14 [1] CRAN (R 4.2.3)
   ggnewscale             0.4.8     2022-10-06 [1] CRAN (R 4.2.2)
   ggplot2              * 3.4.1     2023-02-10 [1] CRAN (R 4.2.2)
   ggplotify              0.1.0     2021-09-02 [1] CRAN (R 4.2.1)
   ggpubr               * 0.6.0     2023-02-10 [1] CRAN (R 4.2.2)
   ggrepel                0.9.3     2023-02-03 [1] CRAN (R 4.2.2)
   ggsignif               0.6.4     2022-10-13 [1] CRAN (R 4.2.2)
   ggstar                 1.0.4     2022-11-08 [1] CRAN (R 4.2.2)
   ggtree                 3.4.4     2022-09-27 [1] Bioconductor
   ggtreeExtra            1.6.1     2022-09-20 [1] Bioconductor
   ggvenn               * 0.1.9     2021-06-29 [1] CRAN (R 4.2.2)
   glue                   1.6.2     2022-02-24 [1] CRAN (R 4.2.1)
   googledrive            2.1.0     2023-03-22 [1] CRAN (R 4.2.3)
   googlesheets4          1.1.0     2023-03-23 [1] CRAN (R 4.2.3)
   gridExtra              2.3       2017-09-09 [1] CRAN (R 4.2.1)
   gridGraphics           0.5-1     2020-12-13 [1] CRAN (R 4.2.1)
   gtable                 0.3.3     2023-03-21 [1] CRAN (R 4.2.3)
   haven                  2.5.1     2022-08-22 [1] CRAN (R 4.2.1)
   hms                    1.1.3     2023-03-21 [1] CRAN (R 4.2.3)
   htmltools              0.5.5     2023-03-23 [1] CRAN (R 4.2.3)
   htmlwidgets            1.6.2     2023-03-17 [1] CRAN (R 4.2.3)
   httpuv                 1.6.9     2023-02-14 [1] CRAN (R 4.2.2)
   httr                   1.4.5     2023-02-24 [1] CRAN (R 4.2.3)
   igraph                 1.4.0     2023-02-10 [1] CRAN (R 4.2.2)
   IRanges              * 2.30.0    2022-04-26 [1] Bioconductor
   iterators              1.0.14    2022-02-05 [1] CRAN (R 4.2.1)
   jpeg                   0.1-10    2022-11-29 [1] CRAN (R 4.2.2)
   jsonlite               1.8.4     2022-12-06 [1] CRAN (R 4.2.2)
   KEGGREST               1.36.3    2022-07-14 [1] Bioconductor
   KernSmooth             2.23-20   2021-05-03 [2] CRAN (R 4.2.2)
   knitr                  1.42      2023-01-25 [1] CRAN (R 4.2.2)
   labeling               0.4.2     2020-10-20 [1] CRAN (R 4.2.0)
   later                  1.3.0     2021-08-18 [1] CRAN (R 4.2.1)
   lattice              * 0.20-45   2021-09-22 [2] CRAN (R 4.2.2)
   lazyeval               0.2.2     2019-03-15 [1] CRAN (R 4.2.1)
   libcoin                1.0-9     2021-09-27 [1] CRAN (R 4.2.1)
   lifecycle              1.0.3     2022-10-07 [1] CRAN (R 4.2.1)
   locfit                 1.5-9.7   2023-01-02 [1] CRAN (R 4.2.2)
   lubridate            * 1.9.2     2023-02-10 [1] CRAN (R 4.2.2)
   magrittr               2.0.3     2022-03-30 [1] CRAN (R 4.2.1)
   MASS                   7.3-58.2  2023-01-23 [1] CRAN (R 4.2.2)
   Matrix                 1.5-3     2022-11-11 [1] CRAN (R 4.2.2)
   MatrixGenerics       * 1.8.1     2022-06-30 [1] Bioconductor
   matrixStats          * 0.63.0    2022-11-18 [1] CRAN (R 4.2.2)
   memoise                2.0.1     2021-11-26 [1] CRAN (R 4.2.1)
   mgcv                   1.8-41    2022-10-21 [2] CRAN (R 4.2.2)
   MicrobiotaProcess    * 1.8.2     2022-09-20 [1] Bioconductor
   microeco             * 0.15.0    2023-03-27 [1] CRAN (R 4.2.3)
   mime                   0.12      2021-09-28 [1] CRAN (R 4.2.0)
   miniUI                 0.1.1.1   2018-05-18 [1] CRAN (R 4.2.1)
   modelr                 0.1.11    2023-03-22 [1] CRAN (R 4.2.3)
   modeltools             0.2-23    2020-03-05 [1] CRAN (R 4.2.0)
   multcomp               1.4-23    2023-03-09 [1] CRAN (R 4.2.3)
   multtest               2.52.0    2022-04-26 [1] Bioconductor
   munsell                0.5.0     2018-06-12 [1] CRAN (R 4.2.1)
   mvtnorm                1.1-3     2021-10-08 [1] CRAN (R 4.2.0)
   nlme                   3.1-162   2023-01-31 [1] CRAN (R 4.2.2)
   patchwork              1.1.2     2022-08-19 [1] CRAN (R 4.2.2)
   permute              * 0.9-7     2022-01-27 [1] CRAN (R 4.2.1)
   pheatmap             * 1.0.12    2019-01-04 [1] CRAN (R 4.2.1)
   phyloseq             * 1.40.0    2022-04-26 [1] Bioconductor
   pillar                 1.9.0     2023-03-22 [1] CRAN (R 4.2.3)
   pkgbuild               1.4.0     2022-11-27 [1] CRAN (R 4.2.2)
   pkgconfig              2.0.3     2019-09-22 [1] CRAN (R 4.2.1)
   pkgload                1.3.2     2022-11-16 [1] CRAN (R 4.2.2)
   plyr                   1.8.8     2022-11-11 [1] CRAN (R 4.2.2)
   png                    0.1-8     2022-11-29 [1] CRAN (R 4.2.2)
   prettyunits            1.1.1     2020-01-24 [1] CRAN (R 4.2.1)
   processx               3.8.0     2022-10-26 [1] CRAN (R 4.2.2)
   profvis                0.3.7     2020-11-02 [1] CRAN (R 4.2.1)
   promises               1.2.0.1   2021-02-11 [1] CRAN (R 4.2.1)
   proxy                  0.4-27    2022-06-09 [1] CRAN (R 4.2.1)
   ps                     1.7.3     2023-03-21 [1] CRAN (R 4.2.3)
   purrr                * 1.0.1     2023-01-10 [1] CRAN (R 4.2.2)
   R6                     2.5.1     2021-08-19 [1] CRAN (R 4.2.1)
   RColorBrewer           1.1-3     2022-04-03 [1] CRAN (R 4.2.0)
   Rcpp                   1.0.10    2023-01-22 [1] CRAN (R 4.2.2)
   RCurl                  1.98-1.10 2023-01-27 [1] CRAN (R 4.2.2)
   readr                * 2.1.4     2023-02-10 [1] CRAN (R 4.2.2)
   readxl                 1.4.2     2023-02-09 [1] CRAN (R 4.2.2)
   remotes                2.4.2     2021-11-30 [1] CRAN (R 4.2.1)
   reprex                 2.0.2     2022-08-17 [1] CRAN (R 4.2.1)
   reshape2               1.4.4     2020-04-09 [1] CRAN (R 4.2.1)
   RgoogleMaps            1.4.5.3   2020-02-12 [1] CRAN (R 4.2.1)
   rhdf5                  2.40.0    2022-04-26 [1] Bioconductor
 D rhdf5filters           1.8.0     2022-04-26 [1] Bioconductor
   Rhdf5lib               1.18.2    2022-05-15 [1] Bioconductor
   rlang                  1.1.0     2023-03-14 [1] CRAN (R 4.2.3)
   rmarkdown              2.21      2023-03-26 [1] CRAN (R 4.2.3)
   RSQLite                2.3.0     2023-02-17 [1] CRAN (R 4.2.2)
   rstatix                0.7.2     2023-02-01 [1] CRAN (R 4.2.2)
   rstudioapi             0.14      2022-08-22 [1] CRAN (R 4.2.2)
   rvest                  1.0.3     2022-08-19 [1] CRAN (R 4.2.1)
   S4Vectors            * 0.34.0    2022-04-26 [1] Bioconductor
   sandwich               3.0-2     2022-06-15 [1] CRAN (R 4.2.1)
   scales                 1.2.1     2022-08-20 [1] CRAN (R 4.2.1)
   sessioninfo            1.2.2     2021-12-06 [1] CRAN (R 4.2.1)
   sf                   * 1.0-12    2023-03-19 [1] CRAN (R 4.2.3)
   shiny                  1.7.4     2022-12-15 [1] CRAN (R 4.2.2)
   sp                     1.6-0     2023-01-19 [1] CRAN (R 4.2.2)
   stringi                1.7.8     2022-07-11 [1] CRAN (R 4.2.1)
   stringr              * 1.5.0     2022-12-02 [1] CRAN (R 4.2.2)
   SummarizedExperiment * 1.26.1    2022-04-29 [1] Bioconductor
   survival               3.5-3     2023-02-12 [1] CRAN (R 4.2.2)
   TH.data                1.1-1     2022-04-26 [1] CRAN (R 4.2.1)
   tibble               * 3.1.8     2022-07-22 [1] CRAN (R 4.2.1)
   tidyr                * 1.3.0     2023-01-24 [1] CRAN (R 4.2.2)
   tidyselect             1.2.0     2022-10-10 [1] CRAN (R 4.2.1)
   tidytree               0.4.2     2022-12-18 [1] CRAN (R 4.2.2)
   tidyverse            * 1.3.2     2022-07-18 [1] CRAN (R 4.2.1)
   timechange             0.2.0     2023-01-11 [1] CRAN (R 4.2.2)
   treeio                 1.20.2    2022-08-14 [1] Bioconductor
   tzdb                   0.3.0     2022-03-28 [1] CRAN (R 4.2.1)
   units                  0.8-1     2022-12-10 [1] CRAN (R 4.2.2)
   urlchecker             1.0.1     2021-11-30 [1] CRAN (R 4.2.1)
   usethis                2.1.6     2022-05-25 [1] CRAN (R 4.2.1)
   utf8                   1.2.3     2023-01-31 [1] CRAN (R 4.2.2)
   vctrs                  0.5.2     2023-01-23 [1] CRAN (R 4.2.2)
   vegan                * 2.6-4     2022-10-11 [1] CRAN (R 4.2.2)
   vroom                  1.6.1     2023-01-22 [1] CRAN (R 4.2.2)
   withr                  2.5.0     2022-03-03 [1] CRAN (R 4.2.1)
   xfun                   0.37      2023-01-31 [1] CRAN (R 4.2.2)
   XML                    3.99-0.14 2023-03-19 [1] CRAN (R 4.2.3)
   xml2                   1.3.3     2021-11-30 [1] CRAN (R 4.2.1)
   xtable                 1.8-4     2019-04-21 [1] CRAN (R 4.2.1)
   XVector                0.36.0    2022-04-26 [1] Bioconductor
   yaml                   2.3.7     2023-01-23 [1] CRAN (R 4.2.2)
   yulab.utils            0.0.6     2022-12-20 [1] CRAN (R 4.2.2)
   zlibbioc               1.42.0    2022-04-26 [1] Bioconductor
   zoo                    1.8-11    2022-09-17 [1] CRAN (R 4.2.2)

 [1] C:/Users/14022/AppData/Local/R/win-library/4.2
 [2] C:/Program Files/R/R-4.2.2/library

 D ── DLL MD5 mismatch, broken installation.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>